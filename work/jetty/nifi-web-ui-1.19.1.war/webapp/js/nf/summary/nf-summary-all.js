(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.Dialog=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Dialog=b(require("jquery")))}else{nf.Dialog=b(a.$)}}}(this,function(b){b(document).ready(function(){b("#nf-ok-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-ok-dialog-content").empty()}}});b("#nf-yes-no-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-yes-no-dialog-content").empty();b("#nf-yes-no-dialog").modal("setButtonModel",[])}}})});var a={showOkDialog:function(c){c=b.extend({headerText:"",dialogContent:""},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-ok-dialog-content").append(d).append("</br>");b("#nf-ok-dialog").modal("setButtonModel",[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-ok-dialog").modal("hide");if(typeof c.okHandler==="function"){c.okHandler.call(this)}}}}]);b("#nf-ok-dialog").modal("setHeaderText",c.headerText).modal("show")},showYesNoDialog:function(c){c=b.extend({headerText:"",dialogContent:"",yesText:"Yes",noText:"No"},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-yes-no-dialog-content").append(d);b("#nf-yes-no-dialog").modal("setButtonModel",[{buttonText:c.yesText,color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.yesHandler==="function"){c.yesHandler.call(this)}}}},{buttonText:c.noText,color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.noHandler==="function"){c.noHandler.call(this)}}}}]);b("#nf-yes-no-dialog").modal("setHeaderText",c.headerText).modal("show")},showDisconnectedFromClusterMessage:function(c){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node is currently not connected to the cluster. Any modifications to the data flow made here will not replicate across the cluster.",okHandler:function(){if(typeof c==="function"){c.call(this)}}})},showConnectedToClusterMessage:function(c){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node just joined the cluster. Any modifications to the data flow made here will replicate across the cluster.",okHandler:function(){if(typeof c==="function"){c.call(this)}}})}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.AuthorizationStorage=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.AuthorizationStorage=b())}else{nf.AuthorizationStorage=b()}}}(this,function(){var b="Access-Token-Expiration";var a=new RegExp("Request-Token=([^;]+)");return{getRequestToken:function(){var c=null;var d=a.exec(document.cookie);if(d){c=d[1]}return c},getToken:function(){return sessionStorage.getItem(b)},hasToken:function(){var c=this.getToken();return typeof c==="string"},removeToken:function(){sessionStorage.removeItem(b)},setToken:function(c){sessionStorage.setItem(b,c)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.Storage=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Storage=b())}else{nf.Storage=b()}}}(this,function(){var h=false;var g=86400000;var f=g*2;var b=function(i){return typeof i==="undefined"};var e=function(i){return i===null};var d=function(i){return !b(i)&&!e(i)};var c=function(k){if(d(k.expires)){var i=new Date(k.expires);var j=new Date();return i.valueOf()<j.valueOf()}else{return false}};var a=function(i){try{var j=JSON.parse(localStorage.getItem(i));if(d(j)){return j}else{return null}}catch(k){return null}};return{init:function(){for(var k=0;k<localStorage.length;k++){try{var j=localStorage.key(k);this.getItem(j)}catch(l){}}},acknowledgeDisconnection:function(){h=true},resetDisconnectionAcknowledgement:function(){h=false},isDisconnectionAcknowledged:function(){return h},setItem:function(j,l,i){i=d(i)?i:new Date().valueOf()+f;var k={expires:i,item:l};localStorage.setItem(j,JSON.stringify(k))},hasItem:function(i){return a(i)!==null},getItem:function(i){var j=a(i);if(j===null){return null}if(c(j)){this.removeItem(i);return null}if(d(j.item)){return j.item}else{return null}},getItemExpiration:function(i){var j=a(i);if(j===null){return null}if(d(j.expires)){return j.expires}else{return null}},removeItem:function(i){localStorage.removeItem(i)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.AuthorizationStorage","lodash","moment"],function(f,e,c,d,g){return(nf.Common=b(f,e,c,d,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Common=b(require("jquery"),require("d3"),require("nf.AuthorizationStorage"),require("lodash"),require("moment")))}else{nf.Common=b(a.$,a.d3,a.nf.AuthorizationStorage,a._,a.moment)}}}(this,function(f,e,b,c,h){f(document).ready(function(){var i="images/bg-error.png";f("<img/>").attr("src",i).on("load",function(){f("div.message-pane").css("background-image",i)});f(document).on("mouseenter","span.link",function(){f(this).addClass("link-over")}).on("mouseleave","span.link",function(){f(this).removeClass("link-over")});f(document).on("click","div.nf-checkbox",function(){var l=f(this);var k=l.hasClass("checkbox-unchecked");var j=l.hasClass("disabled");if(j){return}if(k){l.removeClass("checkbox-unchecked").addClass("checkbox-checked")}else{l.removeClass("checkbox-checked").addClass("checkbox-unchecked")}l.trigger("change",{isChecked:k})});f(document).on("click",".nf-checkbox-label",function(j){f(j.target).parent().find(".nf-checkbox").click()});f(document).ajaxStart(function(){f("div.loading-container").addClass("ajax-loading")}).ajaxStop(function(){f("div.loading-container").removeClass("ajax-loading")});if(b.hasToken()){f("#user-logout-container").css("display","block");g.scheduleTokenRefresh()}f("#user-logout").on("click",function(){f.ajax({type:"DELETE",url:"../nifi-api/access/logout",}).done(function(){b.removeToken();window.location="../nifi/logout"}).fail(nfErrorHandler.handleAjaxError)});f("#user-home").on("click",function(){if(top!==window){parent.window.location="../nifi/"}else{window.location="../nifi/"}})});var d=null;var a=[{text:"view the user interface",value:"flow",description:"Allows users to view the user interface"},{text:"access the controller",value:"controller",description:"Allows users to view/modify the controller including Management Controller Services, Reporting Tasks, Registry Clients, Parameter Providers and nodes in the cluster"},{text:"access parameter contexts",value:"parameter-contexts",description:"Allows users to view/modify Parameter Contexts"},{text:"query provenance",value:"provenance",description:"Allows users to submit a Provenance Search and request Event Lineage"},{text:"access restricted components",value:"restricted-components",description:"Allows users to create/modify restricted components assuming other permissions are sufficient"},{text:"access all policies",value:"policies",description:"Allows users to view/modify the policies for all components"},{text:"access users/user groups",value:"tenants",description:"Allows users to view/modify the users and user groups"},{text:"retrieve site-to-site details",value:"site-to-site",description:"Allows other NiFi instances to retrieve Site-To-Site details of this NiFi"},{text:"view system diagnostics",value:"system",description:"Allows users to view System Diagnostics"},{text:"proxy user requests",value:"proxy",description:"Allows proxy machines to send requests on the behalf of others"},{text:"access counters",value:"counters",description:"Allows users to view/modify Counters"}];var g={ANONYMOUS_USER_TEXT:"Anonymous user",config:{sensitiveText:"Sensitive value set",tooltipConfig:{style:{classes:"nifi-tooltip"},show:{solo:true,effect:function(i){f(this).slideDown(100)}},hide:{effect:function(i){f(this).slideUp(100)}},position:{at:"top center",my:"bottom center"}}},SUPPORTS_SVG:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,currentUser:undefined,sortVersion:function(j,t){if(j===t){return 0}var p=j.split(/-/);var u=t.split(/-/);if(p.length>=1&&u.length>=1){var r=p[0].split(/\./);var o=u[0].split(/\./);if(r.length>=1&&o.length>=1){var m=Math.min(r.length,o.length);for(var n=0;n<m;n++){var s=parseInt(r[n],10);var l=parseInt(o[n],10);if(isNaN(s)&&isNaN(l)){continue}else{if(isNaN(s)){return -1}else{if(isNaN(l)){return 1}}}if(s!==l){return s-l}}if(r.length===o.length){if(p.length===u.length){var q=g.substringAfterFirst(j,p[0]);var k=g.substringAfterFirst(t,u[0]);return q===k?0:q>k?1:-1}else{return u.length-p.length}}else{return r.length-o.length}}else{if(r.length>=1){return 1}else{if(o.length>=1){return -1}else{return 0}}}}else{if(p.length>=1){return 1}else{if(u.length>=1){return -1}else{return 0}}}},sortType:function(i,l){var j=function(o,m){var p=g.formatBundle(o.bundle);var n=g.formatBundle(m.bundle);return p===n?0:p>n?1:-1};var k=function(t,s){if(i.columnId==="version"){var r=g.isDefinedAndNotNull(t.bundle[i.columnId])?t.bundle[i.columnId]:"";var p=g.isDefinedAndNotNull(s.bundle[i.columnId])?s.bundle[i.columnId]:"";var n=g.sortVersion(r,p);return n===0?j(t,s):n}else{if(i.columnId==="type"){var q=g.substringAfterLast(t[i.columnId],".");var o=g.substringAfterLast(s[i.columnId],".");return q===o?0:q>o?1:-1}else{var m=g.isDefinedAndNotNull(t[i.columnId])?t[i.columnId]:"";var u=g.isDefinedAndNotNull(s[i.columnId])?s[i.columnId]:"";return m===u?j(t,s):m>u?1:-1}}};l.sort(k,i.sortAsc)},typeFormatter:function(n,j,m,l,i){var k="";if(i.restricted===true){k+='<div class="view-usage-restriction fa fa-shield"></div><span class="hidden row-id">'+g.escapeHtml(i.id)+"</span>"}else{k+='<div class="fa"></div>'}k+=g.escapeHtml(m);return k},genericValueFormatter:function(m,j,l,k,i){return g.escapeHtml(l)},typeBundleFormatter:function(m,j,l,k,i){return g.escapeHtml(g.formatBundle(i.bundle))},typeVersionFormatter:function(n,j,m,l,i){var k="";if(g.isDefinedAndNotNull(i.bundle)){k+=('<div style="float: left;">'+g.escapeHtml(i.bundle.version)+"</div>")}else{k+='<div style="float: left;">unversioned</div>'}if(!g.isEmpty(i.controllerServiceApis)){k+='<div class="controller-service-apis fa fa-list" title="Compatible Controller Service" style="margin-left: 4px;"></div><span class="hidden row-id">'+g.escapeHtml(i.id)+"</span>"}k+='<div class="clear"></div>';return k},instanceTypeFormatter:function(m,j,l,k,i){if(!i.permissions.canRead){return""}return g.escapeHtml(g.formatType(i.component))},instanceBundleFormatter:function(m,j,l,k,i){if(!i.permissions.canRead){return""}return g.typeBundleFormatter(m,j,l,k,i.component)},getVersionControlTooltip:function(i){return i.stateExplanation},formatClassName:function(i){return g.substringAfterLast(i.type,".")},formatType:function(i){var j=g.formatClassName(i);if(i.bundle.version!=="unversioned"){j+=(" "+i.bundle.version)}return j},formatBundle:function(i){var j="";if(i.group!=="default"){j=i.group+" - "}return j+i.artifact},setCurrentUser:function(i){g.currentUser=i},scheduleTokenRefresh:function(){if(d!==null){clearInterval(d)}var i=g.MILLIS_PER_MINUTE;var j=function(){var o=b.getToken();if(o!==null){var l=parseInt(o,10)*g.MILLIS_PER_SECOND;var n=new Date(l);var m=new Date();var k=n.valueOf()-m.valueOf()-(30*g.MILLIS_PER_SECOND);if(k<i){if(f("#current-user").text()!==g.ANONYMOUS_USER_TEXT&&!f("#anonymous-user-alert").is(":visible")){f("#anonymous-user-alert").show().qtip(f.extend({},g.config.tooltipConfig,{content:"Your session will expire soon. Please log in again to avoid being automatically logged out.",position:{my:"top right",at:"bottom left"}}))}}}};j();d=setInterval(j,i)},setAnonymousUserLabel:function(){var i=f("#anonymous-user-alert");if(i.data("qtip")){i.qtip("api").destroy(true)}i.show().qtip(f.extend({},g.config.tooltipConfig,{content:"You are accessing with limited authority. Log in or request an account to access with additional authority granted to you by an administrator.",position:{my:"top right",at:"bottom left"}}));f("#current-user").text(g.ANONYMOUS_USER_TEXT).show()},getSessionExpiration:function(j){var k=null;var i=g.getJwtPayload(j);if(i){k=i.exp}return k},getDefaultExpiration:function(){var j=new Date();var i=j.getTime()+43200000;var k=Math.round(i/1000);return k.toString()},getJwtPayload:function(j){if(g.isDefinedAndNotNull(j)){var i=j.split(/\./);if(i.length!==3){return""}var l=f.base64.atob(i[1]);var k=JSON.parse(l);if(g.isDefinedAndNotNull(k)){return k}else{return null}}return null},canVersionFlows:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.canVersionFlows===true}else{return false}},canAccessProvenance:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.provenancePermissions.canRead===true}else{return false}},canAccessRestrictedComponents:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.restrictedComponentsPermissions.canWrite===true}else{return false}},canAccessComponentRestrictions:function(j){if(g.isDefinedAndNotNull(g.currentUser)){if(g.currentUser.restrictedComponentsPermissions.canWrite===true){return true}var i=function(m){if(g.isEmpty(g.currentUser.componentRestrictionPermissions)){return false}var l=false;f.each(g.currentUser.componentRestrictionPermissions,function(n,o){if(o.requiredPermission.id===m.id){if(o.permissions.canWrite===true){l=true;return false}}});return l};var k=true;if(g.isEmpty(j)){k=false}else{f.each(j,function(l,m){if(!i(m.requiredPermission)){k=false;return false}})}return k}else{return false}},canAccessCounters:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.countersPermissions.canRead===true}else{return false}},canModifyCounters:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.countersPermissions.canRead===true&&g.currentUser.countersPermissions.canWrite===true}else{return false}},canAccessTenants:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.tenantsPermissions.canRead===true}else{return false}},canModifyTenants:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.tenantsPermissions.canRead===true&&g.currentUser.tenantsPermissions.canWrite===true}else{return false}},canModifyParameterContexts:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.parameterContextPermissions.canRead===true&&g.currentUser.parameterContextPermissions.canWrite===true}else{return false}},canAccessPolicies:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.policiesPermissions.canRead===true}else{return false}},canModifyPolicies:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.policiesPermissions.canRead===true&&g.currentUser.policiesPermissions.canWrite===true}else{return false}},canAccessController:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.controllerPermissions.canRead===true}else{return false}},canModifyController:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.controllerPermissions.canRead===true&&g.currentUser.controllerPermissions.canWrite===true}else{return false}},canAccessSystem:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.systemPermissions.canRead===true}else{return false}},addHoverEffect:function(i,k,j){f(document).on("mouseenter",i,function(){f(this).removeClass(k).addClass(j)}).on("mouseleave",i,function(){f(this).removeClass(j).addClass(k)});return f(i).addClass(k)},toggleScrollable:function(i){if(f(i).is(":visible")){if(i.offsetHeight<i.scrollHeight||i.offsetWidth<i.scrollWidth){f(i).addClass("scrollable")}else{f(i).removeClass("scrollable")}}},determineContrastColor:function(i){if(parseInt(i,16)>16777215/1.5){return"#000000"}return"#ffffff"},updateLogoutLink:function(){if(b.hasToken()){f("#user-logout-container").css("display","block")}else{f("#user-logout-container").css("display","none")}},isContentViewConfigured:function(){var i=f("#nifi-content-viewer-url").text();return !g.isBlank(i)},populateField:function(j,i){if(g.isUndefined(i)||g.isNull(i)){return f("#"+j).addClass("unset").text("No value set")}else{if(i===""){return f("#"+j).addClass("blank").text("Empty string set")}else{return f("#"+j).text(i)}}},clearField:function(i){return f("#"+i).removeClass("unset blank").text("")},cleanUpTooltips:function(i,j){i.find(j).each(function(){var l=f(this);if(l.data("qtip")){var k=l.qtip("api");k.destroy(true)}})},formatPropertyTooltip:function(j,l){var m=[];if(g.isDefinedAndNotNull(j)){if(!g.isBlank(j.description)){m.push(g.escapeHtml(j.description))}if(!g.isBlank(j.defaultValue)){m.push("<b>Default value:</b> "+g.escapeHtml(j.defaultValue))}if(!g.isBlank(j.supportsEl)){m.push("<b>Expression language scope:</b> "+g.escapeHtml(j.expressionLanguageScope))}if(!g.isBlank(j.sensitive)){m.push("<b>Sensitive property:</b> "+g.escapeHtml(j.sensitive))}if(!g.isBlank(j.identifiesControllerService)){var i=g.formatType({type:j.identifiesControllerService,bundle:j.identifiesControllerServiceBundle});var k=g.formatBundle(j.identifiesControllerServiceBundle);m.push("<b>Requires Controller Service:</b> "+g.escapeHtml(i+" from "+k))}}if(g.isDefinedAndNotNull(l)){if(!g.isEmpty(l.previousValues)){var n=[];f.each(l.previousValues,function(p,o){n.push("<li>"+g.escapeHtml(o.previousValue)+" - "+g.escapeHtml(o.timestamp)+" ("+g.escapeHtml(o.userIdentity)+")</li>")});m.push('<b>History:</b><ul class="property-info">'+n.join("")+"</ul>")}}if(m.length>0){return m.join("<br/><br/>")}else{return null}},formatWhitespaceTooltip:function(){return g.escapeHtml("The specified value contains leading and/or trailing whitespace character(s). This could produce unexpected results if it was not intentional.")},LEAD_TRAIL_WHITE_SPACE_REGEX:/^[ \s]+|[ \s]+$/,hasLeadTrailWhitespace:function(i){if(g.isBlank(i)){return false}return g.LEAD_TRAIL_WHITE_SPACE_REGEX.test(i)},formatProperty:function(i,j){return'<div><span class="label">'+g.formatValue(i)+": </span>"+g.formatValue(j)+"</div>"},formatValue:function(i){if(g.isDefinedAndNotNull(i)){if(i===""){return'<span class="blank" style="font-size: 13px; padding-top: 2px;">Empty string set</span>'}else{return g.escapeHtml(i)}}else{return'<span class="unset" style="font-size: 13px; padding-top: 2px;">No value set</span>'}},escapeHtml:(function(){var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2f;"};return function(j){if(g.isDefinedAndNotNull(j)){return String(j).replace(/[&<>"'\/]/g,function(k){return i[k]})}else{return""}}}()),isSensitiveProperty:function(i){if(g.isDefinedAndNotNull(i)){return i.sensitive===true}else{return false}},isRequiredProperty:function(i){if(g.isDefinedAndNotNull(i)){return i.required===true}else{return false}},isDynamicProperty:function(i){if(g.isDefinedAndNotNull(i)){return i.dynamic===true}else{return false}},getAllowableValues:function(i){if(g.isDefinedAndNotNull(i)){return i.allowableValues}else{return null}},supportsEl:function(i){if(g.isDefinedAndNotNull(i)){return i.supportsEl===true}else{return false}},formatUnorderedList:function(j){if(f.isArray(j)){var i=f('<ul class="result"></ul>');f.each(j,function(l,m){var k=f("<li></li>").appendTo(i);if(m instanceof jQuery){k.append(m)}else{k.text(m)}});return i}else{return null}},substringAfterLast:function(m,l){var j="";var k=m.lastIndexOf(l);if(k>=0){var i=k+l.length;if(i<m.length){j=m.substr(i)}}return j},substringAfterFirst:function(m,l){var j="";var k=m.indexOf(l);if(k>=0){var i=k+l.length;if(i<m.length){j=m.substr(i)}}return j},substringBeforeLast:function(l,k){var i="";var j=l.lastIndexOf(k);if(j>=0){i=l.substr(0,j)}return i},substringBeforeFirst:function(l,k){var i="";var j=l.indexOf(k);if(j>=0){i=l.substr(0,j)}return i},setCursor:function(j,i){if(i){f("#"+j).addClass("pointer")}else{f("#"+j).removeClass("pointer")}},MILLIS_PER_DAY:86400000,MILLIS_PER_HOUR:3600000,MILLIS_PER_MINUTE:60000,MILLIS_PER_SECOND:1000,loadBalanceStrategyOptions:[{text:"Do not load balance",value:"DO_NOT_LOAD_BALANCE",description:"Do not load balance FlowFiles between nodes in the cluster."},{text:"Partition by attribute",value:"PARTITION_BY_ATTRIBUTE",description:"Determine which node to send a given FlowFile to based on the value of a user-specified FlowFile Attribute. All FlowFiles that have the same value for said Attribute will be sent to the same node in the cluster."},{text:"Round robin",value:"ROUND_ROBIN",description:"FlowFiles will be distributed to nodes in the cluster in a Round-Robin fashion. However, if a node in the cluster is not able to receive data as fast as other nodes, that node may be skipped in one or more iterations in order to maximize throughput of data distribution across the cluster."},{text:"Single node",value:"SINGLE_NODE",description:"All FlowFiles will be sent to the same node. Which node they are sent to is not defined."}],loadBalanceCompressionOptions:[{text:"Do not compress",value:"DO_NOT_COMPRESS",description:"FlowFiles will not be compressed"},{text:"Compress attributes only",value:"COMPRESS_ATTRIBUTES_ONLY",description:"FlowFiles' attributes will be compressed, but the FlowFiles' contents will not be"},{text:"Compress attributes and content",value:"COMPRESS_ATTRIBUTES_AND_CONTENT",description:"FlowFiles' attributes and content will be compressed"}],formatDuration:function(l){l=l<1?0:l;var n=l/g.MILLIS_PER_DAY;n=n>=1?parseInt(n,10):0;l%=g.MILLIS_PER_DAY;var i=l/g.MILLIS_PER_HOUR;i=i>=1?parseInt(i,10):0;l%=g.MILLIS_PER_HOUR;var j=l/g.MILLIS_PER_MINUTE;j=j>=1?parseInt(j,10):0;l%=g.MILLIS_PER_MINUTE;var m=l/g.MILLIS_PER_SECOND;m=m>=1?parseInt(m,10):0;l=Math.floor(l%g.MILLIS_PER_SECOND);var k=g.pad(i,2,"0")+":"+g.pad(j,2,"0")+":"+g.pad(m,2,"0")+"."+g.pad(l,3,"0");if(n>0){return n+" days and "+k}else{return k}},formatPredictedDuration:function(i){if(i===0){return"now"}return h.duration(i,"ms").humanize()},BYTES_IN_KILOBYTE:1024,BYTES_IN_MEGABYTE:1048576,BYTES_IN_GIGABYTE:1073741824,BYTES_IN_TERABYTE:1099511627776,formatDataSize:function(j){var i=parseFloat(j/g.BYTES_IN_TERABYTE);if(i>1){return i.toFixed(2)+" TB"}i=parseFloat(j/g.BYTES_IN_GIGABYTE);if(i>1){return i.toFixed(2)+" GB"}i=parseFloat(j/g.BYTES_IN_MEGABYTE);if(i>1){return i.toFixed(2)+" MB"}i=parseFloat(j/g.BYTES_IN_KILOBYTE);if(i>1){return i.toFixed(2)+" KB"}return parseFloat(j).toFixed(2)+" bytes"},formatInteger:function(j){var i=j+"";var k=/(\d+)(\d{3})/;while(k.test(i)){i=i.replace(k,"$1,$2")}return g.escapeHtml(i)},formatFloat:function(i){if(g.isUndefinedOrNull(i)){return 0+""}return i.toFixed(2)+""},pad:function(l,j,k){var i=l+"";while(i.length<j){i=k+i}return i},formatDateTime:function(i){return g.pad(i.getMonth()+1,2,"0")+"/"+g.pad(i.getDate(),2,"0")+"/"+g.pad(i.getFullYear(),2,"0")+" "+g.pad(i.getHours(),2,"0")+":"+g.pad(i.getMinutes(),2,"0")+":"+g.pad(i.getSeconds(),2,"0")+"."+g.pad(i.getMilliseconds(),3,"0")},parseDateTime:function(m){if(!g.isDefinedAndNotNull(m)){return new Date()}if(m==="No value set"){return new Date()}if(m==="Empty string set"){return new Date()}var t=m.split(/ /);if(t.length!==3){return new Date()}var j=t[0].split(/\//);var i=t[1].split(/:/);if(j.length!==3||i.length!==3){return new Date()}var o=parseInt(j[2],10);var n=parseInt(j[0],10)-1;var p=parseInt(j[1],10);var q=parseInt(i[0],10);var l=parseInt(i[1],10);var s=i[2].split(/\./);var r=parseInt(s[0],10);var k=0;if(s.length===2){k=parseInt(s[1],10)}return new Date(o,n,p,q,l,r,k)},parseDuration:function(i){var j=i.split(/:/);if(j.length!==3){return 0}var k=j[2].split(/\./);if(k.length===2){return new Date(1970,0,1,parseInt(j[0],10),parseInt(j[1],10),parseInt(k[0],10),parseInt(k[1],10)).getTime()}else{return new Date(1970,0,1,parseInt(j[0],10),parseInt(j[1],10),parseInt(j[2],10),0).getTime()}},parseSize:function(k){var l=k.split(/ /);var j=parseFloat(l[0].replace(/,/g,""));var i=l[1];if(i==="KB"){return j*1024}else{if(i==="MB"){return j*1024*1024}else{if(i==="GB"){return j*1024*1024*1024}else{if(i==="TB"){return j*1024*1024*1024*1024}else{return j}}}}},parseCount:function(k){var j=k.split(/ /,1);if(j.length!==1){return 0}var i=parseInt(j[0].replace(/,/g,""),10);if(isNaN(i)){return 0}return i},isDefinedAndNotNull:function(i){return !g.isUndefined(i)&&!g.isNull(i)},isUndefinedOrNull:function(i){return g.isUndefined(i)||g.isNull(i)},isUndefined:function(i){return typeof i==="undefined"},isBlank:function(i){return g.isUndefined(i)||g.isNull(i)||f.trim(i)===""},isNull:function(i){return i===null},isEmpty:function(i){return f.isArray(i)?i.length===0:true},doBulletinsDiffer:function(k,l){if(f.isArray(k)&&f.isArray(l)){if(k.length===l.length){for(var j=0;j<k.length;j++){if(k[j].id!==l[j].id||k[j].canRead!==l[j].canRead){return true}}}else{return true}}else{if(f.isArray(k)||f.isArray(l)){return true}}return false},getFormattedBulletins:function(j){var i=[];f.each(j,function(l,m){if(m.canRead===true){var k=m.bulletin;var p="";if(g.isDefinedAndNotNull(k.nodeAddress)){p="-&nbsp;"+g.escapeHtml(k.nodeAddress)+"&nbsp;-&nbsp;"}var o=f("<pre></pre>").css({"white-space":"pre-wrap"}).text(k.message);var n=f("<div>"+g.escapeHtml(k.timestamp)+"&nbsp;"+p+"&nbsp;<b>"+g.escapeHtml(k.level)+"</b>&nbsp;</div>").append(o);i.push(n)}});return i},getFormattedServiceApis:function(j){var i=[];f.each(j,function(m,n){var k=g.formatType({type:n.type,bundle:n.bundle});var l=g.formatBundle(n.bundle);i.push(f("<div></div>").text(k+" from "+l))});return i},getFormattedGarbageCollections:function(j){j.sort(function(l,k){return k.collectionCount-l.collectionCount});var i=[];f.each(j,function(m,k){var l=f('<span style="font-weight: bold;"></span>').text(k.name);var n=f("<span></span>").text(" - "+k.collectionCount+" times ("+k.collectionTime+")");var o=f("<div></div>").append(l).append(n);i.push(o)});return i},isGlobalPolicy:function(i){return g.getPolicyTypeListing(i)!==null},getPolicyTypeListing:function(i){return a.find(function(j){return i===j.value})},getComponentName:function(i){return i.permissions.canRead===true?i.component.name:i.id},getComboOptionText:function(i,k){var j=i.find(function(l){return l.value===k});return g.isDefinedAndNotNull(j)?j.text:undefined},throttle:function(i,j){return c.throttle(i,j)},getKeyValue:function(j,i){return i.split(".").reduce(function(l,k){return(typeof l===undefined||l===null)?l:(typeof l[k]=="function")?l[k]():l[k]},j)},isMultiLine:function(i){const j=/\n/.exec(i);if(j){return true}return false}};return g}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Dialog","nf.Common","nf.AuthorizationStorage"],function(e,d,f,c){return(nf.ErrorHandler=b(e,d,f,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ErrorHandler=b(require("jquery"),require("nf.Dialog"),require("nf.Common"),require("nf.AuthorizationStorage")))}else{nf.ErrorHandler=b(a.$,a.nf.Dialog,a.nf.Common,a.nf.AuthorizationStorage)}}}(this,function(d,c,e,b){var a={handleAjaxError:function(k,f,g){if(f==="canceled"){b.removeToken();if(d("#splash").is(":visible")){d("#message-title").text("Session Expired");d("#message-content").text("Your session has expired. Please reload to log in again.");d("#message-pane").show()}else{c.showOkDialog({headerText:"Session Expired",dialogContent:"Your session has expired. Please press Ok to log in again.",okHandler:function(){window.location="../nifi/"}})}return}var i=k.getResponseHeader("WWW-Authenticate");var j=new RegExp("^Bearer.*$");if(j.test(i)){b.removeToken()}if(d("#splash").is(":visible")){if(k.status===401){d("#message-title").text("Unauthorized")}else{if(k.status===403){d("#message-title").text("Insufficient Permissions")}else{if(k.status===409){d("#message-title").text("Invalid State")}else{if(k.status===413){d("#message-title").text("Payload Too Large")}else{d("#message-title").text("An unexpected error has occurred")}}}}if(d.trim(k.responseText)===""){d("#message-content").text("Please check the logs.")}else{d("#message-content").text(k.responseText)}d("#message-pane").show();return}if(k.status===400||k.status===404||k.status===409||k.status==413||k.status===503){c.showOkDialog({headerText:"Error",dialogContent:e.escapeHtml(k.responseText)})}else{if(k.status===403){c.showOkDialog({headerText:"Insufficient Permissions",dialogContent:e.escapeHtml(k.responseText)})}else{if(k.status<99||k.status===12007||k.status===12029){var h="Please ensure the application is running and check the logs for any errors.";if(e.isDefinedAndNotNull(f)){if(f==="timeout"){h="Request has timed out. Please ensure the application is running and check the logs for any errors."}else{if(f==="abort"){h="Request has been aborted."}else{if(f==="No Transport"){h="Request transport mechanism failed. Please ensure the host where the application is running is accessible."}}}}d("#message-title").text("Unable to communicate with NiFi");d("#message-content").text(h)}else{if(k.status===401){d("#message-title").text("Unauthorized");if(d.trim(k.responseText)===""){d("#message-content").text("Authentication is required to use this NiFi.")}else{d("#message-content").text(k.responseText)}}else{if(k.status===500){d("#message-title").text("An unexpected error has occurred");if(d.trim(k.responseText)===""){d("#message-content").text("An error occurred communicating with the application core. Please check the logs and fix any configuration issues before restarting.")}else{d("#message-content").text(k.responseText)}}else{if(k.status===200||k.status===201){d("#message-title").text("Parse Error");if(d.trim(k.responseText)===""){d("#message-content").text("Unable to interpret response from NiFi.")}else{d("#message-content").text(k.responseText)}}else{d("#message-title").text(k.status+": Unexpected Response");d("#message-content").text("An unexpected error has occurred. Please check the logs.")}}}}d("#message-pane").show()}}},handleConfigurationUpdateAjaxError:function(i,f,g){if(i.status===400){var j=i.responseText.split("\n");var h;if(j.length===1){h=d("<span></span>").text(j[0])}else{h=e.formatUnorderedList(j)}c.showOkDialog({dialogContent:h,headerText:"Configuration Error"})}else{a.handleAjaxError(i,f,g)}}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.UniversalCapture=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.UniversalCapture=b(require("jquery")))}else{nf.UniversalCapture=b(a.$)}}}(this,function(b){b(document).ready(function(c){c(window).on("keydown",function(d){var i=d.ctrlKey||d.metaKey;if(!i&&d.keyCode===27){var g=c("div.value-combo");if(g.is(":visible")&&g.parent().hasClass("combo-editor")){return}if(c("div.property-detail").is(":visible")){a.removeAllPropertyDetailDialogs();d.stopImmediatePropagation();d.preventDefault()}else{var h=c(d.target);if(h.length){var j=c(".cancellable");if(j.length){var e=null;var f=null;c.each(j,function(k,m){var l=c(m);var n=l.css("zIndex");if(l.is(":visible")&&(n!==null&&typeof n!=="undefined")){n=parseInt(n,10);if(e===null||n>e){e=n;f=l}}});if(f!==null){if(f.hasClass("modal")){f.modal("hide")}else{f.hide()}d.stopImmediatePropagation();d.preventDefault();return}}if(top!==window){if(typeof parent.nf!=="undefined"&&typeof parent.nf.Shell!=="undefined"){parent.$("#shell-close-button").click();d.stopImmediatePropagation();d.preventDefault();return}}}}}else{if(i){if(d.keyCode===82){d.preventDefault()}}else{if(!c("input, textarea").is(":focus")&&(d.keyCode==8||d.keyCode===46)){d.preventDefault()}}}})});var a={removeAllPropertyDetailDialogs:function(){var c=b("body").find("div.property-detail");c.find("div.nf-editor").nfeditor("destroy");c.find("div.value-combo").combo("destroy");c.hide().remove()}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.AuthorizationStorage"],function(d,c){return(nf.AjaxSetup=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.AjaxSetup=b(require("jquery"),require("nf.AuthorizationStorage")))}else{nf.AjaxSetup=b(a.$,a.nf.AuthorizationStorage)}}}(this,function(b,a){b(document).ready(function(c){c.ajaxSetup({beforeSend:function(e){var d=a.getRequestToken();if(d!==null){e.setRequestHeader("Request-Token",d)}}})})}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.Client=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Client=b(require("jquery"),require("nf.Common")))}else{nf.Client=b(a.$,a.nf.Common)}}}(this,function(b,c){var a=null;return{init:function(){return b.ajax({type:"GET",url:"../nifi-api/flow/client-id",}).done(function(d){a=d})},getRevision:function(e){return{clientId:a,version:e.revision.version}},isNewerRevision:function(f,d){if(c.isDefinedAndNotNull(f)){var g=f.revision;var e=d.revision;return e.version>=g.version}else{return true}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Shell","nf.Dialog","nf.Storage","nf.Client"],function(g,h,c,f,e,d){return(nf.CustomUi=b(g,h,c,f,e,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.CustomUi=b(require("jquery"),require("nf.Common"),require("nf.Shell"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client")))}else{nf.CustomUi=b(a.$,a.nf.Common,a.nf.Shell,a.nf.Dialog,a.nf.Storage,a.nf.Client)}}}(this,function(e,f,a,d,c,b){return{showCustomUi:function(g,i,h){return e.Deferred(function(j){e("#shell-close-button");var k=b.getRevision(g);var l={id:g.id,revision:k.version,clientId:k.clientId,editable:h,disconnectedNodeAcknowledged:c.isDisconnectionAcknowledged()};a.showPage(".."+i+"?"+e.param(l),false).done(function(){j.resolve()})}).promise()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.ClusterSummary=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ClusterSummary=b(require("jquery")))}else{nf.ClusterSummary=b(a.$)}}}(this,function(e){var d=false;var c=false;var f=false;var b=false;var a={urls:{clusterSummary:"../nifi-api/flow/cluster/summary"}};return{loadClusterSummary:function(){return e.ajax({type:"GET",url:a.urls.clusterSummary,dataType:"json"}).done(function(g){var h=g;var i=h.clusterSummary;if(d===true){if(f!==i.connectedToCluster){b=true}}else{if(i.clustered&&!i.connectedToCluster){b=true}}c=i.clustered;f=i.connectedToCluster;d=true})},isClustered:function(){return c===true},isConnectedToCluster:function(){return f===true},didConnectedStateChange:function(){var g=b;b=false;return g}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.UniversalCapture","nf.Dialog","nf.ErrorHandler","nf.CustomUi","nf.ClusterSummary","nf.CanvasUtils"],function(g,h,j,f,i,e,c,d){return(nf.ProcessorDetails=b(g,h,j,f,i,e,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessorDetails=b(require("jquery"),require("nf.Common"),require("nf.UniversalCapture"),require("nf.Dialog"),require("nf.ErrorHandler"),require("nf.CustomUi"),require("nf.ClusterSummary"),require("nf.CanvasUtils")))}else{nf.ProcessorDetails=b(a.$,a.nf.Common,a.nf.UniversalCapture,a.nf.Dialog,a.nf.ErrorHandler,a.nf.CustomUi,a.nf.ClusterSummary,a.nf.CanvasUtils)}}}(this,function(e,b,f,d,g,h,i,c){var a;var j=function(q){var s=e('<span class="relationship-name-value hidden"></span>').text(q.name);var p=e('<div class="processor-terminate-relationship nf-checkbox disabled"></div>');var r=e('<div class="relationship-name nf-checkbox-label ellipsis"></div>').text("terminate");if(q.autoTerminate===true){p.addClass("checkbox-checked")}else{p.addClass("checkbox-unchecked")}var n=e('<div class="processor-terminate-relationship-container"></div>').append(p).append(r);var u=e('<div class="processor-retry-relationship nf-checkbox disabled"></div>');var o=e('<div class="relationship-name nf-checkbox-label ellipsis"></div>').text("retry");if(q.retry===true){u.addClass("checkbox-checked")}else{u.addClass("checkbox-unchecked")}var l=e('<div class="processor-retry-relationship-container"></div>').append(u).append(o);var t=e("<div></div>").text(q.name);var k=e('<div class="processor-relationship-container"></div>').append(t).append(n).append(l).append(s).appendTo("#read-only-auto-action-relationship-names");if(!b.isBlank(q.description)){var m=e('<div class="relationship-description"></div>').text(q.description);k.append(m)}return k};return{init:function(k){a=k;e("#processor-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"details-standard-settings-tab-content"},{name:"Scheduling",tabContentId:"details-scheduling-tab-content"},{name:"Properties",tabContentId:"details-processor-properties-tab-content"},{name:"Relationships",tabContentId:"details-processor-relationships-tab-content"},{name:"Comments",tabContentId:"details-processor-comments-tab-content"}],select:function(){f.removeAllPropertyDetailDialogs();if(e(this).text()==="Properties"){e("#read-only-processor-properties").propertytable("resetTableSize")}}});e("#processor-details").modal({headerText:"Processor Details",scrollableContentStyle:"scrollable",handler:{close:function(){e("#read-only-auto-action-relationship-names").empty();e("#read-only-processor-properties").propertytable("clear");b.clearField("read-only-processor-id");b.clearField("read-only-processor-type");b.clearField("read-only-processor-name");b.clearField("read-only-concurrently-schedulable-tasks");b.clearField("read-only-scheduling-period");b.clearField("read-only-penalty-duration");b.clearField("read-only-yield-duration");b.clearField("read-only-run-duration");b.clearField("read-only-bulletin-level");b.clearField("read-only-execution-node");b.clearField("read-only-execution-status");b.clearField("read-only-processor-comments");e("#processor-details").removeData("processorDetails");e("#processor-details").removeData("processorHistory");if(a.supportsStatusBar){e("#processor-details-status-bar").statusbar("disconnect")}},open:function(){b.toggleScrollable(e("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});if(a.supportsStatusBar){e("#processor-details-status-bar").statusbar("processor")}e("#read-only-processor-properties").propertytable(Object.assign({supportsGoTo:a.supportsGoTo,readOnly:true},c&&{getParameterContext:function(l){return c.getParameterContext()}}))},showDetails:function(m,n){var l=e.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(n),dataType:"json"}).done(function(p){if(b.isDefinedAndNotNull(p.component)){var r=p.component;e("#processor-details").data("processorDetails",r);b.populateField("read-only-processor-id",r.id);b.populateField("read-only-processor-type",b.formatType(r));b.populateField("read-only-processor-bundle",b.formatBundle(r.bundle));b.populateField("read-only-processor-name",r.name);b.populateField("read-only-concurrently-schedulable-tasks",r.config.concurrentlySchedulableTaskCount);b.populateField("read-only-scheduling-period",r.config.schedulingPeriod);b.populateField("read-only-penalty-duration",r.config.penaltyDuration);b.populateField("read-only-yield-duration",r.config.yieldDuration);b.populateField("read-only-run-duration",b.formatDuration(r.config.runDurationMillis));b.populateField("read-only-bulletin-level",r.config.bulletinLevel);b.populateField("read-only-processor-comments",r.config.comments);var o=true;var t=r.config.schedulingStrategy;if(t==="EVENT_DRIVEN"){o=false;t="Event driven"}else{if(t==="CRON_DRIVEN"){t="CRON driven"}else{if(t==="TIMER_DRIVEN"){t="Timer driven"}else{t="On primary node"}}}b.populateField("read-only-scheduling-strategy",t);if(o===true){e("#read-only-run-schedule").show()}else{e("#read-only-run-schedule").hide()}var s=r.config.executionNode;if(s==="ALL"){s="All nodes"}else{if(s==="PRIMARY"){s="Primary node only"}}b.populateField("read-only-execution-node",s);e("#read-only-execution-node-options").show();if(!b.isEmpty(r.relationships)){e.each(r.relationships,function(u,v){j(v)});var q=(function(){var u=e("#read-only-auto-action-relationship-names").find("div.nf-checkbox.processor-retry-relationship.checkbox-checked").length?true:false;if(u){e("#details-processor-relationships-tab-content .settings-right").show()}else{e("#details-processor-relationships-tab-content .settings-right").hide()}});q()}else{e("#read-only-auto-action-relationship-names").append('<div class="unset">This processor has no relationships.</div>')}if(b.isDefinedAndNotNull(r.config.backoffMechanism)){if(r.config.backoffMechanism==="PENALIZE_FLOWFILE"){e(".details-backoff-policy-setting #penalizeFlowFile").prop("checked",true)}else{if(r.config.backoffMechanism==="YIELD_PROCESSOR"){e(".details-backoff-policy-setting #yieldEntireProcessor").prop("checked",true)}}}if(b.isDefinedAndNotNull(r.config.maxBackoffPeriod)){e(".details-max-backoff-setting #details-max-backoff-period").text(r.config.maxBackoffPeriod)}if(b.isDefinedAndNotNull(r.config.retryCount)){e(".details-retry-count-setting #details-retry-attempt-count").text(r.config.retryCount)}}});var k=e.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(n),dataType:"json"}).done(function(o){var p=o.componentHistory;e("#processor-details").data("processorHistory",p)});e.when(l,k).done(function(t,x){var u=t[0];var o=u.component;var w=x[0];var r=w.componentHistory;var v;e("#read-only-processor-properties").propertytable("setGroupId",o.parentGroupId).propertytable("loadProperties",o.config.properties,o.config.descriptors,r.propertyHistory);var s=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){e("#processor-details").modal("hide")}}}];if(top===window&&b.isDefinedAndNotNull(h)&&b.isDefinedAndNotNull(o.config.customUiUrl)&&o.config.customUiUrl!==""){s.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#processor-details").modal("hide");h.showCustomUi(u,o.config.customUiUrl,false)}}})}if(a.supportsStatusBar&&b.isDefinedAndNotNull(a.nfCanvasUtils)){var y=b.getFormattedBulletins(u.bulletins);var q=b.formatUnorderedList(y);e("#processor-details-status-bar").statusbar("observe",{processor:o.id,bulletins:q});v=a.nfCanvasUtils.getSelectionById(o.id);if(b.isDefinedAndNotNull(a.nfActions)&&a.nfCanvasUtils.isProcessor(v)&&a.nfCanvasUtils.canModify(v)){var p=function(){var z=e("#processor-details-tabs").find(".selected-tab").text();e("#processor-configuration-tabs").find('.tab:contains("'+z+'")').trigger("click");e("#processor-details").modal("hide");e("#processor-details-status-bar").statusbar("showButtons")};e("#processor-details-status-bar").statusbar("buttons",[{buttonHtml:'<i class="fa fa-stop stop-configure-icon" aria-hidden="true"></i><span>Stop & Configure</span>',clazz:"button button-icon auto-width",color:{hover:"#C7D2D7",base:"transparent",text:"#004849"},disabled:function(){return !a.nfCanvasUtils.isStoppable(v)},handler:{click:function(){e("#processor-details-status-bar").statusbar("hideButtons");a.nfActions.stopAndConfigure(v,p)}}},{buttonText:"Configure",clazz:"fa fa-cog button-icon",color:{hover:"#C7D2D7",base:"transparent",text:"#004849"},disabled:function(){return a.nfCanvasUtils.isStoppable(v)},handler:{click:function(){e("#processor-details-status-bar").statusbar("hideButtons");a.nfActions.showConfiguration(v,p)}}}])}}e("#processor-details").modal("setButtonModel",s).modal("show");e("#processor-details div.relationship-name").ellipsis()}).fail(g.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","d3","nf.Client","nf.Dialog","nf.Storage","nf.Common","nf.CanvasUtils","nf.ControllerServices","nf.ErrorHandler","nf.FilteredDialogCommon","nf.ReportingTask","nf.Shell","nf.ComponentState","nf.ComponentVersion","nf.PolicyManagement","nf.ParameterProvider"],function(k,g,r,s,j,l,h,i,e,n,m,o,f,q,c,p,d){return(nf.Settings=b(k,g,r,s,j,l,h,i,e,n,m,o,f,q,c,p,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Settings=b(require("jquery"),require("Slick"),require("d3"),require("nf.Client"),require("nf.Dialog"),require("nf.Storage"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ControllerServices"),require("nf.ErrorHandler"),require("nf.FilteredDialogCommon"),require("nf.ReportingTask"),require("nf.Shell"),require("nf.ComponentState"),require("nf.ComponentVersion"),require("nf.PolicyManagement"),require("nf.ParameterProvider")))}else{nf.Settings=b(a.$,a.Slick,a.d3,a.nf.Client,a.nf.Dialog,a.nf.Storage,a.nf.Common,a.nf.CanvasUtils,a.nf.ControllerServices,a.nf.ErrorHandler,a.nf.FilteredDialogCommon,a.nf.ReportingTask,a.nf.Shell,a.nf.ComponentState,a.nf.ComponentVersion,a.nf.PolicyManagement,a.nf.ParameterProvider)}}}(this,function(I,a,ac,m,o,z,aa,aj,S,d,ah,J,Z,f,A,E,ad){var P={urls:{api:"../nifi-api",controllerConfig:"../nifi-api/controller/config",reportingTaskTypes:"../nifi-api/flow/reporting-task-types",createReportingTask:"../nifi-api/controller/reporting-tasks",reportingTasks:"../nifi-api/flow/reporting-tasks",registries:"../nifi-api/controller/registry-clients",createParameterProvider:"../nifi-api/controller/parameter-providers",parameterProviderTypes:"../nifi-api/flow/parameter-provider-types",parameterProviders:"../nifi-api/flow/parameter-providers",registryTypes:"../nifi-api/controller/registry-types"}};var H={autosizeColsMode:a.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var y=function(){return I("#controller-services-table")};var af=function(aq){var ap=[];if(aa.isDefinedAndNotNull(aq.maxTimerDrivenThreadCount)&&!I.isNumeric(aq.maxTimerDrivenThreadCount)){ap.push("Maximum Timer Driven Thread Count must be an integer value")}if(aa.isDefinedAndNotNull(aq.maxEventDrivenThreadCount)&&!I.isNumeric(aq.maxEventDrivenThreadCount)){ap.push("Maximum Event Driven Thread Count must be an integer value")}if(ap.length>0){o.showOkDialog({dialogContent:aa.formatUnorderedList(ap),headerText:"Configuration Error"});return false}else{return true}};var r=function(ap){var ar=ai();if(af(ar)){var aq={revision:m.getRevision({revision:{version:ap}}),disconnectedNodeAcknowledged:z.isDisconnectionAcknowledged(),component:ar};I.ajax({type:"PUT",url:P.urls.controllerConfig,data:JSON.stringify(aq),dataType:"json",contentType:"application/json"}).done(function(at){o.showOkDialog({headerText:"Settings",dialogContent:"Settings successfully applied."});I("#settings-save").off("click").on("click",function(){r(at.revision.version)})}).fail(d.handleConfigurationUpdateAjaxError)}};var n=function(){};var ai=function(){var ap={};ap.maxTimerDrivenThreadCount=I("#maximum-timer-driven-thread-count-field").val();ap.maxEventDrivenThreadCount=I("#maximum-event-driven-thread-count-field").val();return ap};var ao=function(ar,aq){if(aq.searchString===""){return true}try{var av=new RegExp(aq.searchString,"i")}catch(au){return false}var at=ar.label.search(av)>=0;var ap=ar.tags.search(av)>=0;return at||ap};var u=function(ar,ap){var aq=[];I.each(ar,function(av,aw){aq.push(aw)});var at=ap.toLowerCase();var au=true;I.each(aq,function(av,aw){if(at.indexOf(aw)===-1){au=false;return false}});return au};var s=function(ap){return ap.restricted===false||aa.canAccessComponentRestrictions(ap.explicitRestrictions)};var C=function(au,aq,at,ar,ap){if(!ap.permissions.canRead){return'<span class="blank">'+aa.escapeHtml(ap.id)+"</span>"}return aa.escapeHtml(ap.component.name)};var am=function(ap,ar){var aq=function(aA,az){if(aA.permissions.canRead&&az.permissions.canRead){if(ap.columnId==="moreDetails"){var aw=0;if(!aa.isEmpty(aA.bulletins)){aw=aA.bulletins.length}var at=0;if(!aa.isEmpty(az.bulletins)){at=az.bulletins.length}return aw-at}else{if(ap.columnId==="type"){var ax=aa.isDefinedAndNotNull(aA.component[ap.columnId])?aa.substringAfterLast(aA.component[ap.columnId],"."):"";var av=aa.isDefinedAndNotNull(az.component[ap.columnId])?aa.substringAfterLast(az.component[ap.columnId],"."):"";return ax===av?0:ax>av?1:-1}else{if(ap.columnId==="state"){var ay;if(aA.component.validationStatus==="VALIDATING"){ay="Validating"}else{if(aA.component.validationStatus==="INVALID"){ay="Invalid"}else{ay=aa.isDefinedAndNotNull(aA.component[ap.columnId])?aA.component[ap.columnId]:""}}var aC;if(az.component.validationStatus==="VALIDATING"){aC="Validating"}else{if(az.component.validationStatus==="INVALID"){aC="Invalid"}else{aC=aa.isDefinedAndNotNull(az.component[ap.columnId])?az.component[ap.columnId]:""}}return ay===aC?0:ay>aC?1:-1}else{var au=aa.isDefinedAndNotNull(aA.component[ap.columnId])?aA.component[ap.columnId]:"";var aB=aa.isDefinedAndNotNull(az.component[ap.columnId])?az.component[ap.columnId]:"";return au===aB?0:au>aB?1:-1}}}}else{if(!aA.permissions.canRead&&!az.permissions.canRead){return 0}if(aA.permissions.canRead){return 1}else{return -1}}};ar.sort(aq,ap.sortAsc)};var L=function(){return I("#reporting-task-type-filter").val()};var i=function(){return I("#parameter-provider-type-filter").val()};var v=function(){var aq=I("#reporting-task-types-table").data("gridInstance");if(aa.isDefinedAndNotNull(aq)){var ap=aq.getData();ap.setFilterArgs({searchString:L()});ap.refresh();I("#new-reporting-task-dialog").modal("refreshButtons");if(ap.getLength()>0){ah.choseFirstRow(aq)}}};var ak=function(){var aq=I("#parameter-provider-types-table").data("gridInstance");if(aa.isDefinedAndNotNull(aq)){var ap=aq.getData();ap.setFilterArgs({searchString:i()});ap.refresh();I("#new-parameter-provider-dialog").modal("refreshButtons");if(ap.getLength()>0){ah.choseFirstRow(aq)}}};var ae=function(){I("#reporting-task-type-description").attr("title","").text("");I("#reporting-task-type-name").attr("title","").text("");I("#reporting-task-type-bundle").attr("title","").text("");I("#selected-reporting-task-name").text("");I("#selected-reporting-task-type").text("").removeData("bundle");I("#reporting-task-description-container").hide()};var K=function(){I("#parameter-provider-type-description").attr("title","").text("");I("#parameter-provider-type-name").attr("title","").text("");I("#parameter-provider-type-bundle").attr("title","").text("");I("#selected-parameter-provider-name").text("");I("#selected-parameter-provider-type").text("").removeData("bundle");I("#parameter-provider-description-container").hide()};var l=function(){ae();var ap=I("#reporting-task-types-table").data("gridInstance");ap.resetActiveCell()};var R=function(){K();var ap=I("#parameter-provider-types-table").data("gridInstance");ap.resetActiveCell()};var U=function(ay,at){var aw=ao(ay,at);var ar=true;if(aw){var ax=I("#reporting-task-tag-cloud").tagcloud("getSelectedTags");var av=ax.length>0;if(av){ar=u(ax,ay.tags)}}var au=true;if(aw&&ar){var ap=I("#reporting-task-bundle-group-combo").combo("getSelectedOption");if(aa.isDefinedAndNotNull(ap)&&ap.value!==""){au=(ay.bundle.group===ap.value)}}var aq=aw&&ar&&au;if(aq===false&&I("#selected-reporting-task-type").text()===ay.type){l()}return aq};var k=function(ay,at){var aw=ao(ay,at);var ar=true;if(aw){var ax=I("#parameter-provider-tag-cloud").tagcloud("getSelectedTags");var av=ax.length>0;if(av){ar=u(ax,ay.tags)}}var au=true;if(aw&&ar){var ap=I("#parameter-provider-bundle-group-combo").combo("getSelectedOption");if(aa.isDefinedAndNotNull(ap)&&ap.value!==""){au=(ay.bundle.group===ap.value)}}var aq=aw&&ar&&au;if(aq===false&&I("#selected-parameter-provider-type").text()===ay.type){R()}return aq};var Y=function(){var aq=I("#selected-reporting-task-type").text();var ap=I("#selected-reporting-task-type").data("bundle");if(aq===""){o.showOkDialog({headerText:"Settings",dialogContent:"The type of reporting task to create must be selected."})}else{q(aq,ap)}};var T=function(){var ap=I("#selected-parameter-provider-type").text();var aq=I("#selected-selected-parameter-type").data("bundle");if(ap===""){o.showOkDialog({headerText:"Settings",dialogContent:"The type of parameter provider to create must be selected."})}else{w(ap,aq)}};var q=function(ap,ar){var at={revision:m.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:z.isDisconnectionAcknowledged(),component:{type:ap,bundle:ar}};var aq=I.ajax({type:"POST",url:P.urls.createReportingTask,data:JSON.stringify(at),dataType:"json",contentType:"application/json"}).done(function(av){var ax=I("#reporting-tasks-table").data("gridInstance");var au=ax.getData();au.addItem(I.extend({type:"ReportingTask",bulletins:[]},av));au.reSort();ax.invalidate();var aw=au.getRowById(av.id);ah.choseRow(ax,aw);ax.scrollRowIntoView(aw)}).fail(d.handleAjaxError);I("#new-reporting-task-dialog").modal("hide");return aq};var h=function(){var ap=I("#new-registry-type-combo").combo("getSelectedOption");var aq={revision:m.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:z.isDisconnectionAcknowledged(),component:{name:I("#new-registry-name").val(),description:I("#new-registry-description").val(),type:ap.value}};var ar=I.ajax({type:"POST",url:P.urls.registries,data:JSON.stringify(aq),dataType:"json",contentType:"application/json"}).done(function(aw){var at=I("#registries-table").data("gridInstance");var au=at.getData();au.addItem(I.extend({type:"Registry"},aw));au.reSort();at.invalidate();var av=au.getRowById(aw.id);ah.choseRow(at,av);at.scrollRowIntoView(av);I("#registry-configuration-dialog").modal("hide");I("#new-registry-client-dialog").modal("hide")}).fail(d.handleConfigurationUpdateAjaxError);return ar};var w=function(at,ap){var aq={revision:m.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:z.isDisconnectionAcknowledged(),component:{type:at,bundle:ap}};var ar=I.ajax({type:"POST",url:P.urls.createParameterProvider,data:JSON.stringify(aq),dataType:"json",contentType:"application/json"}).done(function(av){var aw=I("#parameter-providers-table").data("gridInstance");var au=aw.getData();au.addItem(I.extend({type:"ParameterProvider",bulletins:[]},av));au.reSort();aw.invalidate();var ax=au.getRowById(av.id);ah.choseRow(aw,ax);aw.scrollRowIntoView(ax)}).fail(d.handleAjaxError);I("#new-parameter-provider-dialog").modal("hide");return ar};var G=function(av){var ar=I("#registries-table").data("gridInstance");var at=ar.getData();var aq=I("#registry-properties").propertytable("marshalProperties");var aw=at.getItemById(av);var au={revision:m.getRevision(aw),disconnectedNodeAcknowledged:z.isDisconnectionAcknowledged(),component:{id:av,name:I("#registry-name-config").val(),description:I("#registry-description-config").val()}};if(I.isEmptyObject(aq)===false){au.component["properties"]=aq}var ap=I.ajax({type:"PUT",url:aw.uri,data:JSON.stringify(au),dataType:"json",contentType:"application/json"}).done(function(ax){at.updateItem(ax.id,I.extend({type:"Registry"},ax));I("#registry-configuration-dialog").modal("hide")}).fail(d.handleConfigurationUpdateAjaxError);return ap};var j=function(){var aq=[{id:"type",name:"Type",field:"label",formatter:aa.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:aa.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:aa.genericValueFormatter}];var ap=new a.Data.DataView({inlineFilters:false});ap.setItems([]);ap.setFilterArgs({searchString:L()});ap.setFilter(U);aa.sortType({columnId:"type",sortAsc:true},ap);var au=new a.Grid("#reporting-task-types-table",ap,aq,H);au.setSelectionModel(new a.RowSelectionModel());au.registerPlugin(new a.AutoTooltips());au.setSortColumn("type",true);au.onSort.subscribe(function(aw,av){aa.sortType({columnId:av.sortCol.field,sortAsc:av.sortAsc},ap)});au.onSelectedRowsChanged.subscribe(function(aA,ax){if(I.isArray(ax.rows)&&ax.rows.length===1){var az=ax.rows[0];var av=au.getDataItem(az);if(aa.isDefinedAndNotNull(av)){I("#reporting-task-description-container").show();if(aa.isBlank(av.description)){I("#reporting-task-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{I("#reporting-task-type-description").width(I("#reporting-task-description-container").innerWidth()-1).html(av.description).ellipsis()}var aw=aa.formatBundle(av.bundle);var ay=aa.formatType(av);I("#reporting-task-type-name").text(ay).attr("title",ay);I("#reporting-task-type-bundle").text(aw).attr("title",aw);I("#selected-reporting-task-name").text(av.label);I("#selected-reporting-task-type").text(av.type).data("bundle",av.bundle);I("#new-reporting-task-dialog").modal("refreshButtons")}}});au.onDblClick.subscribe(function(ax,aw){var av=au.getDataItem(aw.row);if(s(av)){q(av.type,av.bundle)}});au.onViewportChanged.subscribe(function(aw,av){aa.cleanUpTooltips(I("#reporting-task-types-table"),"div.view-usage-restriction")});ap.onRowCountChanged.subscribe(function(aw,av){au.updateRowCount();au.render();I("#displayed-reporting-task-types").text(av.current)});ap.onRowsChanged.subscribe(function(aw,av){au.invalidateRows(av.rows);au.render()});ap.syncGridSelection(au,true);I("#reporting-task-types-table").data("gridInstance",au).on("mouseenter","div.slick-cell",function(ay){var az=I(this).find("div.view-usage-restriction");if(az.length&&!az.data("qtip")){var ax=I(this).find("span.row-id").text();var aw=ap.getItemById(ax);if(aw.restricted===true){var aA=I("<div></div>");if(aa.isBlank(aw.usageRestriction)){aA.append(I('<p style="margin-bottom: 3px;"></p>').text("Requires the following permissions:"))}else{aA.append(I('<p style="margin-bottom: 3px;"></p>').text(aw.usageRestriction+" Requires the following permissions:"))}var av=[];if(aa.isDefinedAndNotNull(aw.explicitRestrictions)){I.each(aw.explicitRestrictions,function(aB,aD){var aC=aD.requiredPermission;av.push("'"+aC.label+"' - "+aa.escapeHtml(aD.explanation))})}else{av.push("Access to restricted components regardless of restrictions.")}aA.append(aa.formatUnorderedList(av));az.qtip(I.extend({},aa.config.tooltipConfig,{content:aA,position:{container:I("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});var at=aa.getPolicyTypeListing("restricted-components");I.ajax({type:"GET",url:P.urls.reportingTaskTypes,dataType:"json"}).done(function(aw){var aB=0;var ay=[];var av=ac.set();var aA=ac.map();var az=ac.map();ap.beginUpdate();I.each(aw.reportingTaskTypes,function(aC,aD){if(aD.restricted===true){if(aa.isDefinedAndNotNull(aD.explicitRestrictions)){I.each(aD.explicitRestrictions,function(aE,aG){var aF=aG.requiredPermission;if(!az.has(aF.id)){az.set(aF.id,aF.label)}if(!aA.has(aF.id)){aA.set(aF.id,[])}aA.get(aF.id).push({type:aa.formatType(aD),bundle:aa.formatBundle(aD.bundle),explanation:aa.escapeHtml(aG.explanation)})})}else{if(!az.has(at.value)){az.set(at.value,at.text)}if(!aA.has(at.value)){aA.set(at.value,[])}aA.get(at.value).push({type:aa.formatType(aD),bundle:aa.formatBundle(aD.bundle),explanation:aa.escapeHtml(aD.usageRestriction)})}}av.add(aD.bundle.group);ap.addItem({id:aB+++"",label:aa.substringAfterLast(aD.type,"."),type:aD.type,bundle:aD.bundle,description:aa.escapeHtml(aD.description),restricted:aD.restricted,usageRestriction:aa.escapeHtml(aD.usageRestriction),explicitRestrictions:aD.explicitRestrictions,tags:aD.tags.join(", ")});I.each(aD.tags,function(aF,aE){ay.push(aE.toLowerCase())})});ap.endUpdate();ap.reSort();au.invalidate();aj.addComponentRestrictions(aA,az);I("#total-reporting-task-types, #displayed-reporting-task-types").text(aw.reportingTaskTypes.length);I("#reporting-task-tag-cloud").tagcloud({tags:ay,select:v,remove:v});var ax=[{text:"all groups",value:""}];av.each(function(aC){ax.push({text:aC,value:aC})});I("#reporting-task-bundle-group-combo").combo({options:ax,select:v})}).fail(d.handleAjaxError);var ar=[I.ui.keyCode.UP,I.ui.keyCode.PAGE_UP,I.ui.keyCode.DOWN,I.ui.keyCode.PAGE_DOWN];I("#reporting-task-type-filter").off("keyup").on("keyup",function(ay){var ax=ay.keyCode?ay.keyCode:ay.which;if(I.inArray(ax,ar)!==-1){return}if(ax===I.ui.keyCode.ENTER){var av=au.getSelectedRows();if(av.length>0){var aw=au.getDataItem(av[0]);if(s(aw)){Y()}}}else{v()}});ah.addKeydownListener("#reporting-task-type-filter",au,au.getData());I("#new-reporting-task-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Add Reporting Task",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var av=au.getSelectedRows();if(av.length>0){var aw=au.getDataItem(av[0]);return s(aw)===false}else{return au.getData().getLength()===0}},handler:{click:function(){Y()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){I(this).modal("hide")}}}],handler:{close:function(){ae();I("#reporting-task-type-filter").val("");I("#reporting-task-tag-cloud").tagcloud("clearSelectedTags");I("#reporting-task-bundle-group-combo").combo("setSelectedOption",{value:""});v();var av=I("#reporting-task-types-table").data("gridInstance");av.setSelectedRows([]);av.resetActiveCell()},resize:function(){I("#reporting-task-type-description").width(I("#reporting-task-description-container").innerWidth()-1).text(I("#reporting-task-type-description").attr("title")).ellipsis()}}});I("#registry-configuration-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){I("#registry-id-config").text("");I("#registry-name-config").val("");I("#registry-type-config").val("");I("#registry-description-config").val("")}}})};var D=function(){var at=[{id:"type",name:"Type",field:"label",formatter:aa.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:aa.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:aa.genericValueFormatter}];var ap=new a.Data.DataView({inlineFilters:false});ap.setItems([]);ap.setFilterArgs({searchString:i()});ap.setFilter(k);aa.sortType({columnId:"type",sortAsc:true},ap);var au=new a.Grid("#parameter-provider-types-table",ap,at,H);au.setSelectionModel(new a.RowSelectionModel());au.registerPlugin(new a.AutoTooltips());au.setSortColumn("type",true);au.onSort.subscribe(function(aw,av){aa.sortType({columnId:av.sortCol.field,sortAsc:av.sortAsc},ap)});au.onSelectedRowsChanged.subscribe(function(ay,aw){if(I.isArray(aw.rows)&&aw.rows.length===1){var aA=aw.rows[0];var az=au.getDataItem(aA);if(aa.isDefinedAndNotNull(az)){I("#parameter-provider-description-container").show();if(aa.isBlank(az.description)){I("#parameter-provider-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{I("#parameter-provider-type-description").width(I("#parameter-provider-description-container").innerWidth()-1).html(az.description).ellipsis()}var av=aa.formatBundle(az.bundle);var ax=aa.formatType(az);I("#parameter-provider-type-name").text(ax).attr("title",ax);I("#parameter-provider-type-bundle").text(av).attr("title",av);I("#selected-parameter-provider-name").text(az.label);I("#selected-parameter-provider-type").text(az.type).data("bundle",az.bundle);I("#new-parameter-provider-dialog").modal("refreshButtons")}}});au.onDblClick.subscribe(function(aw,av){var ax=au.getDataItem(av.row);if(s(ax)){w(ax.type,ax.bundle)}});au.onViewportChanged.subscribe(function(aw,av){aa.cleanUpTooltips(I("#parameter-provider-types-table"),"div.view-usage-restriction")});ap.onRowCountChanged.subscribe(function(aw,av){au.updateRowCount();au.render();I("#displayed-parameter-provider-types").text(av.current)});ap.onRowsChanged.subscribe(function(aw,av){au.invalidateRows(av.rows);au.render()});ap.syncGridSelection(au,true);I("#parameter-provider-types-table").data("gridInstance",au).on("mouseenter","div.slick-cell",function(ay){var az=I(this).find("div.view-usage-restriction");if(az.length&&!az.data("qtip")){var ax=I(this).find("span.row-id").text();var aw=ap.getItemById(ax);if(aw.restricted===true){var aA=I("<div></div>");if(aa.isBlank(aw.usageRestriction)){aA.append(I('<p style="margin-bottom: 3px;"></p>').text("Requires the following permissions:"))}else{aA.append(I('<p style="margin-bottom: 3px;"></p>').text(aw.usageRestriction+" Requires the following permissions:"))}var av=[];if(aa.isDefinedAndNotNull(aw.explicitRestrictions)){I.each(aw.explicitRestrictions,function(aB,aD){var aC=aD.requiredPermission;av.push("'"+aC.label+"' - "+aa.escapeHtml(aD.explanation))})}else{av.push("Access to restricted components regardless of restrictions.")}aA.append(aa.formatUnorderedList(av));az.qtip(I.extend({},aa.config.tooltipConfig,{content:aA,position:{container:I("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});var ar=aa.getPolicyTypeListing("restricted-components");I.ajax({type:"GET",url:P.urls.parameterProviderTypes,dataType:"json"}).done(function(aw){var aB=0;var ay=[];var av=ac.set();var aA=ac.map();var az=ac.map();ap.beginUpdate();I.each(aw.parameterProviderTypes,function(aC,aD){if(aD.restricted===true){if(aa.isDefinedAndNotNull(aD.explicitRestrictions)){I.each(aD.explicitRestrictions,function(aE,aG){var aF=aG.requiredPermission;if(!az.has(aF.id)){az.set(aF.id,aF.label)}if(!aA.has(aF.id)){aA.set(aF.id,[])}aA.get(aF.id).push({type:aa.formatType(aD),bundle:aa.formatBundle(aD.bundle),explanation:aa.escapeHtml(aG.explanation)})})}else{if(!az.has(ar.value)){az.set(ar.value,ar.text)}if(!aA.has(ar.value)){aA.set(ar.value,[])}aA.get(ar.value).push({type:aa.formatType(aD),bundle:aa.formatBundle(aD.bundle),explanation:aa.escapeHtml(aD.usageRestriction)})}}av.add(aD.bundle.group);ap.addItem({id:aB+++"",label:aa.substringAfterLast(aD.type,"."),type:aD.type,bundle:aD.bundle,description:aa.escapeHtml(aD.description),restricted:aD.restricted,usageRestriction:aa.escapeHtml(aD.usageRestriction),explicitRestrictions:aD.explicitRestrictions,tags:aD.tags.join(", ")});I.each(aD.tags,function(aF,aE){ay.push(aE.toLowerCase())})});ap.endUpdate();ap.reSort();au.invalidate();aj.addComponentRestrictions(aA,az);I("#total-parameter-provider-types, #displayed-parameter-provider-types").text(aw.parameterProviderTypes.length);I("#parameter-provider-tag-cloud").tagcloud({tags:ay,select:ak,remove:ak});var ax=[{text:"all groups",value:""}];av.each(function(aC){ax.push({text:aC,value:aC})});I("#parameter-provider-bundle-group-combo").combo({options:ax,select:ak})}).fail(d.handleAjaxError);var aq=[I.ui.keyCode.UP,I.ui.keyCode.PAGE_UP,I.ui.keyCode.DOWN,I.ui.keyCode.PAGE_DOWN];I("#parameter-provider-type-filter").off("keyup").on("keyup",function(ay){var ax=ay.keyCode?ay.keyCode:ay.which;if(I.inArray(ax,aq)!==-1){return}if(ax===I.ui.keyCode.ENTER){var av=au.getSelectedRows();if(av.length>0){var aw=au.getDataItem(av[0]);if(s(aw)){T()}}}else{ak()}});ah.addKeydownListener("#parameter-provider-type-filter",au,au.getData());I("#new-parameter-provider-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Add Parameter Provider",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var av=au.getSelectedRows();if(av.length>0){var aw=au.getDataItem(av[0]);return s(aw)===false}else{return au.getData().getLength()===0}},handler:{click:function(){T()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){I(this).modal("hide")}}}],handler:{close:function(){K();I("#parameter-provider-type-filter").val("");I("#parameter-provider-tag-cloud").tagcloud("clearSelectedTags");I("#parameter-provider-bundle-group-combo").combo("setSelectedOption",{value:""});ak();var av=I("#parameter-provider-types-table").data("gridInstance");av.setSelectedRows([]);av.resetActiveCell()},resize:function(){I("#parameter-provider-type-description").width(I("#parameter-provider-description-container").innerWidth()-1).text(I("#parameter-provider-type-description").attr("title")).ellipsis()}}})};var c=function(){j();var au=function(aD,ax,aC,az,aw){if(!aw.permissions.canRead){return""}var ay='<div title="View Details" class="pointer view-reporting-task fa fa-info-circle"></div>';ay+='<div title="Usage" class="pointer reporting-task-usage fa fa-book"></div>';var aA=!aa.isEmpty(aw.component.validationErrors);var aB=!aa.isEmpty(aw.bulletins);if(aA){ay+='<div class="pointer has-errors fa fa-warning" ></div>'}if(aB){ay+='<div class="has-bulletins fa fa-sticky-note-o"></div>'}if(aA||aB){ay+='<span class="hidden row-id">'+aa.escapeHtml(aw.component.id)+"</span>"}return ay};var av=function(aE,aD,aC,ay,aw){var aA="",aB="";if(aw.status.validationStatus==="VALIDATING"){aA="validating fa fa-spin fa-circle-notch";aB="Validating"}else{if(aw.status.validationStatus==="INVALID"){aA="invalid fa fa-warning";aB="Invalid"}else{if(aw.status.runStatus==="STOPPED"){aB="Stopped";aA="fa fa-stop stopped"}else{if(aw.status.runStatus==="RUNNING"){aB="Running";aA="fa fa-play running"}else{aB="Disabled";aA="icon icon-enable-false disabled"}}}}var az="";if(aa.isDefinedAndNotNull(aw.status.activeThreadCount)&&aw.status.activeThreadCount>0){az="("+aw.status.activeThreadCount+")"}var ax='<div layout="row"><div class="'+aA+'"></div>';return ax+'<div class="status-text">'+aa.escapeHtml(aB)+'</div><div style="float: left; margin-left: 4px;">'+aa.escapeHtml(az)+"</div></div>"};var at=function(aF,aD,aB,aA,aw){var aE="";var ax=aw.permissions.canWrite;var az=aw.permissions.canRead;var aC=aw.operatePermissions.canWrite||ax;var ay=aw.status.runStatus==="STOPPED";if(aw.status.runStatus==="RUNNING"){if(aC){aE+='<div title="Stop" class="pointer stop-reporting-task fa fa-stop"></div>'}}else{if(ay||aw.status.runStatus==="DISABLED"){if(az&&ax){aE+='<div title="Edit" class="pointer edit-reporting-task fa fa-pencil"></div>'}if(aC&&aw.status.runStatus==="STOPPED"&&aw.status.validationStatus==="VALID"){aE+='<div title="Start" class="pointer start-reporting-task fa fa-play"></div>'}if(az&&ax&&aw.component.multipleVersionsAvailable===true){aE+='<div title="Change Version" class="pointer change-version-reporting-task fa fa-exchange"></div>'}if(az&&ax&&aa.canModifyController()){aE+='<div title="Remove" class="pointer delete-reporting-task fa fa-trash"></div>'}}}if(az&&ax&&aw.component.persistsState===true){aE+='<div title="View State" class="pointer view-state-reporting-task fa fa-tasks"></div>'}if(aj.isManagedAuthorizer()&&aa.canAccessTenants()){aE+='<div title="Access Policies" class="pointer edit-access-policies fa fa-key"></div>'}return aE};var ap=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:au,sortable:true,width:90,maxWidth:90,toolTip:"Sorts based on presence of bulletins"},{id:"name",name:"Name",sortable:true,resizable:true,formatter:C},{id:"type",name:"Type",formatter:aa.instanceTypeFormatter,sortable:true,resizable:true},{id:"bundle",name:"Bundle",formatter:aa.instanceBundleFormatter,sortable:true,resizable:true},{id:"state",name:"Run Status",sortable:true,resizeable:true,formatter:av}];ap.push({id:"actions",name:"&nbsp;",resizable:false,formatter:at,sortable:false,width:115,maxWidth:115});var ar=new a.Data.DataView({inlineFilters:false});ar.setItems([]);am({columnId:"name",sortAsc:true},ar);var aq=new a.Grid("#reporting-tasks-table",ar,ap,H);aq.setSelectionModel(new a.RowSelectionModel());aq.registerPlugin(new a.AutoTooltips());aq.setSortColumn("name",true);aq.onSort.subscribe(function(ax,aw){am({columnId:aw.sortCol.id,sortAsc:aw.sortAsc},ar)});aq.onClick.subscribe(function(aA,ax){var az=I(aA.target);var ay=ar.getItem(ax.row);if(aq.getColumns()[ax.cell].id==="actions"){if(az.hasClass("edit-reporting-task")){J.showConfiguration(ay)}else{if(az.hasClass("start-reporting-task")){J.start(ay)}else{if(az.hasClass("stop-reporting-task")){J.stop(ay)}else{if(az.hasClass("delete-reporting-task")){J.promptToDeleteReportingTask(ay)}else{if(az.hasClass("view-state-reporting-task")){var aw=ay.status.runStatus==="STOPPED"&&ay.status.activeThreadCount===0;f.showState(ay,aw)}else{if(az.hasClass("change-version-reporting-task")){A.promptForVersionChange(ay)}else{if(az.hasClass("edit-access-policies")){E.showReportingTaskPolicy(ay);I("#shell-close-button").click()}}}}}}}}else{if(aq.getColumns()[ax.cell].id==="moreDetails"){if(az.hasClass("view-reporting-task")){J.showDetails(ay)}else{if(az.hasClass("reporting-task-usage")){I("#shell-close-button").click();Z.showPage("../nifi-docs/documentation?"+I.param({select:ay.component.type,group:ay.component.bundle.group,artifact:ay.component.bundle.artifact,version:ay.component.bundle.version})).done(function(){O.showSettings()})}}}}});ar.onRowCountChanged.subscribe(function(ax,aw){aq.updateRowCount();aq.render()});ar.onRowsChanged.subscribe(function(ax,aw){aq.invalidateRows(aw.rows);aq.render()});ar.syncGridSelection(aq,true);I("#reporting-tasks-table").data("gridInstance",aq).on("mouseenter","div.slick-cell",function(aC){var aA=I(this).find("div.has-errors");if(aA.length&&!aA.data("qtip")){var aw=I(this).find("span.row-id").text();var ay=ar.getItemById(aw);var az=aa.formatUnorderedList(ay.component.validationErrors);if(aa.isDefinedAndNotNull(az)){aA.qtip(I.extend({},aa.config.tooltipConfig,{content:az,position:{target:"mouse",viewport:I("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}var ax=I(this).find("div.has-bulletins");if(ax.length&&!ax.data("qtip")){var aw=I(this).find("span.row-id").text();var ay=ar.getItemById(aw);var aB=aa.getFormattedBulletins(ay.bulletins);var az=aa.formatUnorderedList(aB);if(aa.isDefinedAndNotNull(az)){ax.qtip(I.extend({},aa.config.tooltipConfig,{content:az,position:{target:"mouse",viewport:I("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}})};var g=function(){I("#new-registry-client-dialog").modal({headerText:"Add Registry Client",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){h()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){I(this).modal("hide")}}}]})};var B=function(){var at=function(aA,ax,az,ay,aw){if(!aw.permissions.canRead){return'<span class="blank">'+aa.escapeHtml(aw.id)+"</span>"}return aa.escapeHtml(aw.component.description)};var aq=function(aB,ax,aA,az,aw){var ay="";if(aa.canModifyController()){ay+='<div title="Edit" class="pointer edit-registry fa fa-pencil"></div>';ay+='<div title="Remove" class="pointer remove-registry fa fa-trash"></div>'}return ay};var av=function(aD,ax,aC,az,aw){if(!aw.permissions.canRead){return""}var ay="";var aA=!aa.isEmpty(aw.component.validationErrors);var aB=!aa.isEmpty(aw.bulletins);if(aA){ay+='<div class="pointer has-errors fa fa-warning"></div>'}if(aB){ay+='<div class="has-bulletins fa fa-sticky-note-o"></div>'}if(aA||aB){ay+='<span class="hidden row-id">'+aa.escapeHtml(aw.id)+"</span>"}return ay};var au=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:av,sortable:true,width:90,maxWidth:90},{id:"name",name:"Name",field:"name",formatter:C,sortable:true,resizable:true},{id:"description",name:"Description",field:"description",formatter:at,sortable:true,resizable:true}];au.push({id:"actions",name:"&nbsp;",resizable:false,formatter:aq,sortable:false,width:90,maxWidth:90});var ar=new a.Data.DataView({inlineFilters:false});ar.setItems([]);am({columnId:"name",sortAsc:true},ar);var ap=new a.Grid("#registries-table",ar,au,H);ap.setSelectionModel(new a.RowSelectionModel());ap.registerPlugin(new a.AutoTooltips());ap.setSortColumn("name",true);ap.onSort.subscribe(function(ax,aw){am({columnId:aw.sortCol.id,sortAsc:aw.sortAsc},ar)});I("#registries-table").data("gridInstance",ap).on("mouseenter","div.slick-cell",function(az){var ax=I(this).find("div.has-errors");if(ax.length&&!ax.data("qtip")){var ay=I(this).find("span.row-id").text();var aA=ar.getItemById(ay);var aw=aa.formatUnorderedList(aA.component.validationErrors);if(aa.isDefinedAndNotNull(aw)){ax.qtip(I.extend({},aa.config.tooltipConfig,{content:aw,position:{target:"mouse",viewport:I("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}});ap.onClick.subscribe(function(ay,aw){var ax=I(ay.target);var az=ar.getItem(aw.row);if(ap.getColumns()[aw.cell].id==="actions"){if(ax.hasClass("edit-registry")){N(az)}else{if(ax.hasClass("remove-registry")){x(az)}}}else{if(ap.getColumns()[aw.cell].id==="moreDetails"){}}});ar.onRowCountChanged.subscribe(function(ax,aw){ap.updateRowCount();ap.render()});ar.onRowsChanged.subscribe(function(ax,aw){ap.invalidateRows(aw.rows);ap.render()});ar.syncGridSelection(ap,true);I("#registries-table").data("gridInstance",ap)};var al=function(){D();var aq=function(aC,aw,aB,ay,av){if(!av.permissions.canRead){return""}var ax='<div title="View Details" class="pointer view-parameter-provider fa fa-info-circle"></div>';ax+='<div title="Usage" class="pointer parameter-provider-usage fa fa-book"></div>';var az=!aa.isEmpty(av.component.validationErrors);var aA=!aa.isEmpty(av.bulletins);if(az){ax+='<div class="pointer has-errors fa fa-warning" ></div>'}if(aA){ax+='<div class="has-bulletins fa fa-sticky-note-o"></div>'}if(az||aA){ax+='<span class="hidden row-id">'+aa.escapeHtml(av.component.id)+"</span>"}return ax};var at=function(aE,aC,aA,az,av){var aD="";var aw=av.permissions.canWrite;var ax=av.permissions.canRead;var aB=ax?!aa.isEmpty(av.component.validationErrors):null;var ay=true;if(ax&&av.component.referencingParameterContexts){(av.component.referencingParameterContexts).every(function(aF){return ay=aF.permissions.canRead})}if(ax&&aw){aD+='<div title="Edit" class="pointer edit-parameter-provider fa fa-pencil"></div>';if(ay&&!aB){aD+='<div title="Fetch Parameters" class="pointer fetch-parameter-provider fa fa-arrow-circle-down"></div>'}}if(ax&&aw&&aa.canModifyController()){aD+='<div title="Remove" class="pointer delete-parameter-provider fa fa-trash"></div>'}if(aj.isManagedAuthorizer()&&aa.canAccessTenants()){aD+='<div title="Access Policies" class="pointer edit-access-policies fa fa-key"></div>'}return aD};var ap=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:aq,sortable:true,width:90,maxWidth:90,toolTip:"Sorts based on presence of bulletins"},{id:"name",name:"Name",sortable:true,resizable:true,formatter:C},{id:"type",name:"Type",formatter:aa.instanceTypeFormatter,sortable:true,resizable:true},{id:"bundle",name:"Bundle",formatter:aa.instanceBundleFormatter,sortable:true,resizable:true}];ap.push({id:"actions",name:"&nbsp;",resizable:false,formatter:at,sortable:false,width:115,maxWidth:115});var au=new a.Data.DataView({inlineFilters:false});au.setItems([]);am({columnId:"name",sortAsc:true},au);var ar=new a.Grid("#parameter-providers-table",au,ap,H);ar.setSelectionModel(new a.RowSelectionModel());ar.registerPlugin(new a.AutoTooltips());ar.setSortColumn("name",true);ar.onSort.subscribe(function(aw,av){am({columnId:av.sortCol.id,sortAsc:av.sortAsc},au)});ar.onClick.subscribe(function(ay,aw){var ax=I(ay.target);var av=au.getItem(aw.row);if(ar.getColumns()[aw.cell].id==="actions"){if(ax.hasClass("edit-parameter-provider")){ad.showConfiguration(av)}else{if(ax.hasClass("fetch-parameter-provider")){ad.showFetchDialog(av)}else{if(ax.hasClass("delete-parameter-provider")){ad.promptToDeleteParameterProvider(av)}else{if(ax.hasClass("edit-access-policies")){E.showParameterProviderPolicy(av);I("#shell-close-button").click()}}}}}else{if(ar.getColumns()[aw.cell].id==="moreDetails"){if(ax.hasClass("view-parameter-provider")){ad.showDetails(av)}else{if(ax.hasClass("parameter-provider-usage")){I("#shell-close-button").click();Z.showPage("../nifi-docs/documentation?"+I.param({select:av.component.type,group:av.component.bundle.group,artifact:av.component.bundle.artifact,version:av.component.bundle.version})).done(function(){O.showSettings()})}}}}});au.onRowCountChanged.subscribe(function(aw,av){ar.updateRowCount();ar.render()});au.onRowsChanged.subscribe(function(aw,av){ar.invalidateRows(av.rows);ar.render()});au.syncGridSelection(ar,true);I("#parameter-providers-table").data("gridInstance",ar).on("mouseenter","div.slick-cell",function(aC){var aA=I(this).find("div.has-errors");if(aA.length&&!aA.data("qtip")){var aw=I(this).find("span.row-id").text();var az=au.getItemById(aw);var ay=aa.formatUnorderedList(az.component.validationErrors);if(aa.isDefinedAndNotNull(ay)){aA.qtip(I.extend({},aa.config.tooltipConfig,{content:ay,position:{target:"mouse",viewport:I("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}var ax=I(this).find("div.has-bulletins");if(ax.length&&!ax.data("qtip")){var aw=I(this).find("span.row-id").text();var av=au.getItemById(aw);var aB=aa.getFormattedBulletins(av.bulletins);var ay=aa.formatUnorderedList(aB);if(aa.isDefinedAndNotNull(ay)){ax.qtip(I.extend({},aa.config.tooltipConfig,{content:ay,position:{target:"mouse",viewport:I("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}})};var N=function(ap){p(ap.id).done(function(aq){var ar=aq.component.properties;var at=aq.component.descriptors;I("#registry-id-config").text(aq.id);I("#registry-name-config").val(aq.component.name);I("#registry-type-config").text(aq.component.type);I("#registry-description-config").val(aq.component.description);I("#registry-configuration-dialog").modal("setHeaderText","Edit Registry Client").modal("setButtonModel",[{buttonText:"Update",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){G(aq.id)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){I(this).modal("hide")}}}]).modal("show");I("#registry-properties").propertytable("clear");I("#registry-properties").propertytable("loadProperties",ar,at);I("#registry-configuration-dialog").data("registryDetails",aq)})};var x=function(ap){o.showYesNoDialog({headerText:"Delete Registry",dialogContent:"Delete registry '"+aa.escapeHtml(ap.component.name)+"'?",yesHandler:function(){b(ap)}})};var b=function(aq){var ap=m.getRevision(aq);I.ajax({type:"DELETE",url:aq.uri+"?"+I.param({version:ap.version,clientId:ap.clientId,disconnectedNodeAcknowledged:z.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(at){var ar=I("#registries-table").data("gridInstance");var au=ar.getData();au.deleteItem(aq.id)}).fail(d.handleAjaxError)};var ab=function(){var ax=function(){I("#read-only-maximum-timer-driven-thread-count-field").addClass("unset").text("Unauthorized");I("#read-only-maximum-event-driven-thread-count-field").addClass("unset").text("Unauthorized")};var au=function(ay){if(ay){I("#general-settings div.editable").show();I("#general-settings div.read-only").hide();I("#settings-save").show()}else{I("#general-settings div.editable").hide();I("#general-settings div.read-only").show();I("#settings-save").hide()}};var at=I.Deferred(function(ay){I.ajax({type:"GET",url:P.urls.controllerConfig,dataType:"json"}).done(function(az){if(az.permissions.canWrite){I("#maximum-timer-driven-thread-count-field").removeClass("unset").val(az.component.maxTimerDrivenThreadCount);I("#maximum-event-driven-thread-count-field").removeClass("unset").val(az.component.maxEventDrivenThreadCount);au(true);I("#settings-save").off("click").on("click",function(){r(az.revision.version)})}else{if(az.permissions.canRead){I("#read-only-maximum-timer-driven-thread-count-field").removeClass("unset").text(az.component.maxTimerDrivenThreadCount);I("#read-only-maximum-event-driven-thread-count-field").removeClass("unset").text(az.component.maxEventDrivenThreadCount)}else{ax()}au(false)}ay.resolve()}).fail(function(aB,az,aA){if(aB.status===403){ax();au(false);ay.resolve()}else{ay.reject(aB,az,aA)}})}).promise();var ap=P.urls.api+"/flow/controller/controller-services";var ar=S.loadControllerServices(ap,y());var av=Q();var aq=an();var aw=t();return I.when(at,ar,av,aq,aw).done(function(aA,az){var ay=az[0];I("#settings-last-refreshed").text(ay.currentTime)}).fail(d.handleAjaxError)};var Q=function(){return I.ajax({type:"GET",url:P.urls.reportingTasks,dataType:"json"}).done(function(ap){var au=[];I.each(ap.reportingTasks,function(aw,av){au.push(I.extend({type:"ReportingTask",bulletins:[]},av))});var ar=I("#reporting-tasks-table");aa.cleanUpTooltips(ar,"div.has-errors");aa.cleanUpTooltips(ar,"div.has-bulletins");var aq=ar.data("gridInstance");var at=aq.getData();at.setItems(au);at.reSort();aq.invalidate()})};var an=function(){return I.ajax({type:"GET",url:P.urls.registries,dataType:"json"}).done(function(ap){var aq=[];I.each(ap.registries,function(au,av){aq.push(I.extend({type:"Registry"},av))});var ar=I("#registries-table").data("gridInstance");var at=ar.getData();at.setItems(aq);at.reSort();ar.invalidate()})};var t=function(){return I.ajax({type:"GET",url:P.urls.parameterProviders,dataType:"json"}).done(function(ap){var at=[];I.each(ap.parameterProviders,function(av,aw){at.push(I.extend({type:"ParameterProvider",bulletins:[]},aw))});var ar=I("#parameter-providers-table");aa.cleanUpTooltips(ar,"div.has-errors");aa.cleanUpTooltips(ar,"div.has-bulletins");var aq=ar.data("gridInstance");var au=aq.getData();au.setItems(at);au.reSort();aq.invalidate()})};var e=function(){return I.ajax({type:"GET",url:P.urls.registryTypes,dataType:"json"}).done(function(ap){var aq=[];ap.flowRegistryClientTypes.forEach(function(ar){aq.push({text:aa.substringAfterLast(ar.type,"."),value:ar.type,description:ar.description||""})});I("#new-registry-type-combo").combo({options:aq})})};var M=function(){var ap=I("#registry-configuration-dialog").data("registryDetails");if(I("#registry-name-config").val()!==ap.component.name){return true}if(I("#registry-description-config").val()!==ap.component.description){return true}return I("#registry-properties").propertytable("isSaveRequired")};var W=function(){return I.Deferred(function(ap){I("#registry-properties").propertytable("saveRow");if(M()){o.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){ap.resolve()},yesHandler:function(){var aq=I("#registry-configuration-dialog").data("registryDetails");G(aq.id).done(function(){ap.resolve()}).fail(function(){ap.reject()})}})}else{ap.resolve()}}).promise()};var ag=function(aq,ap){var ar=I("#registry-configuration-dialog").data("registryDetails");return I.ajax({type:"GET",url:ar.uri+"/descriptors",data:{propertyName:aq,sensitive:ap},dataType:"json"}).fail(d.handleAjaxError)};var F=function(){Z.showContent("#settings").done(function(){V()});I("#settings-tabs").find(".selected-tab").click();O.resetTableSize()};var V=function(){I("#settings-save").mouseout()};var X=function(ar){var ap=I("#registries-table").data("gridInstance");var aq=ap.getData();aq.updateItem(ar.id,I.extend({type:"Registry"},ar))};var p=function(at){var ap=I("#registries-table").data("gridInstance");var aq=ap.getData();var ar=aq.getItemById(at);return I.ajax({type:"GET",url:ar.uri,dataType:"json"}).done(function(au){X(au)}).fail(d.handleAjaxError)};var O={init:function(){I("#settings-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"General",tabContentId:"general-settings-tab-content"},{name:"Management Controller Services",tabContentId:"controller-services-tab-content"},{name:"Reporting Tasks",tabContentId:"reporting-tasks-tab-content"},{name:"Registry Clients",tabContentId:"registries-tab-content"},{name:"Parameter Providers",tabContentId:"parameter-providers-tab-content"}],select:function(){var ap=I(this).text();if(ap==="General"){I("#controller-cs-availability").hide();I("#new-service-or-task").hide();I("#settings-save").show()}else{var aq=false;if(aa.isDefinedAndNotNull(aa.currentUser)){aq=aa.currentUser.controllerPermissions.canWrite===true}if(aq){I("#new-service-or-task").show();I("div.controller-settings-table").css("top","32px");I("#new-service-or-task").attr("title",function(){if(ap==="Management Controller Services"){I("#settings-save").hide();return"Create a new controller level controller service"}else{if(ap==="Reporting Tasks"){I("#settings-save").hide();return"Create a new reporting task"}else{if(ap==="Registry Clients"){I("#settings-save").hide();return"Register a new registry client"}else{if(ap==="Parameter Providers"){I("#settings-save").hide();return"Add a new parameter provider"}}}}})}else{I("#new-service-or-task").hide();I("div.controller-settings-table").css("top","0")}if(ap==="Management Controller Services"){I("#controller-cs-availability").show()}else{if(ap==="Reporting Tasks"||ap==="Registry Clients"||ap==="Parameter Providers"){I("#controller-cs-availability").hide()}}O.resetTableSize()}}});I("#settings-refresh-button").click(function(){ab()});I("#new-service-or-task").on("click",function(){var at=I("#settings-tabs li.selected-tab").text();if(at==="Management Controller Services"){var ar=P.urls.api+"/controller/controller-services";S.promptNewControllerService(ar,y())}else{if(at==="Reporting Tasks"){I("#new-reporting-task-dialog").modal("show");var au=I("#reporting-task-types-table").data("gridInstance");if(aa.isDefinedAndNotNull(au)){var ap=au.getData();au.resizeCanvas();if(ap.getLength()>0){ah.choseFirstRow(au)}}I("#reporting-task-type-filter").focus()}else{if(at==="Registry Clients"){I("#new-registry-name").val("");I("#new-registry-description").val("");e().done(function(){I("#new-registry-client-dialog").modal("show");I("#new-registry-name").focus()})}else{if(at==="Parameter Providers"){I("#new-parameter-provider-dialog").modal("show");var av=I("#parameter-provider-types-table").data("gridInstance");if(aa.isDefinedAndNotNull(av)){var aq=av.getData();av.resizeCanvas();if(aq.getLength()>0){ah.choseFirstRow(av)}}I("#parameter-provider-type-filter").focus()}}}}});I("#registry-properties").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-registry-property-container",descriptorDeferred:ag,controllerServiceCreatedDeferred:function(aq){var ap=P.urls.api+"/flow/controller/controller-services";return S.loadControllerServices(ap,I("#controller-services-table"))},goToServiceDeferred:W});I("#registry-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"registry-configuration-settings-tab-content"},{name:"Properties",tabContentId:"registry-configuration-properties-tab-content"}],select:function(){var ap=I(this).text();if(ap==="Properties"){I("#registry-properties").propertytable("resetTableSize")}}});n();S.init(y(),O.showSettings);c();B();g();al()},reloadRegistry:function(ap){return p(ap)},resetTableSize:function(){S.resetTableSize(y());var aq=I("#reporting-tasks-table").data("gridInstance");if(aa.isDefinedAndNotNull(aq)){aq.resizeCanvas()}var ap=I("#parameter-providers-table").data("gridInstance");if(aa.isDefinedAndNotNull(ap)){ap.resizeCanvas()}},showSettings:function(){return ab().done(F)},loadSettings:function(){return ab()},selectControllerService:function(ap){var aq=y().data("gridInstance");var ar=aq.getData();var at=ar.getRowById(ap);ah.choseRow(aq,at);aq.scrollRowIntoView(at);I("#settings-tabs").find("li:eq(1)").click()},selectReportingTask:function(ap){var at=I("#reporting-tasks-table").data("gridInstance");var aq=at.getData();var ar=aq.getRowById(ap);ah.choseRow(at,ar);at.scrollRowIntoView(ar);I("#settings-tabs").find("li:eq(2)").click()},setBulletins:function(ar,ap){if(I("#controller-services-table").data("gridInstance")){S.setBulletins(y(),ar)}var aq=I("#reporting-tasks-table").data("gridInstance");var au=aq.getData();au.beginUpdate();if(!aa.isEmpty(ap)){var av=ac.nest().key(function(aw){return aw.sourceId}).map(ap,ac.map);av.each(function(aw,ax){var ay=au.getItemById(ax);if(aa.isDefinedAndNotNull(ay)){au.updateItem(ax,I.extend(ay,{bulletins:aw}))}})}else{var at=au.getItems();I.each(at,function(aw,ax){au.updateItem(ax.id,I.extend(ax,{bulletins:[]}))})}au.endUpdate()}};return O}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.ProcessGroup","nf.Shell","nf.CanvasUtils"],function(h,k,j,f,g,i,l,c,d,e){return(nf.ProcessGroupConfiguration=b(h,k,j,f,g,i,l,c,d,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessGroupConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.ProcessGroup"),require("nf.Shell"),require("nf.CanvasUtils")))}else{nf.ProcessGroupConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.ProcessGroup,a.nf.Shell,a.nf.CanvasUtils)}}}(this,function(e,t,g,i,k,f,u,h,r,o){var d;var m;var b;var s={urls:{api:"../nifi-api",parameterContexts:"../nifi-api/flow/parameter-contexts"}};var l=function(){};var c=function(){return e("#process-group-controller-services-table")};var a=function(v,x){var w={revision:u.getRevision({revision:{version:v}}),disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged(),component:{id:x,name:e("#process-group-name").val(),comments:e("#process-group-comments").val(),parameterContext:{id:e("#process-group-parameter-context-combo").combo("getSelectedOption").value},flowfileConcurrency:e("#process-group-flowfile-concurrency-combo").combo("getSelectedOption").value,flowfileOutboundPolicy:e("#process-group-outbound-policy-combo").combo("getSelectedOption").value,defaultFlowFileExpiration:e("#process-group-default-flowfile-expiration").val(),defaultBackPressureObjectThreshold:e("#process-group-default-back-pressure-object-threshold").val(),defaultBackPressureDataSizeThreshold:e("#process-group-default-back-pressure-data-size-threshold").val()}};e.ajax({type:"PUT",data:JSON.stringify(w),url:s.urls.api+"/process-groups/"+encodeURIComponent(x),dataType:"json",contentType:"application/json"}).done(function(z){if(z.permissions.canRead&&z.component.parentGroupId===o.getGroupId()){h.set(z)}k.showOkDialog({headerText:"Process Group Configuration",dialogContent:"Process group configuration successfully saved."});e("#process-group-configuration-save").off("click").on("click",function(){a(z.revision.version,x)});var y=s.urls.api+"/flow/process-groups/"+encodeURIComponent(x)+"/controller-services";e.ajax({type:"GET",url:y,dataType:"json",data:{uiOnly:true}}).done(function(A){var C=c();i.cleanUpTooltips(C,"div.has-errors");var B=C.data("gridInstance");var D=B.getData();e.each(A.controllerServices,function(F,E){D.updateItem(E.id,E)})});o.reload()}).fail(g.handleConfigurationUpdateAjaxError)};var n=function(x){var A=function(){e("#read-only-process-group-name").text("Unauthorized");e("#read-only-process-group-comments").text("Unauthorized");e("#read-only-process-group-default-flowfile-expiration").text("Unauthorized");e("#read-only-process-group-default-back-pressure-object-threshold").text("Unauthorized");e("#read-only-process-group-default-back-pressure-data-size-threshold").text("Unauthorized")};var z=function(C){if(C){e("#process-group-configuration div.editable").show();e("#process-group-configuration div.read-only").hide();e("#process-group-configuration-save").show()}else{e("#process-group-configuration div.editable").hide();e("#process-group-configuration div.read-only").show();e("#process-group-configuration-save").hide()}};e("#process-group-id").text(x);e("#process-group-configuration-refresh-button").off("click").on("click",function(){n(x)});e("#add-process-group-configuration-controller-service").off("click").on("click",function(){var D=e("#process-group-configuration-tabs li.selected-tab").text();if(D==="Controller Services"){var C=s.urls.api+"/process-groups/"+encodeURIComponent(x)+"/controller-services";d.promptNewControllerService(C,c())}});var y=e.Deferred(function(C){e.ajax({type:"GET",url:s.urls.api+"/process-groups/"+encodeURIComponent(x),dataType:"json",data:{uiOnly:true}}).done(function(D){e("#process-group-configuration").data("process-group",D);var F=D.component;if(D.permissions.canWrite){e("#process-group-name").removeClass("unset").val(F.name);e("#process-group-comments").removeClass("unset").val(F.comments);e("#process-group-flowfile-concurrency-combo").removeClass("unset").combo({options:[{text:"Single FlowFile Per Node",value:"SINGLE_FLOWFILE_PER_NODE",description:"Only a single FlowFile is to be allowed to enter the Process Group at a time on each node in the cluster. While that FlowFile may be split into many or spawn many children, no additional FlowFiles will be allowed to enter the Process Group through a Local Input Port until the previous FlowFile - and all of its child/descendent FlowFiles - have been processed."},{text:"Single Batch Per Node",value:"SINGLE_BATCH_PER_NODE",description:"When an Input Port pulls a FlowFile into the Process Group, FlowFiles will continue to be ingested into the Process Group until all input queues have been emptied. At that point, no additional FlowFiles will be allowed to enter the Process Group through a Local Input Port until the entire batch of FlowFiles has been processed."},{text:"Unbounded",value:"UNBOUNDED",description:"The number of FlowFiles that can be processed concurrently is unbounded."}],selectedOption:{value:F.flowfileConcurrency}});e("#process-group-outbound-policy-combo").removeClass("unset").combo({options:[{text:"Stream When Available",value:"STREAM_WHEN_AVAILABLE",description:"FlowFiles that are queued up to be transferred out of a Process Group by an Output Port will be transferred out of the Process Group as soon as they are available."},{text:"Batch Output",value:"BATCH_OUTPUT",description:"FlowFiles that are queued up to be transferred out of a Process Group by an Output Port will remain queued until all FlowFiles in the Process Group are ready to be transferred out of the group. The FlowFiles will then be transferred out of the group. This setting will be ignored if the FlowFile Concurrency is Unbounded."}],selectedOption:{value:F.flowfileOutboundPolicy}});e("#process-group-default-flowfile-expiration").removeClass("unset").val(F.defaultFlowFileExpiration);e("#process-group-default-back-pressure-object-threshold").removeClass("unset").val(F.defaultBackPressureObjectThreshold);e("#process-group-default-back-pressure-data-size-threshold").removeClass("unset").val(F.defaultBackPressureDataSizeThreshold);e("#process-group-configuration-header-text").text(F.name+" Configuration");z(true);e("#process-group-configuration-save").off("click").on("click",function(){a(D.revision.version,D.id)})}else{if(D.permissions.canRead){e("#read-only-process-group-name").text(F.name);e("#read-only-process-group-comments").text(F.comments);var G;if(F.flowfileConcurrency=="UNBOUNDED"){G="Unbounded"}else{if(F.flowfileConcurrency=="SINGLE_FLOWFILE_PER_NODE"){G="Single FlowFile Per Node"}else{if(F.flowfileConcurrency=="SINGLE_BATCH_PER_NODE"){G="Single Batch Per Node"}else{G="Unknown"}}}e("#read-only-process-group-flowfile-concurrency").text(G);var E=F.flowfileOutboundPolicy=="BATCH_OUTPUT"?"Batch Output":"Stream When Available";e("#read-only-process-group-outbound-policy").text(E);e("#process-group-configuration-header-text").text(F.name+" Configuration");e("#process-group-default-flowfile-expiration").text(F.defaultFlowFileExpiration);e("#process-group-default-back-pressure-object-threshold").text(F.defaultBackPressureObjectThreshold);e("#process-group-default-back-pressure-data-size-threshold").text(F.defaultBackPressureDataSizeThreshold);e("#read-only-process-group-default-flowfile-expiration").text(F.defaultFlowFileExpiration);e("#read-only-process-group-default-back-pressure-object-threshold").text(F.defaultBackPressureObjectThreshold);e("#read-only-process-group-default-back-pressure-data-size-threshold").text(F.defaultBackPressureDataSizeThreshold)}else{A()}z(false)}C.resolve(D)}).fail(function(G,D,E){if(G.status===403){var F;if(x===o.getGroupId()){F={permissions:{canRead:false,canWrite:o.canWriteCurrentGroup()}}}else{F=h.get(x)}e("#process-group-configuration").data("process-group",F);A();z(false);C.resolve(F)}else{C.reject(G,D,E)}})}).promise();var v=s.urls.api+"/flow/process-groups/"+encodeURIComponent(x)+"/controller-services";var w=d.loadControllerServices(v,c());var B=e.ajax({type:"GET",url:s.urls.parameterContexts,dataType:"json"});return e.when(y,w,B).done(function(G,K,E){var M=K[0];var O=E[0];e("#process-group-configuration-last-refreshed").text(M.currentTime);var F=O.parameterContexts;var P=[{text:"No parameter context",value:null}];var D=F.filter(function(Q){return Q.permissions.canRead});var L=F.filter(function(Q){return !Q.permissions.canRead});var N=D.sort(function(R,Q){if(R.component.name<Q.component.name){return -1}if(R.component.name>Q.component.name){return 1}return 0});var J=L.sort(function(R,Q){if(R.id<Q.id){return -1}if(R.id>Q.id){return 1}return 0});var C=N.concat(J);C.forEach(function(R){var Q;if(R.permissions.canRead){Q={text:R.component.name,value:R.id,description:R.component.description}}else{Q={disabled:true,text:R.id,value:R.id}}P.push(Q)});var I={text:"Create new parameter context...",value:undefined,optionClass:"unset"};if(i.canModifyParameterContexts()){P.push(I)}var H={options:P,select:function(Q){var R=this;if(typeof Q.value==="undefined"){e("#parameter-context-dialog").modal("setHeaderText","Add Parameter Context").modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){if(e("#parameter-context-name").val()!==""){return false}return true},handler:{click:function(){m.addParameterContext(function(T){P.pop();var S={text:T.component.name,value:T.component.id,description:T.component.description};P.push(S);if(i.canModifyParameterContexts()){P.push(I)}H.selectedOption={value:T.component.id};R.combo("destroy").combo(H)})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e(this).modal("hide")}}}]).modal("show");if(e("#parameter-context-dialog").hasClass("read-only")){e("#parameter-context-dialog").removeClass("read-only");e("#parameter-context-dialog").addClass("edit-mode")}if(!e("#parameter-context-id-setting").hasClass("hidden")){e("#parameter-context-id-setting").addClass("hidden")}e("#parameter-context-name").focus()}}};if(i.isDefinedAndNotNull(G.parameterContext)){H.selectedOption={value:G.parameterContext.id}}e("#process-group-parameter-context-combo").combo("destroy").combo(H)}).fail(g.handleAjaxError)};var p=function(){r.showContent("#process-group-configuration").done(function(){q()});e("#process-group-configuration-tabs").find(".selected-tab").click();j.resetTableSize()};var q=function(){e("#process-group-configuration").removeData("process-group");e("#process-group-configuration-save").mouseout();e("#process-group-id").text("");e("#process-group-name").val("");e("#process-group-comments").val("");e("#process-group-default-flowfile-expiration").val("");e("#process-group-default-back-pressure-object-threshold").val("");e("#process-group-default-back-pressure-data-size-threshold").val("");e("#process-group-configuration-header-text").text("Process Group Configuration")};var j={init:function(w,v){d=w;m=v;e("#process-group-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"General",tabContentId:"general-process-group-configuration-tab-content"},{name:"Controller Services",tabContentId:"process-group-controller-services-tab-content"}],select:function(){var y=e("#process-group-configuration").data("process-group");var z=i.isDefinedAndNotNull(y)?y.permissions.canWrite:false;var x=e(this).text();if(x==="General"){e("#flow-cs-availability").hide();e("#add-process-group-configuration-controller-service").hide();if(z){e("#process-group-configuration-save").show()}else{e("#process-group-configuration-save").hide()}}else{e("#flow-cs-availability").show();e("#process-group-configuration-save").hide();if(z){e("#add-process-group-configuration-controller-service").show();e("#process-group-controller-services-tab-content").css("top","32px")}else{e("#add-process-group-configuration-controller-service").hide();e("#process-group-controller-services-tab-content").css("top","0")}j.resetTableSize()}}});l();d.init(c())},resetTableSize:function(){d.resetTableSize(c())},showConfiguration:function(v){return n(v).done(p)},loadConfiguration:function(v){return n(v)},selectControllerService:function(v){var w=c().data("gridInstance");var x=w.getData();var y=x.getRowById(v);w.setSelectedRows([y]);w.scrollRowIntoView(y);e("#process-group-configuration-tabs").find("li:eq(1)").click()}};return j}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.ErrorHandler"],function(c,d,e){return(nf.ConnectionDetails=b(c,d,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ConnectionDetails=b(require("jquery"),require("nf.Common"),require("nf.ErrorHandler")))}else{nf.ConnectionDetails=b(a.$,a.nf.Common,a.nf.ErrorHandler)}}}(this,function(d,b,g){var j=function(o,q,p){if(p.type==="PROCESSOR"){return k(o,q,p)}else{if(p.type==="FUNNEL"){return l(o,q,p)}else{if(p.type==="REMOTE_OUTPUT_PORT"){return f(o,q,p)}else{return n(o,q,p)}}}};var k=function(o,q,p){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(p.id),dataType:"json"}).done(function(s){var t=s.component;var u=d('<div class="label"></div>').text(t.name).addClass("ellipsis").attr("title",t.name);var v=d("<div></div>").text(b.substringAfterLast(t.type,".")).addClass("ellipsis").attr("title",b.substringAfterLast(t.type,"."));d("#read-only-connection-source-label").text("From processor");d("#read-only-connection-source").append(u).append(v);d("#read-only-connection-source-group-name").text(q);r.resolve()}).fail(function(w,s,t){if(w.status===403){var u=d('<div class="label"></div>').text(p.name).addClass("ellipsis").attr("title",p.name);var v=d("<div></div>").text("Processor").addClass("ellipsis").attr("title","Processor");d("#read-only-connection-source-label").text("From processor");d("#read-only-connection-source").append(u).append(v);d("#read-only-connection-source-group-name").text(q);r.resolve()}else{r.reject(w,s,t)}})}).promise()};var l=function(o,q,p){return d.Deferred(function(r){d("#read-only-connection-source-label").text("From funnel");d("#read-only-connection-source").text("funnel").attr("title","funnel");d("#read-only-connection-source-group-name").text(q);r.resolve()}).promise()};var f=function(o,q,p){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/remote-process-groups/"+encodeURIComponent(p.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(t.name);d("#read-only-connection-source-group div.setting-name").text("Within Remote Group");d("#read-only-connection-remote-source-url").text(t.targetUri).show();r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(p.groupId);d("#read-only-connection-source-group div.setting-name").text("Within Remote Group");r.resolve()}else{r.reject(u,s,t)}})}).promise()};var n=function(o,q,p){return d.Deferred(function(r){if(o===p.groupId){d("#read-only-connection-source-label").text("From input");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(q);r.resolve()}else{d.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(p.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(p.groupId);r.resolve()}else{r.reject(u,s,t)}})}}).promise()};var e=function(p,q,o){if(o.type==="PROCESSOR"){return a(p,q,o)}else{if(o.type==="FUNNEL"){return m(p,q,o)}else{if(o.type==="REMOTE_INPUT_PORT"){return i(p,q,o)}else{return c(p,q,o)}}}};var a=function(p,q,o){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(o.id),dataType:"json"}).done(function(s){var t=s.component;var u=d('<div class="label"></div>').text(t.name).addClass("ellipsis").attr("title",t.name);var v=d("<div></div>").text(b.substringAfterLast(t.type,".")).addClass("ellipsis").attr("title",b.substringAfterLast(t.type,"."));d("#read-only-connection-target-label").text("To processor");d("#read-only-connection-target").append(u).append(v);d("#read-only-connection-target-group-name").text(q);r.resolve()}).fail(function(w,s,t){if(w.status===403){var u=d('<div class="label"></div>').text(o.name).addClass("ellipsis").attr("title",o.name);var v=d("<div></div>").text("Processor").addClass("ellipsis").attr("title","Processor");d("#read-only-connection-target-label").text("To processor");d("#read-only-connection-target").append(u).append(v);d("#read-only-connection-target-group-name").text(q);r.resolve()}else{r.reject(w,s,t)}})}).promise()};var m=function(p,q,o){return d.Deferred(function(r){d("#read-only-connection-target-label").text("To funnel");d("#read-only-connection-target").text("funnel").attr("title","funnel");d("#read-only-connection-target-group-name").text(q);r.resolve()}).promise()};var i=function(p,q,o){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/remote-process-groups/"+encodeURIComponent(o.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(t.name);d("#read-only-connection-target-group div.setting-name").text("Within Remote Group");d("#read-only-connection-remote-target-url").text(t.targetUri).show();r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(o.groupId);d("#read-only-connection-target-group div.setting-name").text("Within Remote Group");r.resolve()}else{r.reject(u,s,t)}})}).promise()};var c=function(p,q,o){return d.Deferred(function(r){if(p===o.groupId){d("#read-only-connection-target-label").text("To output");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(q);r.resolve()}else{d.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(o.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(o.groupId);r.resolve()}else{r.reject(u,s,t)}})}}).promise()};var h=function(o){d('<div class="available-relationship-container"></div>').append(d('<div class="relationship-name"></div>').text(o)).appendTo("#read-only-relationship-names")};return{init:function(){d("#connection-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Details",tabContentId:"read-only-connection-details-tab-content"},{name:"Settings",tabContentId:"read-only-connection-settings-tab-content"}]});d("#connection-details").modal({headerText:"Connection Details",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){d("#connection-details").modal("hide")}}}],handler:{close:function(){d("#read-only-relationship-names").empty();b.clearField("read-only-connection-name");b.clearField("read-only-connection-id");d("#read-only-connection-source-label").text("");d("#read-only-connection-source").empty();d("#read-only-connection-source-group div.setting-name").text("Within Group");d("#read-only-connection-source-group-name").text("");d("#read-only-connection-remote-source-url").text("").hide();d("#read-only-connection-target-label").text("");d("#read-only-connection-target").empty();d("#read-only-connection-target-group div.setting-name").text("Within Group");d("#read-only-connection-target-group-name").text("");d("#read-only-connection-remote-target-url").text("").hide();d("#read-only-relationship-names").css("border-width","0").empty();b.clearField("read-only-flow-file-expiration");b.clearField("read-only-back-pressure-object-threshold");b.clearField("read-only-back-pressure-data-size-threshold");b.clearField("read-only-load-balance-strategy");b.clearField("read-only-load-balance-partition-attribute");b.clearField("read-only-load-balance-compression");d("#read-only-prioritizers").empty()},open:function(){b.toggleScrollable(d("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}})},showDetails:function(p,r){var q=d.ajax({type:"GET",url:"../nifi-api/flow/process-groups/"+encodeURIComponent(p),dataType:"json"});var o=d.ajax({type:"GET",url:"../nifi-api/connections/"+encodeURIComponent(r),dataType:"json"});d.when(q,o).done(function(w,u){var v=w[0];var x=u[0];if(x.permissions.canRead){var t=x.component;var z=v.permissions.canRead?v.processGroupFlow.breadcrumb.breadcrumb.name:v.processGroupFlow.id;var y=j(v.id,z,t.source);var s=e(v.id,z,t.destination);d.when(y,s).done(function(){var B=t.availableRelationships;var A=t.selectedRelationships;if(b.isDefinedAndNotNull(B)||b.isDefinedAndNotNull(A)){d.each(B,function(G,F){h(F)});d.each(A,function(H,F){if(d.inArray(F,B)===-1){var I=h(F);d(I).children("div.relationship-name").addClass("undefined")}var G=d("#read-only-relationship-names").children("div");d.each(G.children("div.relationship-name"),function(K,J){var L=d(J);if(L.text()===F){L.css("font-weight","bold")}})});d("#selected-relationship-text").show();d("#read-only-relationship-names-container").show()}else{d("#selected-relationship-text").hide();d("#read-only-relationship-names-container").hide()}b.populateField("read-only-connection-name",t.name);b.populateField("read-only-connection-id",t.id);b.populateField("read-only-flow-file-expiration",t.flowFileExpiration);b.populateField("read-only-back-pressure-object-threshold",t.backPressureObjectThreshold);b.populateField("read-only-back-pressure-data-size-threshold",t.backPressureDataSizeThreshold);b.populateField("read-only-load-balance-strategy",b.getComboOptionText(b.loadBalanceStrategyOptions,t.loadBalanceStrategy));b.populateField("read-only-load-balance-partition-attribute",t.loadBalancePartitionAttribute);b.populateField("read-only-load-balance-compression",b.getComboOptionText(b.loadBalanceCompressionOptions,t.loadBalanceCompression));if(t.loadBalanceStrategy==="PARTITION_BY_ATTRIBUTE"){d("#read-only-load-balance-partition-attribute-setting").show()}else{d("#read-only-load-balance-partition-attribute-setting").hide()}if(t.loadBalanceStrategy==="DO_NOT_LOAD_BALANCE"){d("#read-only-load-balance-compression-setting").hide()}else{d("#read-only-load-balance-compression-setting").show()}if(b.isDefinedAndNotNull(t.prioritizers)&&t.prioritizers.length>0){var E=d("<ol></ol>").css("list-style","decimal inside none");d.each(t.prioritizers,function(F,G){E.append(d("<li></li>").text(b.substringAfterLast(G,".")))});d("#read-only-prioritizers").append(E)}else{var C=d('<span class="unset">No value set</span>');d("#read-only-prioritizers").append(C)}d("#connection-details-tabs").find("li:first").click();d("#connection-details").modal("show");var D=d("#read-only-relationship-names");if(D.is(":visible")&&D.get(0).scrollHeight>Math.round(D.innerHeight())){D.css("border-width","1px")}}).fail(g.handleAjaxError)}}).fail(g.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Dialog","nf.ErrorHandler"],function(e,c,f,d,g){return(nf.StatusHistory=b(e,c,f,d,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.StatusHistory=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Dialog"),require("nf.ErrorHandler")))}else{nf.StatusHistory=b(a.$,a.d3,a.nf.Common,a.nf.Dialog,a.nf.ErrorHandler)}}}(this,function(e,y,i,t,g){var x={nifiInstanceId:"nifi-instance-id",nifiInstanceLabel:"NiFi",type:{processor:"Processor",inputPort:"Input Port",outputPort:"Output Port",processGroup:"Process Group",remoteProcessGroup:"Remote Process Group",connection:"Connection",funnel:"Funnel",template:"Template",label:"Label",node:"Node"},urls:{api:"../nifi-api"}};var w={DURATION:function(A){return i.formatDuration(A)},COUNT:function(A){if(A%1===0){return i.formatInteger(A)}else{return i.formatFloat(A)}},DATA_SIZE:function(A){return i.formatDataSize(A)},FRACTION:function(A){return i.formatFloat(A/1000000)}};var o=null;var c=null;var r=null;var d=null;var l=function(C,G,E,B,F){e("#status-history-last-refreshed").text(E.generated);var A={groupId:C,id:G,type:B,instances:[]};var D=E.fieldDescriptors;A.details=E.componentDetails;A.selectedDescriptor=i.isUndefined(F)?D[0]:F;if(i.isDefinedAndNotNull(E.aggregateSnapshots)&&E.aggregateSnapshots.length>1){A.instances.push({id:x.nifiInstanceId,label:x.nifiInstanceLabel,snapshots:E.aggregateSnapshots})}else{k();return}e.each(E.nodeSnapshots,function(I,H){if(i.isDefinedAndNotNull(H.statusSnapshots)&&H.statusSnapshots.length>1){A.instances.push({id:H.nodeId,label:H.address+":"+H.apiPort,snapshots:H.statusSnapshots})}});if(A.instances.length>0){e("#status-history-dialog").data("status-history",A);s(A,D)}else{k()}};var h=function(C){e("#status-history-last-refreshed").text(C.generated);var A={type:"Node",instances:[]};var B=C.fieldDescriptors;A.details=C.componentDetails;A.selectedDescriptor=B[0];if(i.isDefinedAndNotNull(C.aggregateSnapshots)&&C.aggregateSnapshots.length>1){A.instances.push({id:x.nifiInstanceId,label:x.nifiInstanceLabel,snapshots:C.aggregateSnapshots})}else{k();return}e.each(C.nodeSnapshots,function(E,D){if(i.isDefinedAndNotNull(D.statusSnapshots)&&D.statusSnapshots.length>1){A.instances.push({id:D.nodeId,label:D.address+":"+D.apiPort,snapshots:D.statusSnapshots})}});if(A.instances.length>0){e("#status-history-dialog").data("status-history",A);s(A,B)}else{k()}};var k=function(){t.showOkDialog({headerText:"Status History",dialogContent:"Insufficient history, please try again later."})};var s=function(A,B){if(d===null){d={}}e.each(A.instances,function(D,C){C.snapshots.forEach(function(G){var F=new Date();var E=F.getTimezoneOffset()*60*1000;G.timestamp=new Date(G.timestamp+E+o)})});n(B,A.selectedDescriptor)};var n=function(C,B){var A=[];e.each(C,function(D,E){A.push({text:E.label,value:E.field,description:i.escapeHtml(E.description)})});e("#status-history-metric-combo").combo({selectedOption:{value:B.field},options:A,select:function(E){var F=null;e.each(C,function(G,H){if(E.value===H.field){F=H;return false}});if(F!==null){if(r===null||r.field!==F.field){c=null}r=F;var D=e("#status-history-dialog").data("status-history");D.selectedDescriptor=F;e("#status-history-dialog").data("status-history",D);m()}}});e("#status-history-dialog").modal("show")};var a=function(){return e("#status-history-chart-container").parent().outerHeight()-e("#status-history-chart-control-container").outerHeight()-parseInt(e("#status-history-chart-control-container").css("margin-top"),10)};var z=function(){return e("body").height()-e("#status-history-chart-control-container").outerHeight()-e("#status-history-refresh-container").outerHeight()-parseInt(e("#status-history-chart-control-container").css("margin-top"),10)-parseInt(e(".dialog-content").css("top"))-parseInt(e(".dialog-content").css("bottom"))};var v=function(){return e("body").width()-e("#status-history-details").innerWidth()-parseInt(e("#status-history-dialog").css("left"),10)-parseInt(e(".dialog-content").css("left"))-parseInt(e(".dialog-content").css("right"))};var m=function(){var ai=e("#status-history-dialog");if(ai.is(":visible")){var ab=ai.data("status-history");var ah=ab.selectedDescriptor;e("#status-history-details").empty();var D=p("Status History");y.map(ab.details).each(function(ax,aw){j(D,aw,ax)});var F={top:15,right:20,bottom:25,left:75};var Y=y.scaleOrdinal(y.schemeCategory10);var C=[];e.each(ab.instances,function(ax,aw){C.push(aw.label)});Y.domain(C);var at=[];e.each(ab.instances,function(ax,aw){if(i.isUndefinedOrNull(d[aw.id])){d[aw.id]=true}at.push({id:aw.id,label:aw.label,values:e.map(aw.snapshots,function(ay){return{timestamp:ay.timestamp,value:ay.statusMetrics[ah.field]}}),visible:d[aw.id]===true})});var P=function(aw){if(aw.getMilliseconds()){return y.timeFormat(":%S.%L")(aw)}else{if(aw.getSeconds()){return y.timeFormat(":%S")(aw)}else{if(aw.getMinutes()||aw.getHours()){return y.timeFormat("%H:%M")(aw)}else{if(aw.getDay()&&aw.getDate()!==1){return y.timeFormat("%a %d")(aw)}else{if(aw.getDate()!==1){return y.timeFormat("%b %d")(aw)}else{if(aw.getMonth()){return y.timeFormat("%B")(aw)}else{return y.timeFormat("%Y")(aw)}}}}}}};var O=e("#status-history-chart-container").empty();if(O.hasClass("ui-resizable")){O.resizable("destroy");O.removeAttr("style")}O.height(a());var A=O.outerWidth()-F.left-F.right;var B=O.outerHeight()-F.top-F.bottom;W=e("#status-history-container").width();if(A>W){A=W}an=z();if(B>an){B=an}var af=y.scaleTime().range([0,A]);var V=y.axisBottom(af).ticks(5).tickFormat(P);var ae=y.scaleLinear().range([B,0]);var G=y.axisLeft(ae).tickFormat(w[ah.formatter]);var H=y.line().curve(y.curveMonotoneX).x(function(aw){return af(aw.timestamp)}).y(function(aw){return ae(aw.value)});var N=y.select("#status-history-chart-container").append("svg").attr("style","pointer-events: none;").attr("width",O.parent().width()).attr("height",O.innerHeight());var I=N.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",A).attr("height",B);var av=N.append("g").attr("transform","translate("+F.left+", "+F.top+")");var E=y.min(at,function(aw){return y.min(aw.values,function(ax){return ax.timestamp})});var L=y.max(at,function(aw){return y.max(aw.values,function(ax){return ax.timestamp})});j(D,"Start",i.formatDateTime(E));j(D,"End",i.formatDateTime(L));af.domain([E,L]);ae.domain([q(at),u(at)]);av.append("g").attr("class","x axis").attr("transform","translate(0, "+B+")").call(V);av.append("g").attr("class","y axis").call(G).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").attr("text-anchor","end").text(ah.label);var ac=av.selectAll(".status").data(at).enter().append("g").attr("clip-path","url(#clip)").attr("class","status");ac.append("path").attr("class",function(aw){return"chart-line chart-line-"+aw.id}).attr("d",function(aw){return H(aw.values)}).attr("stroke",function(aw){return Y(aw.label)}).classed("hidden",function(aw){return aw.visible===false}).append("title").text(function(aw){return aw.label});ac.each(function(aw){var ax=y.select(this).append("g").attr("class",function(){return"mark-group mark-group-"+aw.id}).classed("hidden",function(ay){return ay.visible===false});ax.selectAll("circle.mark").data(aw.values).enter().append("circle").attr("style","pointer-events: all;").attr("class","mark").attr("cx",function(ay){return af(ay.timestamp)}).attr("cy",function(ay){return ae(ay.value)}).attr("fill",function(){return Y(aw.label)}).attr("r",1.5).append("title").text(function(ay){return aw.label+" -- "+w[ah.formatter](ay.value)})});N.attr("width",O.parent().width()).attr("height",O.innerHeight());I.attr("width",A).attr("height",B);av.select(".x.axis").attr("transform","translate(0, "+B+")");var U=e("#status-history-chart-control-container").empty();var S=U.innerHeight()-F.top-F.bottom;var al=y.scaleTime().range([0,A]);var K=y.axisBottom(al).ticks(5).tickFormat(P);var ap=y.scaleLinear().range([S,0]);var aj=y.axisLeft(ap).tickValues(ae.domain()).tickFormat(w[ah.formatter]);var R=y.line().curve(y.curveMonotoneX).x(function(aw){return al(aw.timestamp)}).y(function(aw){return ap(aw.value)});var ag=y.select("#status-history-chart-control-container").append("svg").attr("width",O.parent().width()).attr("height",S+F.top+F.bottom);var X=ag.append("g").attr("transform","translate("+F.left+", "+F.top+")");al.domain(af.domain());ap.domain(ae.domain());X.append("g").attr("class","x axis").attr("transform","translate(0, "+S+")").call(K);X.append("g").attr("class","y axis").call(aj);var au=X.selectAll(".status").data(at).enter().append("g").attr("class","status");au.append("path").attr("class",function(aw){return"chart-line chart-line-"+aw.id}).attr("d",function(aw){return R(aw.values)}).attr("stroke",function(aw){return Y(aw.label)}).classed("hidden",function(aw){return d[aw.id]===false}).append("title").text(function(aw){return aw.label});var M=function(){var aB=e.map(at,function(aH){var aF=af.domain();var aG=ae.domain();var aI=e.extend({},aH);return e.extend(aI,{values:e.grep(aH.values,function(aJ){return aJ.timestamp.getTime()>=aF[0].getTime()&&aJ.timestamp.getTime()<=aF[1].getTime()&&aJ.value>=aG[0]&&aJ.value<=aG[1]})})});var aw=e.grep(aB,function(aF){return aF.id!==x.nifiInstanceId&&aF.visible&&aF.values.length>0});var aA=aw.length===0?"NA":w[ah.formatter](q(aw));var az=aw.length===0?"NA":w[ah.formatter](f(aw));var ax=aw.length===0?"NA":w[ah.formatter](u(aw));e("#node-aggregate-statistics").text(aA+" / "+ax+" / "+az);var aD=e.grep(aB,function(aF){return aF.id===x.nifiInstanceId&&aF.visible&&aF.values.length>0});var aE=aD.length===0?"NA":w[ah.formatter](q(aD));var aC=aD.length===0?"NA":w[ah.formatter](f(aD));var ay=aD.length===0?"NA":w[ah.formatter](u(aD));e("#cluster-aggregate-statistics").text(aE+" / "+ay+" / "+aC)};var ar=function(aw,ax){af.domain(aw);ae.domain(ax);ac.selectAll(".chart-line").attr("d",function(ay){return H(ay.values)});ac.selectAll("circle.mark").attr("cx",function(ay){return af(ay.timestamp)}).attr("cy",function(ay){return ae(ay.value)}).attr("r",function(){return y.brushSelection(Q.node())===null?1.5:4});av.select(".x.axis").call(V);av.select(".y.axis").call(G)};var J=function(){c=y.brushSelection(Q.node());var ax,aw;if(c===null){var ay=e.grep(at,function(az){return az.visible});if(ay.length===0){aw=ap.domain()}else{aw=[y.min(ay,function(az){return y.min(az.values,function(aA){return aA.value})}),y.max(ay,function(az){return y.max(az.values,function(aA){return aA.value})})]}ax=al.domain()}else{ax=[c[0][0],c[1][0]].map(al.invert,al);aw=[c[1][1],c[0][1]].map(ap.invert,ap)}ar(ax,aw);M()};var am=y.brush().extent([[al.range()[0],ap.range()[1]],[al.range()[1],ap.range()[0]]]).on("brush",J);var Q=X.append("g").attr("class","brush").on("click",J).call(am);if(i.isDefinedAndNotNull(c)){am=am.move(Q,c)}X.select("rect.selection").attr("style","pointer-events: all;").on("dblclick",function(){if(c!==null){var aw=ap.range();am.move(Q,[[c[0][0],aw[1]],[c[1][0],aw[0]]])}});var ad=e.grep(at,function(aw){return aw.id!==x.nifiInstanceId}).sort(function(ax,aw){return ax.label<aw.label?-1:ax.label>aw.label?1:0});var aq=function(ax,aw){var az=e("<div></div>").addClass("legend-label nf-checkbox-label").css("color",Y(aw.label)).text(aw.label).ellipsis();var ay=e('<div class="nf-checkbox"></div>').on("click",function(){var aA=y.selectAll("path.chart-line-"+aw.id);var aC=y.select("g.mark-group-"+aw.id);var aB=aC.classed("hidden");aA.classed("hidden",function(){return !aB});aC.classed("hidden",function(){return !aB});aw.visible=aB;d[aw.id]=aw.visible;J()}).addClass(aw.visible?"checkbox-checked":"checkbox-unchecked");e('<div class="legend-entry"></div>').append(ay).append(az).on("mouseenter",function(){y.selectAll("path.chart-line-"+aw.id).classed("over",true)}).on("mouseleave",function(){y.selectAll("path.chart-line-"+aw.id).classed("over",false)}).appendTo(ax)};var aa=e.grep(at,function(aw){return aw.id===x.nifiInstanceId});var ak=p("NiFi");j(ak,"Min / Max / Mean","","cluster-aggregate-statistics");aq(ak,aa[0]);if(ad.length>0){var Z=p("Nodes");j(Z,"Min / Max / Mean","","node-aggregate-statistics");e.each(ad,function(ax,aw){aq(Z,aw)})}J();var W,an,T,ao;O.append('<div class="ui-resizable-handle ui-resizable-se"></div>').resizable({minWidth:425,minHeight:150,handles:{se:".ui-resizable-se"},resize:function(ay,ax){ao=e("#status-history-dialog");var aw={};if(i.isDefinedAndNotNull(ao.data("nf-dialog"))){aw=ao.data("nf-dialog")}aw["min-width"]=(ao.width()/e(window).width())*100+"%";aw["min-height"]=(ao.height()/e(window).height())*100+"%";aw.responsive["fullscreen-width"]=ao.outerWidth()+"px";aw.responsive["fullscreen-height"]=ao.outerHeight()+"px";W=v();if(ax.helper.width()>W){ax.helper.width(W);aw.responsive["fullscreen-width"]=e(window).width()+"px";aw["min-width"]="100%"}an=z();if(ax.helper.height()>an){ax.helper.height(an);aw.responsive["fullscreen-height"]=e(window).height()+"px";aw["min-height"]="100%"}T=a();if(ax.helper.height()<T){ax.helper.height(T)}aw["min-width"]=(parseInt(aw["min-width"],10)>=100)?"100%":aw["min-width"];aw["min-height"]=(parseInt(aw["min-height"],10)>=100)?"100%":aw["min-height"];ao.data("nfDialog",aw);ao.css("min-width",(O.outerWidth()+e("#status-history-details").outerWidth()+40));ao.css("min-height",(O.outerHeight()+e("#status-history-refresh-container").outerHeight()+e("#status-history-chart-control-container").outerHeight()+e(".dialog-buttons").outerHeight()+e(".dialog-header").outerHeight()+40+5));ao.center()},stop:m})}};var q=function(A){return y.min(A,function(B){return y.min(B.values,function(C){return C.value})})};var u=function(A){return y.max(A,function(B){return y.max(B.values,function(C){return C.value})})};var f=function(B){var C=0;var A=y.sum(B,function(D){C+=D.values.length;return y.sum(D.values,function(E){return E.value})});return A/C};var p=function(B){var A=e('<div class="status-history-detail"></div>').appendTo("#status-history-details");e('<div class="detail-container-label"></div>').text(B).appendTo(A);return e("<div></div>").appendTo(A)};var j=function(B,D,E,F){var C=e('<div class="detail-item"></div>').appendTo(B);e('<div class="setting-name"></div>').text(D).appendTo(C);var A=e('<div class="setting-field"></div>').text(E).appendTo(C);if(i.isDefinedAndNotNull(F)){A.attr("id",F)}};var b={init:function(A){o=A;e("#status-history-refresh-button").click(function(){var B=e("#status-history-dialog").data("status-history");if(B!==null){if(B.type===x.type.processor){b.showProcessorChart(B.groupId,B.id,B.selectedDescriptor)}else{if(B.type===x.type.processGroup){b.showProcessGroupChart(B.groupId,B.id,B.selectedDescriptor)}else{if(B.type===x.type.remoteProcessGroup){b.showRemoteProcessGroupChart(B.groupId,B.id,B.selectedDescriptor)}else{if(B.type===x.type.node){b.showNodeChart()}else{b.showConnectionChart(B.groupId,B.id,B.selectedDescriptor)}}}}}});e("#status-history-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Status History",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){e("#status-history-dialog").removeData("status-history");e("#status-history-chart-container").empty();e("#status-history-chart-control-container").empty();e("#status-history-details").empty();c=null;r=null;d=null},open:m}});e(window).on("resize",function(B){if(B.target===window){m()}i.toggleScrollable(e("#status-history-details").get(0))})},showConnectionChart:function(A,B,C){e.ajax({type:"GET",url:x.urls.api+"/flow/connections/"+encodeURIComponent(B)+"/status/history",dataType:"json"}).done(function(D){l(A,B,D.statusHistory,x.type.connection,C)}).fail(g.handleAjaxError)},showProcessorChart:function(A,C,B){e.ajax({type:"GET",url:x.urls.api+"/flow/processors/"+encodeURIComponent(C)+"/status/history",dataType:"json"}).done(function(D){l(A,C,D.statusHistory,x.type.processor,B)}).fail(g.handleAjaxError)},showNodeChart:function(){e.ajax({type:"GET",url:x.urls.api+"/controller/status/history",dataType:"json"}).done(function(A){h(A.statusHistory)}).fail(g.handleAjaxError)},showProcessGroupChart:function(B,A,C){e.ajax({type:"GET",url:x.urls.api+"/flow/process-groups/"+encodeURIComponent(A)+"/status/history",dataType:"json"}).done(function(D){l(B,A,D.statusHistory,x.type.processGroup,C)}).fail(g.handleAjaxError)},showRemoteProcessGroupChart:function(B,A,C){e.ajax({type:"GET",url:x.urls.api+"/flow/remote-process-groups/"+encodeURIComponent(A)+"/status/history",dataType:"json"}).done(function(D){l(B,A,D.statusHistory,x.type.remoteProcessGroup,C)}).fail(g.handleAjaxError)}};return b}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["angular"],function(c){return(nf.ng.Bridge=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Bridge=b(require("angular")))}else{nf.ng.Bridge=b(a.angular)}}}(this,function(a){function b(){this.rootScope;this.injector}b.prototype={constructor:b,call:function(e,d){var h=e.split(".");var i=this.rootScope;a.forEach(h,function(j){i=i[j]});var f=d.split(".");d=this.rootScope;a.forEach(f,function(j){d=d[j]});var g=Array.prototype.slice.call(arguments,2);var c=d.apply(i,g);if(c){return c}},get:function(c){var d=c.split(".");var e=this.rootScope;a.forEach(d,function(f){e=e[f]});return e},digest:function(){this.rootScope.$digest()}};return new b()}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Common","nf.ErrorHandler","nf.StatusHistory","nf.ProcessorDetails","nf.ConnectionDetails","nf.ng.Bridge","lodash"],function(e,c,d,h,i,g,k,f,j){return(nf.SummaryTable=b(e,c,d,h,i,g,k,f,j))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.SummaryTable=b(require("jquery"),require("Slick"),require("nf.Common"),require("nf.ErrorHandler"),require("nf.StatusHistory"),require("nf.ProcessorDetails"),require("nf.ConnectionDetails"),require("nf.ng.Bridge"),require("lodash")))}else{nf.SummaryTable=b(a.$,a.Slick,a.nf.Common,a.nf.ErrorHandler,a.nf.StatusHistory,a.nf.ProcessorDetails,a.nf.ConnectionDetails,a.nf.ng.Bridge,a._)}}}(this,function(f,z,j,i,c,s,r,I,G){var E={urls:{api:"../nifi-api",status:"../nifi-api/flow/process-groups/root/status",systemDiagnostics:"../nifi-api/system-diagnostics",flowConfig:"../nifi-api/flow/config"}};var d=false;var A="&nbsp;&nbsp;|&nbsp;&nbsp;";var H=function(K,J){if(top!==window){if(j.isDefinedAndNotNull(parent.nf)&&j.isDefinedAndNotNull(parent.nf.CanvasUtils)&&j.isDefinedAndNotNull(parent.nf.Shell)){parent.nf.CanvasUtils.showComponent(K,J);parent.$("#shell-close-button").click()}}};var p=function(X,U,R,O,K){var T=G.get(K,"predictions.predictedMillisUntilBytesBackpressure",-1);var Q=G.get(K,"predictions.predictedMillisUntilCountBackpressure",-1);var L=G.get(K,"percentUseCount",0);var P=G.get(K,"percentUseBytes",0);var W=[{label:"object",timeToBackPressure:Q},{label:"size",timeToBackPressure:T},];var V=[{label:"object",percent:L},{label:"size",percent:P}];var S=G.maxBy(V,"percent");if(S.percent>=100){return"now ("+S.label+")"}var J=W.filter(function(Y){return Y.timeToBackPressure>=0});if(G.isEmpty(J)){return"NA"}var M=G.minBy(J,"timeToBackPressure");var N=j.formatPredictedDuration(M.timeToBackPressure);return j.escapeHtml(N)+" ("+M.label+")"};var t={id:"backpressurePrediction",field:"backpressurePrediction",name:"Estimated Time to Back Pressure",sortable:true,defaultSortAsc:false,formatter:p,resize:true,toolTip:"Estimated Time to Back Pressure"};var w=function(ax){f("#summary-filter").keyup(function(){F()});f("#summary-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Processors",tabContentId:"processor-summary-tab-content"},{name:"Input Ports",tabContentId:"input-port-summary-tab-content"},{name:"Output Ports",tabContentId:"output-port-summary-tab-content"},{name:"Remote Process Groups",tabContentId:"remote-process-group-summary-tab-content"},{name:"Connections",tabContentId:"connection-summary-tab-content"},{name:"Process Groups",tabContentId:"process-group-summary-tab-content"}],select:function(){var bg=f(this).text();if(bg==="Processors"){f("#summary-filter-status-dropdown").show();f("#summary-filter-primary-node-container").show();var bf=f("#processor-summary-table").data("gridInstance");if(j.isDefinedAndNotNull(bf)){bf.resizeCanvas();f("#displayed-items").text(j.formatInteger(bf.getData().getLength()));f("#total-items").text(j.formatInteger(bf.getData().getLength()))}f("#summary-filter-type").combo({options:[{text:"by name",value:"name"},{text:"by type",value:"type"}],select:function(bl){F()}});f("#summary-filter-status-dropdown").combo({options:[{text:"All Statuses",value:"all-statuses"},{text:"Running",value:"Running"},{text:"Stopped",value:"Stopped"},{text:"Validating",value:"Validating"},{text:"Disabled",value:"Disabled"},{text:"Invalid",value:"Invalid"}],select:function(bl){F()}});f("#summary-filter-primary-node").on("change",function(bm,bl){d=bl.isChecked;F()})}else{if(bg==="Connections"){f("#summary-filter-status-dropdown").hide();f("#summary-filter-primary-node-container").hide();o();var be=f("#connection-summary-table").data("gridInstance");if(j.isDefinedAndNotNull(be)){be.resizeCanvas();f("#displayed-items").text(j.formatInteger(be.getData().getLength()));f("#total-items").text(j.formatInteger(be.getData().getLength()))}f("#summary-filter-type").combo({options:[{text:"by source",value:"sourceName"},{text:"by name",value:"name"},{text:"by destination",value:"destinationName"}],select:function(bl){F()}})}else{if(bg==="Input Ports"){f("#summary-filter-status-dropdown").show();f("#summary-filter-primary-node-container").hide();o();var bk=f("#input-port-summary-table").data("gridInstance");if(j.isDefinedAndNotNull(bk)){bk.resizeCanvas();f("#displayed-items").text(j.formatInteger(bk.getData().getLength()));f("#total-items").text(j.formatInteger(bk.getData().getLength()))}f("#summary-filter-type").combo({options:[{text:"by name",value:"name"}],select:function(bl){F()}})}else{if(bg==="Output Ports"){f("#summary-filter-status-dropdown").show();f("#summary-filter-primary-node-container").hide();o();var bj=f("#output-port-summary-table").data("gridInstance");if(j.isDefinedAndNotNull(bj)){bj.resizeCanvas();f("#displayed-items").text(j.formatInteger(bj.getData().getLength()));f("#total-items").text(j.formatInteger(bj.getData().getLength()))}f("#summary-filter-type").combo({options:[{text:"by name",value:"name"}],select:function(bl){F()}})}else{if(bg==="Remote Process Groups"){f("#summary-filter-status-dropdown").hide();f("#summary-filter-primary-node-container").hide();o();var bi=f("#remote-process-group-summary-table").data("gridInstance");if(j.isDefinedAndNotNull(bi)){bi.resizeCanvas();f("#displayed-items").text(j.formatInteger(bi.getData().getLength()));f("#total-items").text(j.formatInteger(bi.getData().getLength()))}f("#summary-filter-type").combo({options:[{text:"by name",value:"name"},{text:"by uri",value:"targetUri"}],select:function(bl){F()}})}else{f("#summary-filter-status-dropdown").hide();f("#summary-filter-primary-node-container").hide();o();var bh=f("#process-group-summary-table").data("gridInstance");if(j.isDefinedAndNotNull(bh)){bh.resizeCanvas();f("#displayed-items").text(j.formatInteger(bh.getData().getLength()));f("#total-items").text(j.formatInteger(bh.getData().getLength()))}f("#summary-filter-type").combo({options:[{text:"by name",value:"name"}],select:function(bl){F()}})}}}}}f("#summary-filter").val("");F()}});var aK=function(bj,bf,bi,bh,be){var bg='<div title="View Processor Details" class="pointer show-processor-details fa fa-info-circle"></div>';if(!j.isEmpty(be.bulletins)){bg+='<div class="has-bulletins fa fa-sticky-note-o"></div><span class="hidden row-id">'+j.escapeHtml(be.id)+"</span>"}return bg};var aD=function(bj,bf,bi,bh,be){var bg="";if(ax&&be.executionNode==="PRIMARY"){bg+='<div class="is-primary-icon" title="This component is only scheduled to execute on the Primary Node">P</div>'}bg+=j.escapeHtml(bi);return bg};var aI=function(bi,bf,bh,bg,be){return j.escapeHtml(be.read)+A+j.escapeHtml(be.written)};var ag=function(bi,bf,bh,bg,be){return j.formatInteger(be.tasks)+A+j.escapeHtml(be.tasksDuration)};var J=function(bi,bf,bh,bg,be){return j.formatValue(bh)};var bd=function(bm,bk,bj,bg,be){var bh="";var bi="";if(be.terminatedThreadCount>0){bh="("+be.activeThreadCount+A+be.terminatedThreadCount+")";bi="Threads: (Active / Terminated)"}else{if(be.activeThreadCount>0){bh="("+be.activeThreadCount+")";bi="Active Threads"}}var bf;switch(bj.toLowerCase()){case"running":bf="fa fa-play running";break;case"stopped":bf="fa fa-stop stopped";break;case"enabled":bf="fa fa-flash enabled";break;case"disabled":bf="icon icon-enable-false disabled";break;case"validating":bf="fa fa-spin fa-circle-notch validating";break;case"invalid":bf="fa fa-warning invalid";break;default:bf=""}var bl='<div layout="row"><div class="'+bf+'"></div><div class="status-text">'+j.escapeHtml(bj)+'</div><div style="float: left; margin-left: 4px;" title="'+bi+'">'+j.escapeHtml(bh)+"</div></div>";return bl};var a7={id:"name",field:"name",name:"Name",formatter:aD,sortable:true,resizable:true};var aY={id:"runStatus",field:"runStatus",name:"Run Status",formatter:bd,sortable:true};var aA={id:"input",field:"input",name:'<span class="input-title">In</span>&nbsp;(<span class="input-size-title">Size</span>)&nbsp;<span style="font-weight: normal; overflow: hidden;">5 min</span>',toolTip:"Count / data size in the last 5 min",sortable:true,defaultSortAsc:false,resizable:true,formatter:j.genericValueFormatter};var aH={id:"io",field:"io",name:'<span class="read-title">Read</span>'+A+'<span class="written-title">Write</span>&nbsp;<span style="font-weight: normal; overflow: hidden;">5 min</span>',toolTip:"Data size in the last 5 min",formatter:aI,sortable:true,defaultSortAsc:false,resizable:true};var a9={id:"output",field:"output",name:'<span class="output-title">Out</span>&nbsp;(<span class="output-size-title">Size</span>)&nbsp;<span style="font-weight: normal; overflow: hidden;">5 min</span>',toolTip:"Count / data size in the last 5 min",sortable:true,defaultSortAsc:false,resizable:true,formatter:j.genericValueFormatter};var aF={id:"tasks",field:"tasks",name:'<span class="tasks-title">Tasks</span>'+A+'<span class="time-title">Time</span>&nbsp;<span style="font-weight: normal; overflow: hidden;">5 min</span>',toolTip:"Count / duration in the last 5 min",formatter:ag,sortable:true,defaultSortAsc:false,resizable:true};var aJ=[{id:"moreDetails",field:"moreDetails",name:"&nbsp;",resizable:false,formatter:aK,sortable:true,width:50,maxWidth:50,toolTip:"Sorts based on presence of bulletins"},a7,{id:"type",field:"type",name:"Type",sortable:true,resizable:true,formatter:j.genericValueFormatter},{id:"parentGroup",field:"parentProcessGroupName",name:"Process Group",sortable:true,resizable:true,formatter:j.genericValueFormatter,toolTip:"Parent Process Group name"},aY,aA,aH,a9,aF];var a1=(top!==window);if(ax||a1||j.SUPPORTS_SVG){var a5=function(bj,bf,bi,bh,be){var bg="";if(a1){bg+='<div class="pointer go-to fa fa-long-arrow-right" title="Go To Processor in '+j.escapeHtml(be.processGroupNamePath)+'"></div>'}if(j.SUPPORTS_SVG){bg+='<div class="pointer show-processor-status-history fa fa-area-chart" title="View Status History"></div>'}if(ax){bg+='<div class="pointer show-cluster-processor-summary fa fa-cubes" title="View Processor Details"></div>'}return bg};aJ.push({id:"actions",name:"&nbsp;",formatter:a5,resizable:false,sortable:false,width:75,maxWidth:75})}var aB={autosizeColsMode:z.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var aL=new z.Data.DataView({inlineFilters:false});aL.setItems([]);aL.setFilterArgs({searchString:"",property:"name"});aL.setFilter(m);C("processor-summary-table",{columnId:"name",sortAsc:true},aL);var ba=new z.Grid("#processor-summary-table",aL,aJ,aB);ba.setSelectionModel(new z.RowSelectionModel());ba.registerPlugin(new z.AutoTooltips());ba.setSortColumn("name",true);ba.onSort.subscribe(function(bf,be){C("processor-summary-table",{columnId:be.sortCol.field,sortAsc:be.sortAsc},aL)});ba.onClick.subscribe(function(bh,be){var bg=f(bh.target);var bf=aL.getItem(be.row);if(ba.getColumns()[be.cell].id==="actions"){if(bg.hasClass("go-to")){H(bf.groupId,bf.id)}else{if(bg.hasClass("show-processor-status-history")){c.showProcessorChart(bf.groupId,bf.id)}else{if(bg.hasClass("show-cluster-processor-summary")){n(bf.groupId,bf.id);f("#summary-loading-container").hide();f("#cluster-processor-summary-dialog").modal("show");R.resizeCanvas()}}}}else{if(ba.getColumns()[be.cell].id==="moreDetails"){if(bg.hasClass("show-processor-details")){s.showDetails(bf.groupId,bf.id)}}}});aL.onRowCountChanged.subscribe(function(bf,be){ba.updateRowCount();ba.render();if(f("#processor-summary-table").is(":visible")){f("#displayed-items").text(j.formatInteger(be.current))}});aL.onRowsChanged.subscribe(function(bf,be){ba.invalidateRows(be.rows);ba.render()});f("#processor-summary-table").data("gridInstance",ba).on("mouseenter","div.slick-cell",function(bi){var bf=f(this).find("div.has-bulletins");if(bf.length&&!bf.data("qtip")){var bj=f(this).find("span.row-id").text();var be=aL.getItemById(bj);var bh=j.getFormattedBulletins(be.bulletins);var bg=j.formatUnorderedList(bh);if(j.isDefinedAndNotNull(bg)){bf.qtip(f.extend({},j.config.tooltipConfig,{content:bg,position:{container:f("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});f("#cluster-processor-summary-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Cluster Processor Summary",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f("#cluster-processor-id").text("");f("#cluster-processor-name").text("");this.modal("hide")}}}],handler:{close:function(){f("#summary-loading-container").show()}}});f("#cluster-processor-refresh-button").click(function(){n(f("#cluster-processor-group-id").text(),f("#cluster-processor-id").text())});var Q=[{id:"node",field:"node",name:"Node",sortable:true,resizable:true,formatter:j.genericValueFormatter},aY,aA,aH,a9,aF];var a4={autosizeColsMode:z.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var aU=new z.Data.DataView({inlineFilters:false});aU.setItems([]);C("cluster-processor-summary-table",{columnId:"node",sortAsc:true},aU);var R=new z.Grid("#cluster-processor-summary-table",aU,Q,a4);R.setSelectionModel(new z.RowSelectionModel());R.registerPlugin(new z.AutoTooltips());R.setSortColumn("node",true);R.onSort.subscribe(function(bf,be){C("cluster-processor-summary-table",{columnId:be.sortCol.field,sortAsc:be.sortAsc},aU)});aU.onRowCountChanged.subscribe(function(bf,be){R.updateRowCount();R.render()});aU.onRowsChanged.subscribe(function(bf,be){R.invalidateRows(be.rows);R.render()});f("#cluster-processor-summary-table").data("gridInstance",R);var aR=function(bi,bf,bh,bg,be){return'<div class="pointer show-connection-details fa fa-info-circle" title="View Connection Details"></div>'};var a8=function(be){return G.isNumber(be)&&be>=0?G.clamp(be,0,100)+"%":"NA"};var Y=function(bk,bg,bj,bh,bf){var be="NA";if(j.isDefinedAndNotNull(bf.percentUseCount)){be=a8(bf.percentUseCount)}var bi="NA";if(j.isDefinedAndNotNull(bf.percentUseBytes)){bi=a8(bf.percentUseBytes)}return j.escapeHtml(be)+A+j.escapeHtml(bi)};var a0={id:"queued",field:"queued",name:'<span class="queued-title">Queue</span>&nbsp;(<span class="queued-size-title">Size</span>)',sortable:true,defaultSortAsc:false,resize:true,formatter:j.genericValueFormatter};var X={id:"backpressure",field:"backpressure",name:'Threshold %: <span class="backpressure-object-title">Queue</span>&nbsp;&nbsp;|&nbsp;&nbsp;<span class="backpressure-data-size-title">Size</span>',sortable:true,defaultSortAsc:false,formatter:Y,resize:true};var ay=[{id:"moreDetails",name:"&nbsp;",sortable:false,resizable:false,formatter:aR,width:50,maxWidth:50},{id:"name",field:"name",name:"Name",sortable:true,resizable:true,formatter:J},a0,X,t,aA,{id:"sourceName",field:"sourceName",name:"From Source",sortable:true,resizable:true,formatter:j.genericValueFormatter},a9,{id:"destinationName",field:"destinationName",name:"To Destination",sortable:true,resizable:true,formatter:j.genericValueFormatter}];if(ax||a1||j.SUPPORTS_SVG){var M=function(bj,bf,bi,bh,be){var bg="";if(a1){bg+='<div class="pointer go-to fa fa-long-arrow-right" title="Go To Connection"></div>'}if(j.SUPPORTS_SVG){bg+='<div class="pointer show-connection-status-history fa fa-area-chart" title="View Status History"></div>'}if(ax){bg+='<div class="pointer show-cluster-connection-summary fa fa-cubes" title="View Connection Details"></div>'}return bg};ay.push({id:"actions",name:"&nbsp;",formatter:M,resizable:false,sortable:false,width:75,maxWidth:75})}var ae={autosizeColsMode:z.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var ap=new z.Data.DataView({inlineFilters:false});ap.setItems([]);ap.setFilterArgs({searchString:"",property:"sourceName"});ap.setFilter(m);C("connection-summary-table",{columnId:"sourceName",sortAsc:true},ap);var aO=new z.Grid("#connection-summary-table",ap,ay,ae);aO.setSelectionModel(new z.RowSelectionModel());aO.registerPlugin(new z.AutoTooltips());aO.setSortColumn("sourceName",true);aO.onSort.subscribe(function(bf,be){C("connection-summary-table",{columnId:be.sortCol.field,sortAsc:be.sortAsc},ap)});aO.onClick.subscribe(function(bh,be){var bg=f(bh.target);var bf=ap.getItem(be.row);if(aO.getColumns()[be.cell].id==="actions"){if(bg.hasClass("go-to")){H(bf.groupId,bf.id)}else{if(bg.hasClass("show-connection-status-history")){c.showConnectionChart(bf.groupId,bf.id)}else{if(bg.hasClass("show-cluster-connection-summary")){b(bf.groupId,bf.id);f("#summary-loading-container").hide();f("#cluster-connection-summary-dialog").modal("show");al.resizeCanvas()}}}}else{if(aO.getColumns()[be.cell].id==="moreDetails"){if(bg.hasClass("show-connection-details")){r.showDetails(bf.groupId,bf.id)}}}});ap.onRowCountChanged.subscribe(function(bf,be){aO.updateRowCount();aO.render();if(f("#connection-summary-table").is(":visible")){f("#displayed-items").text(j.formatInteger(be.current))}});ap.onRowsChanged.subscribe(function(bf,be){aO.invalidateRows(be.rows);aO.render()});f("#connection-summary-table").data("gridInstance",aO);f("#cluster-connection-summary-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Cluster Connection Summary",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f("#cluster-connection-id").text("");f("#cluster-connection-name").text("");this.modal("hide")}}}],handler:{close:function(){f("#summary-loading-container").show()}}});f("#cluster-connection-refresh-button").click(function(){b(f("#cluster-connection-group-id").text(),f("#cluster-connection-id").text())});var T=[{id:"node",field:"node",name:"Node",sortable:true,resizable:true,formatter:j.genericValueFormatter},a0,X,t,aA,a9];var N={autosizeColsMode:z.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var L=new z.Data.DataView({inlineFilters:false});L.setItems([]);C("cluster-connection-summary-table",{columnId:"node",sortAsc:true},L);var al=new z.Grid("#cluster-connection-summary-table",L,T,N);al.setSelectionModel(new z.RowSelectionModel());al.registerPlugin(new z.AutoTooltips());al.setSortColumn("node",true);al.onSort.subscribe(function(bf,be){C("cluster-connection-summary-table",{columnId:be.sortCol.field,sortAsc:be.sortAsc},L)});L.onRowCountChanged.subscribe(function(bf,be){al.updateRowCount();al.render()});L.onRowsChanged.subscribe(function(bf,be){al.invalidateRows(be.rows);al.render()});f("#cluster-connection-summary-table").data("gridInstance",al);var W=function(bj,bf,bi,bh,be){var bg="";if(!j.isEmpty(be.bulletins)){bg+='<div class="has-bulletins fa fa-sticky-note-o" style="margin-left: 5px; float: left;"></div><span class="hidden row-id">'+j.escapeHtml(be.id)+"</span>"}return bg};var aP={id:"moreDetails",field:"moreDetails",name:"&nbsp;",resizable:false,formatter:W,sortable:true,width:50,maxWidth:50,toolTip:"Sorts based on presence of bulletins"};var ai={id:"transferred",field:"transferred",name:'<span class="transferred-title">Transferred</span>&nbsp;(<span class="transferred-size-title">Size</span>)&nbsp;<span style="font-weight: normal; overflow: hidden;">5 min</span>',toolTip:"Count / data size transferred to and from connections in the last 5 min",resizable:true,defaultSortAsc:false,sortable:true,formatter:j.genericValueFormatter};var af={id:"sent",field:"sent",name:'<span class="sent-title">Sent</span>&nbsp;(<span class="sent-size-title">Size</span>)&nbsp;<span style="font-weight: normal; overflow: hidden;">5 min</span>',toolTip:"Count / data size in the last 5 min",sortable:true,defaultSortAsc:false,resizable:true,formatter:j.genericValueFormatter};var aM={id:"received",field:"received",name:'<span class="received-title">Received</span>&nbsp;(<span class="received-size-title">Size</span>)&nbsp;<span style="font-weight: normal; overflow: hidden;">5 min</span>',toolTip:"Count / data size in the last 5 min",sortable:true,defaultSortAsc:false,resizable:true,formatter:j.genericValueFormatter};var aZ=function(bk,bf,bj,bg,be){var bi,bh;switch(bj){case"UP_TO_DATE":bi="fa fa-check up-to-date";bh="Up to date";break;case"LOCALLY_MODIFIED":bi="fa fa-asterisk locally-modified";bh="Locally modified";break;case"STALE":bi="fa fa-arrow-circle-up stale";bh="Stale";break;case"LOCALLY_MODIFIED_AND_STALE":bi="fa fa-exclamation-circle locally-modified-and-stale";bh="Locally modified and stale";break;case"SYNC_FAILURE":bi="fa fa-question sync-failure";bh="Sync failure";break;default:bi="";bh=""}return'<div layout="row"><div class="'+bi+'"></div><div class="status-text">'+bh+"</div></div>"};var U=[aP,{id:"name",field:"name",name:"Name",sortable:true,resizable:true,formatter:J},{id:"versionedFlowState",field:"versionedFlowState",name:"Version State",sortable:true,resizable:true,formatter:aZ},ai,aA,aH,a9,af,aM];if(ax||a1||j.SUPPORTS_SVG){var a6=function(bj,bf,bi,bh,be){var bg="";if(a1&&be.groupId!==null){bg+='<div class="pointer go-to fa fa-long-arrow-right" title="Go To Process Group"></div>'}if(j.SUPPORTS_SVG){bg+='<div class="pointer show-process-group-status-history fa fa-area-chart" title="View Status History"></div>'}if(ax){bg+='<div class="pointer show-cluster-process-group-summary fa fa-cubes" title="View Process Group Details"></div>'}return bg};U.push({id:"actions",name:"&nbsp;",formatter:a6,resizable:false,sortable:false,width:75,maxWidth:75})}var ak={autosizeColsMode:z.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var az=new z.Data.DataView({inlineFilters:false});az.setItems([]);az.setFilterArgs({searchString:"",property:"name"});az.setFilter(m);C("process-group-summary-table",{columnId:"name",sortAsc:true},az);var aW=new z.Grid("#process-group-summary-table",az,U,ak);aW.setSelectionModel(new z.RowSelectionModel());aW.registerPlugin(new z.AutoTooltips());aW.setSortColumn("name",true);aW.onSort.subscribe(function(bf,be){C("process-group-summary-table",{columnId:be.sortCol.field,sortAsc:be.sortAsc},az)});aW.onClick.subscribe(function(bh,be){var bg=f(bh.target);var bf=az.getItem(be.row);if(aW.getColumns()[be.cell].id==="actions"){if(bg.hasClass("go-to")){if(j.isDefinedAndNotNull(parent.nf)&&j.isDefinedAndNotNull(parent.nf.ProcessGroup)&&j.isDefinedAndNotNull(parent.nf.Shell)){parent.nf.ProcessGroup.enterGroup(bf.id);parent.$("#shell-close-button").click()}}else{if(bg.hasClass("show-process-group-status-history")){c.showProcessGroupChart(bf.groupId,bf.id)}else{if(bg.hasClass("show-cluster-process-group-summary")){q(bf.id);f("#summary-loading-container").hide();f("#cluster-process-group-summary-dialog").modal("show");ac.resizeCanvas()}}}}});az.onRowCountChanged.subscribe(function(bf,be){aW.updateRowCount();aW.render();if(f("#process-group-summary-table").is(":visible")){f("#displayed-items").text(j.formatInteger(be.current))}});az.onRowsChanged.subscribe(function(bf,be){aW.invalidateRows(be.rows);aW.render()});f("#process-group-summary-table").data("gridInstance",aW).on("mouseenter","div.slick-cell",function(bj){var bg=f(this).find("div.has-bulletins");if(bg.length&&!bg.data("qtip")){var be=f(this).find("span.row-id").text();var bf=az.getItemById(be);var bi=j.getFormattedBulletins(bf.bulletins);var bh=j.formatUnorderedList(bi);if(j.isDefinedAndNotNull(bh)){bg.qtip(f.extend({},j.config.tooltipConfig,{content:bh,position:{container:f("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});f("#cluster-process-group-summary-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Cluster Process Group Summary",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f("#cluster-process-group-id").text("");f("#cluster-process-group-name").text("");this.modal("hide")}}}],handler:{close:function(){f("#summary-loading-container").show()}}});f("#cluster-process-group-refresh-button").click(function(){q(f("#cluster-process-group-id").text())});var aq=[{id:"node",field:"node",name:"Node",sortable:true,resizable:true,formatter:j.genericValueFormatter},ai,aA,aH,a9,af,aM];var aG={autosizeColsMode:z.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var a3=new z.Data.DataView({inlineFilters:false});a3.setItems([]);C("cluster-processor-summary-table",{columnId:"node",sortAsc:true},a3);var ac=new z.Grid("#cluster-process-group-summary-table",a3,aq,aG);ac.setSelectionModel(new z.RowSelectionModel());ac.registerPlugin(new z.AutoTooltips());ac.setSortColumn("node",true);ac.onSort.subscribe(function(bf,be){C("cluster-process-group-summary-table",{columnId:be.sortCol.field,sortAsc:be.sortAsc},a3)});a3.onRowCountChanged.subscribe(function(bf,be){ac.updateRowCount();ac.render()});a3.onRowsChanged.subscribe(function(bf,be){ac.invalidateRows(be.rows);ac.render()});f("#cluster-process-group-summary-table").data("gridInstance",ac);var bc=[aP,a7,aY,a9];if(ax||a1){var au=function(bj,bf,bi,bh,be){var bg="";if(a1){bg+='<div class="pointer go-to fa fa-long-arrow-right" title="Go To Input Port"></div>'}if(ax){bg+='<div class="pointer show-cluster-input-port-summary fa fa-cubes" title="View Input Port Details"></div>'}return bg};bc.push({id:"actions",name:"&nbsp;",formatter:au,resizable:false,sortable:false,width:75,maxWidth:75})}var ao={autosizeColsMode:z.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var O=new z.Data.DataView({inlineFilters:false});O.setItems([]);O.setFilterArgs({searchString:"",property:"name"});O.setFilter(m);C("input-port-summary-table",{columnId:"name",sortAsc:true},O);var an=new z.Grid("#input-port-summary-table",O,bc,ao);an.setSelectionModel(new z.RowSelectionModel());an.registerPlugin(new z.AutoTooltips());an.setSortColumn("name",true);an.onSort.subscribe(function(bf,be){C("input-port-summary-table",{columnId:be.sortCol.field,sortAsc:be.sortAsc},O)});an.onClick.subscribe(function(bh,be){var bg=f(bh.target);var bf=O.getItem(be.row);if(an.getColumns()[be.cell].id==="actions"){if(bg.hasClass("go-to")){H(bf.groupId,bf.id)}else{if(bg.hasClass("show-cluster-input-port-summary")){x(bf.groupId,bf.id);f("#summary-loading-container").hide();f("#cluster-input-port-summary-dialog").modal("show");aC.resizeCanvas()}}}});O.onRowCountChanged.subscribe(function(bf,be){an.updateRowCount();an.render();if(f("#input-port-summary-table").is(":visible")){f("#display-items").text(j.formatInteger(be.current))}});O.onRowsChanged.subscribe(function(bf,be){an.invalidateRows(be.rows);an.render()});f("#input-port-summary-table").data("gridInstance",an).on("mouseenter","div.slick-cell",function(bj){var bg=f(this).find("div.has-bulletins");if(bg.length&&!bg.data("qtip")){var be=f(this).find("span.row-id").text();var bf=O.getItemById(be);var bi=j.getFormattedBulletins(bf.bulletins);var bh=j.formatUnorderedList(bi);if(j.isDefinedAndNotNull(bh)){bg.qtip(f.extend({},j.config.tooltipConfig,{content:bh,position:{container:f("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});f("#cluster-input-port-summary-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Cluster Input Port Summary",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f("#cluster-input-port-id").text("");f("#cluster-input-port-name").text("");this.modal("hide")}}}],handler:{close:function(){f("#summary-loading-container").show()}}});f("#cluster-input-port-refresh-button").click(function(){x(f("#cluster-input-port-group-id").text(),f("#cluster-input-port-id").text())});var aj=[{id:"node",field:"node",name:"Node",sortable:true,resizable:true,formatter:j.genericValueFormatter},aY,a9];var aV={autosizeColsMode:z.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var aa=new z.Data.DataView({inlineFilters:false});aa.setItems([]);C("cluster-input-port-summary-table",{columnId:"node",sortAsc:true},aa);var aC=new z.Grid("#cluster-input-port-summary-table",aa,aj,aV);aC.setSelectionModel(new z.RowSelectionModel());aC.registerPlugin(new z.AutoTooltips());aC.setSortColumn("node",true);aC.onSort.subscribe(function(bf,be){C("cluster-input-port-summary-table",{columnId:be.sortCol.field,sortAsc:be.sortAsc},aa)});aa.onRowCountChanged.subscribe(function(bf,be){aC.updateRowCount();aC.render()});aa.onRowsChanged.subscribe(function(bf,be){aC.invalidateRows(be.rows);aC.render()});f("#cluster-input-port-summary-table").data("gridInstance",aC);var aE=[aP,a7,aY,aA];if(ax||a1){var aQ=function(bj,bf,bi,bh,be){var bg="";if(a1){bg+='<div class="pointer go-to fa fa-long-arrow-right" title="Go To Output Port"></div>'}if(ax){bg+='<div class="pointer show-cluster-output-port-summary fa fa-cubes" title="View Output Port Details"></div>'}return bg};aE.push({id:"actions",name:"&nbsp;",formatter:aQ,resizable:false,sortable:false,width:75,maxWidth:75})}var av={autosizeColsMode:z.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var K=new z.Data.DataView({inlineFilters:false});K.setItems([]);K.setFilterArgs({searchString:"",property:"name"});K.setFilter(m);C("output-port-summary-table",{columnId:"name",sortAsc:true},K);var am=new z.Grid("#output-port-summary-table",K,aE,av);am.setSelectionModel(new z.RowSelectionModel());am.registerPlugin(new z.AutoTooltips());am.setSortColumn("name",true);am.onSort.subscribe(function(bf,be){C("output-port-summary-table",{columnId:be.sortCol.field,sortAsc:be.sortAsc},K)});am.onClick.subscribe(function(bh,be){var bg=f(bh.target);var bf=K.getItem(be.row);if(am.getColumns()[be.cell].id==="actions"){if(bg.hasClass("go-to")){H(bf.groupId,bf.id)}else{if(bg.hasClass("show-cluster-output-port-summary")){l(bf.groupId,bf.id);f("#summary-loading-container").hide();f("#cluster-output-port-summary-dialog").modal("show");bb.resizeCanvas()}}}});K.onRowCountChanged.subscribe(function(bf,be){am.updateRowCount();am.render();if(f("#output-port-summary-table").is(":visible")){f("#display-items").text(j.formatInteger(be.current))}});K.onRowsChanged.subscribe(function(bf,be){am.invalidateRows(be.rows);am.render()});f("#output-port-summary-table").data("gridInstance",am).on("mouseenter","div.slick-cell",function(bj){var bg=f(this).find("div.has-bulletins");if(bg.length&&!bg.data("qtip")){var be=f(this).find("span.row-id").text();var bf=K.getItemById(be);var bi=j.getFormattedBulletins(bf.bulletins);var bh=j.formatUnorderedList(bi);if(j.isDefinedAndNotNull(bh)){bg.qtip(f.extend({},j.config.tooltipConfig,{content:bh,position:{container:f("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});f("#cluster-output-port-summary-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Cluster Output Port Summary",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f("#cluster-output-port-id").text("");f("#cluster-output-port-name").text("");this.modal("hide")}}}],handler:{close:function(){f("#summary-loading-container").show()}}});f("#cluster-output-port-refresh-button").click(function(){l(f("#cluster-output-port-group-id").text(),f("#cluster-output-port-id").text())});var Z=[{id:"node",field:"node",name:"Node",sortable:true,resizable:true,formatter:j.genericValueFormatter},aY,aA];var ar={autosizeColsMode:z.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var aN=new z.Data.DataView({inlineFilters:false});aN.setItems([]);C("cluster-output-port-summary-table",{columnId:"node",sortAsc:true},aN);var bb=new z.Grid("#cluster-output-port-summary-table",aN,Z,ar);bb.setSelectionModel(new z.RowSelectionModel());bb.registerPlugin(new z.AutoTooltips());bb.setSortColumn("node",true);bb.onSort.subscribe(function(bf,be){C("cluster-output-port-summary-table",{columnId:be.sortCol.field,sortAsc:be.sortAsc},aN)});aN.onRowCountChanged.subscribe(function(bf,be){bb.updateRowCount();bb.render()});aN.onRowsChanged.subscribe(function(bf,be){bb.invalidateRows(be.rows);bb.render()});f("#cluster-output-port-summary-table").data("gridInstance",bb);var ad=function(bm,bk,bj,bh,be){var bi="";if(j.isDefinedAndNotNull(be.activeThreadCount)&&be.activeThreadCount>0){bi="("+j.escapeHtml(be.activeThreadCount)+")"}var bl="invalid fa fa-warning";var bf="Invalid";if(bj==="Transmitting"){bl="transmitting fa fa-bullseye";bf=bj}else{bl="not-transmitting icon icon-transmit-false";bf="Not Transmitting"}var bg='<div layout="row"><div class="'+bl+'"></div>';return bg+'<div class="status-text">'+bf+'</div><div style="float: left; margin-left: 4px;">'+j.escapeHtml(bi)+"</div></div>"};var ah={id:"transmissionStatus",field:"transmissionStatus",name:"Transmitting",formatter:ad,sortable:true,resizable:true};var aX={id:"targetUri",field:"targetUri",name:"Target URI",sortable:true,resizable:true,formatter:j.genericValueFormatter};var at=[{id:"moreDetails",field:"moreDetails",name:"&nbsp;",resizable:false,formatter:W,sortable:true,width:50,maxWidth:50,toolTip:"Sorts based on presence of bulletins"},a7,aX,ah,af,aM];if(ax||a1||j.SUPPORTS_SVG){var V=function(bj,bf,bi,bh,be){var bg="";if(a1){bg+='<div class="pointer go-to fa fa-long-arrow-right" title="Go To Process Group"></div>'}if(j.SUPPORTS_SVG){bg+='<div class="pointer show-remote-process-group-status-history fa fa-area-chart" title="View Status History"></div>'}if(ax){bg+='<div class="pointer show-cluster-remote-process-group-summary fa fa-cubes" title="View Remote Process Group Details"></div>'}return bg};at.push({id:"actions",name:"&nbsp;",formatter:V,resizable:false,sortable:false,width:75,maxWidth:75})}var aT={autosizeColsMode:z.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var a2=new z.Data.DataView({inlineFilters:false});a2.setItems([]);a2.setFilterArgs({searchString:"",property:"name"});a2.setFilter(m);C("remote-process-group-summary-table",{columnId:"name",sortAsc:true},a2);var ab=new z.Grid("#remote-process-group-summary-table",a2,at,aT);ab.setSelectionModel(new z.RowSelectionModel());ab.registerPlugin(new z.AutoTooltips());ab.setSortColumn("name",true);ab.onSort.subscribe(function(bf,be){C("remote-process-group-summary-table",{columnId:be.sortCol.field,sortAsc:be.sortAsc},a2)});ab.onClick.subscribe(function(bh,be){var bg=f(bh.target);var bf=a2.getItem(be.row);if(ab.getColumns()[be.cell].id==="actions"){if(bg.hasClass("go-to")){H(bf.groupId,bf.id)}else{if(bg.hasClass("show-remote-process-group-status-history")){c.showRemoteProcessGroupChart(bf.groupId,bf.id)}else{if(bg.hasClass("show-cluster-remote-process-group-summary")){g(bf.groupId,bf.id);f("#summary-loading-container").hide();f("#cluster-remote-process-group-summary-dialog").modal("show");aw.resizeCanvas()}}}}});a2.onRowCountChanged.subscribe(function(bf,be){ab.updateRowCount();ab.render();if(f("#remote-process-group-summary-table").is(":visible")){f("#displayed-items").text(j.formatInteger(be.current))}});a2.onRowsChanged.subscribe(function(bf,be){ab.invalidateRows(be.rows);ab.render()});f("#remote-process-group-summary-table").data("gridInstance",ab).on("mouseenter","div.slick-cell",function(bj){var bg=f(this).find("div.has-bulletins");if(bg.length&&!bg.data("qtip")){var be=f(this).find("span.row-id").text();var bf=a2.getItemById(be);var bi=j.getFormattedBulletins(bf.bulletins);var bh=j.formatUnorderedList(bi);if(j.isDefinedAndNotNull(bh)){bg.qtip(f.extend({},j.config.tooltipConfig,{content:bh,position:{container:f("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});f("#cluster-remote-process-group-summary-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Cluster Remote Process Group Summary",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f("#cluster-remote-process-group-id").text("");f("#cluster-remote-process-group-name").text("");this.modal("hide")}}}],handler:{close:function(){f("#summary-loading-container").show()}}});f("#cluster-remote-process-group-refresh-button").click(function(){g(f("#cluster-remote-process-group-group-id").text(),f("#cluster-remote-process-group-id").text())});var aS=[{id:"node",field:"node",name:"Node",sortable:true,resizable:true,formatter:j.genericValueFormatter},aX,ah,af,aM];var P={autosizeColsMode:z.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:false,enableColumnReorder:false,autoEdit:false,rowHeight:24};var S=new z.Data.DataView({inlineFilters:false});S.setItems([]);C("cluster-remote-process-group-summary-table",{columnId:"node",sortAsc:true},S);var aw=new z.Grid("#cluster-remote-process-group-summary-table",S,aS,P);aw.setSelectionModel(new z.RowSelectionModel());aw.registerPlugin(new z.AutoTooltips());aw.setSortColumn("node",true);aw.onSort.subscribe(function(bf,be){C("cluster-remote-process-group-summary-table",{columnId:be.sortCol.field,sortAsc:be.sortAsc},S)});S.onRowCountChanged.subscribe(function(bf,be){aw.updateRowCount();aw.render()});S.onRowsChanged.subscribe(function(bf,be){aw.invalidateRows(be.rows);aw.render()});f("#cluster-remote-process-group-summary-table").data("gridInstance",aw);f("#system-diagnostics-link").click(function(){v().done(function(){f("#summary-loading-container").hide();f("#system-diagnostics-dialog").modal("show")})});f("#system-diagnostics-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"JVM",tabContentId:"jvm-tab-content"},{name:"System",tabContentId:"system-tab-content"},{name:"Version",tabContentId:"version-tab-content"}]});f("#system-diagnostics-dialog").modal({scrollableContentStyle:"scrollable",headerText:"System Diagnostics",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){f("#summary-loading-container").show()},open:function(){j.toggleScrollable(f("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});f("#system-diagnostics-refresh-button").click(function(){v()});f("#total-items").text("0")};var a={};var D=function(K){var J=Math.max(G.get(K,"percentUseBytes",0),G.get(K,"percentUseCount",0));if(J>=100){return 0}var L=G.get(K,"predictions.predictedMillisUntilBytesBackpressure",-1);var M=G.get(K,"predictions.predictedMillisUntilCountBackpressure",-1);if(L<0){return M<0?Number.MAX_VALUE:M}else{if(M<0){return L}}return Math.min(L,M)};var C=function(L,J,M){if(j.isUndefined(a[L])){a[L]={}}var K=function(am,al){if(J.columnId==="moreDetails"){var ah=0;if(!j.isEmpty(am.bulletins)){ah=am.bulletins.length}var Q=0;if(!j.isEmpty(al.bulletins)){Q=al.bulletins.length}return ah-Q}else{if(J.columnId==="runStatus"||J.columnId==="transmissionStatus"){var ab=j.isDefinedAndNotNull(am[J.columnId])?am[J.columnId]:"";var Z=j.isDefinedAndNotNull(al[J.columnId])?al[J.columnId]:"";if(ab===Z){return am.activeThreadCount-al.activeThreadCount}else{return ab===Z?0:ab>Z?1:-1}}else{if(J.columnId==="queued"){var ao=a[L].count%4;if(ao<2){f("#"+L+" span.queued-title").addClass("sorted");var ap=j.parseCount(am.queuedCount);var O=j.parseCount(al.queuedCount);return ap-O}else{f("#"+L+" span.queued-size-title").addClass("sorted");var N=j.parseSize(am.queuedSize);var V=j.parseSize(al.queuedSize);return N-V}}else{if(J.columnId==="backpressure"){var ao=a[L].count%4;if(ao<2){f("#"+L+" span.backpressure-object-title").addClass("sorted");var U=j.isDefinedAndNotNull(am.percentUseCount)?am.percentUseCount:-1;var W=j.isDefinedAndNotNull(al.percentUseCount)?al.percentUseCount:-1;return U-W}else{f("#"+L+" span.backpressure-data-size-title").addClass("sorted");var af=j.isDefinedAndNotNull(am.percentUseBytes)?am.percentUseBytes:-1;var an=j.isDefinedAndNotNull(al.percentUseBytes)?al.percentUseBytes:-1;return af-an}}else{if(J.columnId==="backpressurePrediction"){var R=D(am);var ag=D(al);return R-ag}else{if(J.columnId==="sent"||J.columnId==="received"||J.columnId==="input"||J.columnId==="output"||J.columnId==="transferred"){var ae=am[J.columnId].split(/\(([^)]+)\)/);var aj=al[J.columnId].split(/\(([^)]+)\)/);var ao=a[L].count%4;if(ao<2){f("#"+L+" span."+J.columnId+"-title").addClass("sorted");var T=j.parseCount(ae[0]);var X=j.parseCount(aj[0]);return T-X}else{f("#"+L+" span."+J.columnId+"-size-title").addClass("sorted");var aa=j.parseSize(ae[1]);var S=j.parseSize(aj[1]);return aa-S}}else{if(J.columnId==="io"){var ao=a[L].count%4;if(ao<2){f("#"+L+" span.read-title").addClass("sorted");var ar=j.parseSize(am.read);var ak=j.parseSize(al.read);return ar-ak}else{f("#"+L+" span.written-title").addClass("sorted");var Y=j.parseSize(am.written);var aq=j.parseSize(al.written);return Y-aq}}else{if(J.columnId==="tasks"){var ao=a[L].count%4;if(ao<2){f("#"+L+" span.tasks-title").addClass("sorted");var ad=j.parseCount(am.tasks);var ai=j.parseCount(al.tasks);return ad-ai}else{f("#"+L+" span.time-title").addClass("sorted");var P=j.parseDuration(am.tasksDuration);var ac=j.parseDuration(al.tasksDuration);return P-ac}}else{var ab=j.isDefinedAndNotNull(am[J.columnId])?am[J.columnId]:"";var Z=j.isDefinedAndNotNull(al[J.columnId])?al[J.columnId]:"";return ab===Z?0:ab>Z?1:-1}}}}}}}}};f("#"+L+" span.queued-title").removeClass("sorted");f("#"+L+" span.queued-size-title").removeClass("sorted");f("#"+L+" span.backpressure-object-title").removeClass("sorted");f("#"+L+" span.backpressure-data-size-title").removeClass("sorted");f("#"+L+" span.backpressure-prediction-object-title").removeClass("sorted");f("#"+L+" span.backpressure-prediction-data-size-title").removeClass("sorted");f("#"+L+" span.backpressure-prediction-time-title").removeClass("sorted");f("#"+L+" span.input-title").removeClass("sorted");f("#"+L+" span.input-size-title").removeClass("sorted");f("#"+L+" span.output-title").removeClass("sorted");f("#"+L+" span.output-size-title").removeClass("sorted");f("#"+L+" span.read-title").removeClass("sorted");f("#"+L+" span.written-title").removeClass("sorted");f("#"+L+" span.time-title").removeClass("sorted");f("#"+L+" span.tasks-title").removeClass("sorted");f("#"+L+" span.sent-title").removeClass("sorted");f("#"+L+" span.sent-size-title").removeClass("sorted");f("#"+L+" span.received-title").removeClass("sorted");f("#"+L+" span.received-size-title").removeClass("sorted");f("#"+L+" span.transferred-title").removeClass("sorted");f("#"+L+" span.transferred-size-title").removeClass("sorted");if(a[L].prevColumn!==J.columnId){a[L].count=0}else{a[L].count++}M.sort(K,J.sortAsc);a[L].prevColumn=J.columnId};var m=function(K,J){if(J.showOnlyPrimaryNode){if(K.executionNode!=="PRIMARY"){return false}}if(J.filterByStatus&&J.filterByStatus!=="all-statuses"){if(K.runStatus!==J.filterByStatus){return false}}if(J.searchString===""){return true}try{var M=new RegExp(J.searchString,"i")}catch(L){return false}return K[J.property].search(M)>=0};var o=function(){var J=f("#summary-filter-primary-node").hasClass("checkbox-checked");if(J){f("#summary-filter-primary-node").removeClass("checkbox-checked").addClass("checkbox-unchecked")}d=false};var v=function(){var K=E.urls.systemDiagnostics;var J={};if(!j.isNull(h)){J.clusterNodeId=h}if(!f.isEmptyObject(J)){K+="?"+f.param(J)}return f.ajax({type:"GET",url:K,dataType:"json"}).done(function(P){var U=P.systemDiagnostics;var N=U.aggregateSnapshot;f("#max-heap").text(N.maxHeap);f("#total-heap").text(N.totalHeap);f("#used-heap").text(N.usedHeap);f("#free-heap").text(N.freeHeap);if(j.isDefinedAndNotNull(N.heapUtilization)){f("#utilization-heap").text("("+N.heapUtilization+")")}else{f("#utilization-heap").text("")}f("#max-non-heap").text(N.maxNonHeap);f("#total-non-heap").text(N.totalNonHeap);f("#used-non-heap").text(N.usedNonHeap);f("#free-non-heap").text(N.freeNonHeap);if(j.isDefinedAndNotNull(N.nonHeapUtilization)){f("#utilization-non-heap").text("("+N.nonHeapUtilization+")")}else{f("#utilization-non-heap").text("")}var T=f("#garbage-collection-table tbody").empty();if(j.isDefinedAndNotNull(N.garbageCollection)){var O=N.garbageCollection.sort(function(Z,Y){return Z.name===Y.name?0:Z.name>Y.name?1:-1});f.each(O,function(Z,Y){u(T,Y)})}f("#uptime").text(N.uptime);f("#available-processors").text(N.availableProcessors);if(j.isDefinedAndNotNull(N.processorLoadAverage)){f("#processor-load-average").text(j.formatFloat(N.processorLoadAverage))}else{f("#processor-load-average").html(j.formatValue(N.processorLoadAverage))}var V=f("#flow-file-repository-storage-usage-container").empty();e(V,N.flowFileRepositoryStorageUsage);var R=f("#content-repository-storage-usage-container").empty();if(j.isDefinedAndNotNull(N.contentRepositoryStorageUsage)){var S=N.contentRepositoryStorageUsage.sort(function(Z,Y){return Z.identifier===Y.identifier?0:Z.identifier>Y.identifier?1:-1});f.each(S,function(Y,Z){e(R,Z)})}var X=f("#provenance-repository-storage-usage-container").empty();if(j.isDefinedAndNotNull(N.provenanceRepositoryStorageUsage)){var M=N.provenanceRepositoryStorageUsage.sort(function(Z,Y){return Z.identifier===Y.identifier?0:Z.identifier>Y.identifier?1:-1});f.each(M,function(Z,Y){e(X,Y)})}var Q={"#version-nifi":N.versionInfo.niFiVersion,"#version-build-tag":N.versionInfo.buildTag,"#version-build-timestamp":N.versionInfo.buildTimestamp,"#version-build-branch":N.versionInfo.buildBranch,"#version-build-revision":N.versionInfo.buildRevision,"#version-java-version":N.versionInfo.javaVersion,"#version-java-vendor":N.versionInfo.javaVendor,"#version-os-name":N.versionInfo.osName,"#version-os-version":N.versionInfo.osVersion,"#version-os-arch":N.versionInfo.osArchitecture};for(var L in Q){var W=Q[L];if(W){f(L).text(W)}else{f(L).text("(not available)").addClass("unset")}}f("#system-diagnostics-last-refreshed").text(N.statsLastRefreshed)}).fail(i.handleAjaxError)};var u=function(K,J){var M=f("<tr></tr>").appendTo(K);f('<td class="setting-name"></td>').text(J.name+":").appendTo(M);var L=f("<tr></tr>").appendTo(K);f("<td></td>").append(f("<b></b>").text(J.collectionCount+" times ("+J.collectionTime+")")).appendTo(L);f("<tr></tr>").text(" ").appendTo(K)};var e=function(K,N){var M=parseInt(N.totalSpaceBytes,10);var L=parseInt(N.usedSpaceBytes,10);var P=f('<div class="storage-usage"></div>').appendTo(K);var O=f('<div class="storage-identifier setting-name"></div>');O.text("Usage:");if(j.isDefinedAndNotNull(N.identifier)){O.text("Usage for "+N.identifier+":")}O.appendTo(P);(I.injector.get("$compile")(f('<md-progress-linear class="md-hue-2" md-mode="determinate" value="'+(L/M)*100+'" aria-label="FlowFile Repository Storage Usage"></md-progress-linear>'))(I.rootScope)).appendTo(P);var J=f('<div class="storage-usage-details"></div>').text(" ("+N.usedSpace+" of "+N.totalSpace+")").prepend(f("<b></b>").text(Math.round((L/M)*100)+"%"));f('<div class="storage-usage-header"></div>').append(J).append('<div class="clear"></div>').appendTo(P)};var B=function(){return f("#summary-filter").val()};var y=function(Q,P,K,O,N,M,L,J){f.each(L.processorStatusSnapshots,function(S,R){var T=R.processorStatusSnapshot;T.parentProcessGroupName=L.name;T.processGroupNamePath=J.reduce(function(U,V){return U+"/"+V.name},"");Q.push(T)});f.each(L.connectionStatusSnapshots,function(R,S){P.push(S.connectionStatusSnapshot)});f.each(L.inputPortStatusSnapshots,function(R,S){O.push(S.portStatusSnapshot)});f.each(L.outputPortStatusSnapshots,function(R,S){N.push(S.portStatusSnapshot)});f.each(L.remoteProcessGroupStatusSnapshots,function(R,S){M.push(S.remoteProcessGroupStatusSnapshot)});K.push(L);f.each(L.processGroupStatusSnapshots,function(R,S){var T=S.processGroupStatusSnapshot;y(Q,P,K,O,N,M,T,k(J,T))})};var k=function(J,L){var K=J.slice();K.push(L);return K};var F=function(){var J;if(f("#processor-summary-table").is(":visible")){J=f("#processor-summary-table").data("gridInstance")}else{if(f("#connection-summary-table").is(":visible")){J=f("#connection-summary-table").data("gridInstance")}else{if(f("#input-port-summary-table").is(":visible")){J=f("#input-port-summary-table").data("gridInstance")}else{if(f("#output-port-summary-table").is(":visible")){J=f("#output-port-summary-table").data("gridInstance")}else{if(f("#process-group-summary-table").is(":visible")){J=f("#process-group-summary-table").data("gridInstance")}else{if(f("#remote-process-group-summary-table").is(":visible")){J=f("#remote-process-group-summary-table").data("gridInstance")}}}}}}if(j.isDefinedAndNotNull(J)){var K=J.getData();K.setFilterArgs({searchString:B(),property:f("#summary-filter-type").combo("getSelectedOption").value,filterByStatus:f("#summary-filter-status-dropdown").combo("getSelectedOption").value,showOnlyPrimaryNode:d});K.refresh()}};var n=function(J,K){f.ajax({type:"GET",url:E.urls.api+"/flow/processors/"+encodeURIComponent(K)+"/status",data:{nodewise:true},dataType:"json"}).done(function(L){if(j.isDefinedAndNotNull(L.processorStatus)){var P=L.processorStatus;var N=f("#cluster-processor-summary-table").data("gridInstance");var O=N.getData();var M=[];f.each(P.nodeSnapshots,function(S,Q){var R=Q.statusSnapshot;M.push({id:Q.nodeId,node:Q.address+":"+Q.apiPort,runStatus:R.runStatus,activeThreadCount:R.activeThreadCount,terminatedThreadCount:R.terminatedThreadCount,input:R.input,read:R.read,written:R.written,output:R.output,tasks:R.tasks,tasksDuration:R.tasksDuration})});O.setItems(M);O.reSort();N.invalidate();f("#cluster-processor-name").text(P.name).ellipsis();f("#cluster-processor-type").text(P.aggregateSnapshot.type).ellipsis();f("#cluster-processor-id").text(P.id);f("#cluster-processor-group-id").text(P.groupId);f("#cluster-processor-summary-last-refreshed").text(P.statsLastRefreshed)}}).fail(i.handleAjaxError)};var b=function(J,K){f.ajax({type:"GET",url:E.urls.api+"/flow/connections/"+encodeURIComponent(K)+"/status",data:{nodewise:true},dataType:"json"}).done(function(Q){if(j.isDefinedAndNotNull(Q.connectionStatus)){var P=Q.connectionStatus;var S=f("#cluster-connection-summary-table").data("gridInstance");var O=S.getData();var U=[];f.each(P.nodeSnapshots,function(X,V){var W=V.statusSnapshot;U.push({id:V.nodeId,node:V.address+":"+V.apiPort,input:W.input,queued:W.queued,queuedCount:W.queuedCount,queuedSize:W.queuedSize,percentUseCount:W.percentUseCount,percentUseBytes:W.percentUseBytes,predictions:W.predictions,output:W.output})});var T=G.some(U,function(V){return G.isNil(V.predictions)});var N=S.getColumns();if(T){var M=N.filter(function(V){return V.id!==t.id});S.setColumns(M)}else{var R=N.findIndex(function(V){return V.id===t.id});if(R<0){var L=N.findIndex(function(V){return V.id==="backpressure"});if(L<0){N.push(t)}else{N.splice(L+1,0,t)}S.setColumns(N)}}O.setItems(U);O.reSort();S.invalidate();f("#cluster-connection-name").text(P.name).ellipsis();f("#cluster-connection-type").text("Connection").ellipsis();f("#cluster-connection-id").text(P.id);f("#cluster-connection-group-id").text(P.groupId);f("#cluster-connection-summary-last-refreshed").text(P.statsLastRefreshed)}}).fail(i.handleAjaxError)};var q=function(J){f.ajax({type:"GET",url:E.urls.api+"/flow/process-groups/"+encodeURIComponent(J)+"/status",data:{nodewise:true,recursive:false},dataType:"json"}).done(function(M){if(j.isDefinedAndNotNull(M.processGroupStatus)){var O=M.processGroupStatus;var K=f("#cluster-process-group-summary-table").data("gridInstance");var N=K.getData();var L=[];f.each(O.nodeSnapshots,function(R,P){var Q=P.statusSnapshot;L.push({id:P.nodeId,node:P.address+":"+P.apiPort,activeThreadCount:Q.activeThreadCount,transferred:Q.transferred,input:Q.input,queued:Q.queued,queuedCount:Q.queuedCount,queuedSize:Q.queuedSize,output:Q.output,read:Q.read,written:Q.written,sent:Q.sent,received:Q.received})});N.setItems(L);N.reSort();K.invalidate();f("#cluster-process-group-name").text(O.name).ellipsis();f("#cluster-process-group-type").text("Process Group").ellipsis();f("#cluster-process-group-id").text(O.id);f("#cluster-process-group-summary-last-refreshed").text(O.statsLastRefreshed)}}).fail(i.handleAjaxError)};var x=function(J,K){f.ajax({type:"GET",url:E.urls.api+"/flow/input-ports/"+encodeURIComponent(K)+"/status",data:{nodewise:true},dataType:"json"}).done(function(M){if(j.isDefinedAndNotNull(M.portStatus)){var N=M.portStatus;var L=f("#cluster-input-port-summary-table").data("gridInstance");var O=L.getData();var P=[];f.each(N.nodeSnapshots,function(S,Q){var R=Q.statusSnapshot;P.push({id:Q.nodeId,node:Q.address+":"+Q.apiPort,runStatus:R.runStatus,activeThreadCount:R.activeThreadCount,output:R.output})});O.setItems(P);O.reSort();L.invalidate();f("#cluster-input-port-name").text(N.name).ellipsis();f("#cluster-input-port-type").text("Input Port").ellipsis();f("#cluster-input-port-id").text(N.id);f("#cluster-input-port-group-id").text(N.groupId);f("#cluster-input-port-summary-last-refreshed").text(N.statsLastRefreshed)}}).fail(i.handleAjaxError)};var l=function(J,K){f.ajax({type:"GET",url:E.urls.api+"/flow/output-ports/"+encodeURIComponent(K)+"/status",data:{nodewise:true},dataType:"json"}).done(function(M){if(j.isDefinedAndNotNull(M.portStatus)){var L=M.portStatus;var N=f("#cluster-output-port-summary-table").data("gridInstance");var P=N.getData();var O=[];f.each(L.nodeSnapshots,function(S,Q){var R=Q.statusSnapshot;O.push({id:Q.nodeId,node:Q.address+":"+Q.apiPort,runStatus:R.runStatus,activeThreadCount:R.activeThreadCount,input:R.input})});P.setItems(O);P.reSort();N.invalidate();f("#cluster-output-port-name").text(L.name).ellipsis();f("#cluster-output-port-type").text("Output Port").ellipsis();f("#cluster-output-port-id").text(L.id);f("#cluster-output-port-group-id").text(L.groupId);f("#cluster-output-port-summary-last-refreshed").text(L.statsLastRefreshed)}}).fail(i.handleAjaxError)};var g=function(K,J){f.ajax({type:"GET",url:E.urls.api+"/flow/remote-process-groups/"+encodeURIComponent(J)+"/status",data:{nodewise:true},dataType:"json"}).done(function(M){if(j.isDefinedAndNotNull(M.remoteProcessGroupStatus)){var P=M.remoteProcessGroupStatus;var N=f("#cluster-remote-process-group-summary-table").data("gridInstance");var O=N.getData();var L=[];f.each(P.nodeSnapshots,function(S,Q){var R=Q.statusSnapshot;L.push({id:Q.nodeId,node:Q.address+":"+Q.apiPort,targetUri:R.targetUri,transmissionStatus:R.transmissionStatus,sent:R.sent,received:R.received,activeThreadCount:R.activeThreadCount})});O.setItems(L);O.reSort();N.invalidate();f("#cluster-remote-process-group-name").text(P.name).ellipsis();f("#cluster-remote-process-group-type").text("Remote Process Group").ellipsis();f("#cluster-remote-process-group-id").text(P.id);f("#cluster-remote-process-group-group-id").text(P.groupId);f("#cluster-remote-process-group-summary-last-refreshed").text(P.statsLastRefreshed)}}).fail(i.handleAjaxError)};var h=null;return{init:function(J){return f.Deferred(function(K){var L=f.ajax({type:"GET",url:E.urls.flowConfig,dataType:"json"}).done(function(N){var M=N.flowConfiguration;c.init(M.timeOffset);s.init({supportsGoTo:false,supportsStatusBar:false});r.init();w(J);K.resolve()}).fail(function(){K.reject()})}).promise()},setClusterNodeId:function(J){h=J},resetTableSize:function(){var O=f("#processor-summary-table");if(O.is(":visible")){var S=O.data("gridInstance");if(j.isDefinedAndNotNull(S)){S.resizeCanvas()}}var R=f("#connection-summary-table");if(R.is(":visible")){var N=R.data("gridInstance");if(j.isDefinedAndNotNull(N)){N.resizeCanvas()}}var J=f("#process-group-summary-table");if(J.is(":visible")){var P=J.data("gridInstance");if(j.isDefinedAndNotNull(P)){P.resizeCanvas()}}var U=f("#input-port-summary-table");if(U.is(":visible")){var T=U.data("gridInstance");if(j.isDefinedAndNotNull(T)){T.resizeCanvas()}}var L=f("#output-port-summary-table");if(L.is(":visible")){var Q=L.data("gridInstance");if(j.isDefinedAndNotNull(Q)){Q.resizeCanvas()}}var M=f("#remote-process-group-summary-table");if(M.is(":visible")){var K=M.data("gridInstance");if(j.isDefinedAndNotNull(K)){K.resizeCanvas()}}},loadSummaryTable:function(){var J=E.urls.status;var K={};if(!j.isNull(h)){K.clusterNodeId=h}if(!f.isEmptyObject(K)){J+="?"+f.param(K)}return f.ajax({type:"GET",url:J,data:{recursive:true},dataType:"json"}).done(function(L){var ad=L.processGroupStatus;var R=ad.aggregateSnapshot;if(j.isDefinedAndNotNull(R)){var W=f("#processor-summary-table");j.cleanUpTooltips(W,"div.has-bulletins");var U=W.data("gridInstance");var S=U.getData();var P=f("#connection-summary-table").data("gridInstance");var N=P.getData();var M=f("#process-group-summary-table");j.cleanUpTooltips(M,"div.has-bulletins");var X=M.data("gridInstance");var V=X.getData();var an=f("#input-port-summary-table");j.cleanUpTooltips(an,"div.has-bulletins");var al=an.data("gridInstance");var ak=al.getData();var ao=f("#output-port-summary-table");j.cleanUpTooltips(ao,"div.has-bulletins");var aa=ao.data("gridInstance");var Y=aa.getData();var ac=f("#remote-process-group-summary-table");j.cleanUpTooltips(ac,"div.has-bulletins");var ag=ac.data("gridInstance");var af=ag.getData();var am=[];var aj=[];var T=[];var ae=[];var ap=[];var Q=[];y(am,aj,T,ae,ap,Q,R,[R]);var ah=G.some(aj,function(aq){return G.isNil(aq.predictions)});var O=P.getColumns();if(ah){var ab=O.filter(function(aq){return aq.id!==t.id});P.setColumns(ab)}else{var ai=O.findIndex(function(aq){return aq.id===t.id});if(ai<0){var Z=O.findIndex(function(aq){return aq.id==="backpressure"});if(Z<0){O.push(t)}else{O.splice(Z+1,0,t)}P.setColumns(O)}}S.setItems(am);S.reSort();U.invalidate();N.setItems(aj);N.reSort();P.invalidate();V.setItems(T);V.reSort();X.invalidate();ak.setItems(ae);ak.reSort();al.invalidate();Y.setItems(ap);Y.reSort();aa.invalidate();af.setItems(Q);af.reSort();ag.invalidate();f("#summary-last-refreshed").text(ad.statsLastRefreshed);if(f("#processor-summary-table").is(":visible")){f("#total-items").text(j.formatInteger(am.length))}else{if(f("#connection-summary-table").is(":visible")){f("#total-items").text(j.formatInteger(aj.length))}else{if(f("#input-port-summary-table").is(":visible")){f("#total-items").text(j.formatInteger(ae.length))}else{if(f("#output-port-summary-table").is(":visible")){f("#total-items").text(j.formatInteger(ap.length))}else{if(f("#process-group-summary-table").is(":visible")){f("#total-items").text(j.formatInteger(T.length))}else{f("#total-items").text(j.formatInteger(Q.length))}}}}}}else{f("#total-items").text("0")}}).fail(i.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Dialog","nf.SummaryTable"],function(d,e,c,f){return(nf.ClusterSearch=b(d,e,c,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ClusterSearch=b(require("jquery"),require("nf.Common"),require("nf.Dialog"),require("nf.SummaryTable")))}else{nf.ClusterSearch=b(a.$,a.nf.Common,a.nf.Dialog,a.nf.SummaryTable)}}}(this,function(c,d,b,e){var a={search:"Search nodes",urls:{clusterSearch:"../nifi-api/flow/cluster/search-results"}};return{init:function(){c("#view-single-node-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Select node",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var f=c("#cluster-search-field").val();c.ajax({type:"GET",data:{q:f},dataType:"json",url:a.urls.clusterSearch}).done(function(g){var i=g.nodeResults;var h=function(k){e.setClusterNodeId(k.id);e.loadSummaryTable();c("#summary-header-text").text(k.address+" Summary")};if(!c.isArray(i)||i.length===0){b.showOkDialog({headerText:"Cluster Search",dialogContent:"No nodes match '"+d.escapeHtml(f)+"'."})}else{if(i.length>1){var j=false;c.each(i,function(l,k){if(k.address===f){h(k);j=true;return false}});if(j){c("#view-single-node-dialog").modal("hide")}else{b.showOkDialog({headerText:"Cluster Search",dialogContent:"More than one node matches '"+d.escapeHtml(f)+"'."})}}else{if(i.length===1){h(i[0]);c("#view-single-node-dialog").modal("hide")}}}})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){c("#cluster-search-field").val(a.search).addClass("search-nodes").clusterSearchAutocomplete("reset")}}});c.widget("nf.clusterSearchAutocomplete",c.ui.autocomplete,{reset:function(){this.term=null},_create:function(){this._super();this.widget().menu("option","items","> :not(.search-no-matches)")},_normalize:function(g){var f=[];f.push(g);return f},_renderMenu:function(h,f){var i=f[0];var g=this;c.each(i.nodeResults,function(j,k){g._renderItem(h,{label:k.address,value:k.address})});if(h.children().length===0){h.append('<li class="unset search-no-matches">No nodes matched the search terms</li>')}},_resizeMenu:function(){var f=this.menu.element;f.width(c("#cluster-search-field").outerWidth()-2)},_renderItem:function(g,f){var h=c("<a></a>").text(f.label);return c("<li></li>").data("ui-autocomplete-item",f).append(h).appendTo(g)}});c("#cluster-search-field").clusterSearchAutocomplete({minLength:0,appendTo:"#search-cluster-results",position:{my:"left top",at:"left bottom",offset:"0 1"},source:function(g,f){c.ajax({type:"GET",data:{q:g.term},dataType:"json",url:a.urls.clusterSearch}).done(function(h){f(h)})}}).focus(function(){if(c(this).val()===a.search){c(this).val("").removeClass("search-nodes")}}).val(a.search).addClass("search-nodes");c("#view-single-node-link").click(function(){c("#view-single-node-dialog").modal("show");c("#cluster-search-field").focus()});c("#view-cluster-link").click(function(){e.setClusterNodeId(null);e.loadSummaryTable();c("#summary-header-text").text("NiFi Summary")});c("#view-options-container").show()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.ServiceProvider=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.ServiceProvider=b())}else{nf.ng.ServiceProvider=b()}}}(this,function(){return function(){function a(){}a.prototype={constructor:a,register:function(c,b){this[c]=b},remove:function(b){delete this[b]}};return new a()}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.ng.Bridge","nf.Common","nf.CanvasUtils","nf.ClusterSummary","nf.Actions"],function(e,f,g,c,d){return(nf.ng.AppCtrl=b(e,f,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.AppCtrl=b(require("nf.ng.Bridge"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.ClusterSummary"),require("nf.Actions")))}else{nf.ng.AppCtrl=b(a.nf.ng.Bridge,a.nf.CanvasUtils,a.nf.Common,a.nf.ClusterSummary,a.nf.Actions)}}}(this,function(c,d,e,a,b){return function(g,i){function f(j){this.nf={Common:e,ClusterSummary:a,Actions:b,CanvasUtils:d,};this.serviceProvider=j}f.prototype={constructor:f};var h=new f(i);g.appCtrl=h;c.rootScope=g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.AppConfig=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.AppConfig=b())}else{nf.ng.AppConfig=b()}}}(this,function(){return function(a,b){b.debugInfoEnabled(false);a.definePalette("basePalette",{"50":"728E9B","100":"728E9B","200":"004849","300":"775351","400":"728E9B","500":"728E9B","600":"728E9B","700":"728E9B","800":"728E9B","900":"rgba(249,250,251,0.97)",A100:"728E9B",A200:"728E9B",A400:"728E9B",A700:"728E9B",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.definePalette("tintPalette",{"50":"728E9B","100":"728E9B","200":"CCDADB","300":"728E9B","400":"AABBC3","500":"728E9B","600":"C7D2D7","700":"728E9B","800":"E3E8EB","900":"728E9B",A100:"728E9B",A200:"728E9B",A400:"728E9B",A700:"728E9B",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.definePalette("warnPalette",{"50":"BA554A","100":"BA554A","200":"BA554A","300":"BA554A","400":"BA554A","500":"BA554A","600":"BA554A","700":"BA554A","800":"BA554A","900":"BA554A",A100:"BA554A",A200:"BA554A",A400:"BA554A",A700:"BA554A",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.theme("default").primaryPalette("basePalette",{"default":"500","hue-1":"200","hue-2":"300","hue-3":"900"}).accentPalette("tintPalette",{"default":"200","hue-1":"400","hue-2":"600","hue-3":"800"}).warnPalette("warnPalette",{"default":"500"})}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","angular","nf.Common","nf.ClusterSummary","nf.ClusterSearch","nf.ng.AppConfig","nf.ng.AppCtrl","nf.ng.ServiceProvider","nf.ng.Bridge","nf.ErrorHandler","nf.Storage","nf.SummaryTable"],function(f,l,e,k,n,o,j,d,c,h,i,g,m){return(nf.Summary=b(f,l,e,k,n,o,j,d,h,i,g,m))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Summary=b(require("jquery"),require("angular"),require("nf.Common"),require("nf.ClusterSummary"),require("nf.ClusterSearch"),require("nf.ng.AppConfig"),require("nf.ng.AppCtrl"),require("nf.ng.ServiceProvider"),require("nf.ng.Bridge"),require("nf.ErrorHandler"),require("nf.Storage"),require("nf.SummaryTable")))}else{nf.Summary=b(a.$,a.angular,a.nf.Common,a.nf.ClusterSummary,a.nf.ClusterSearch,a.nf.ng.AppConfig,a.nf.ng.AppCtrl,a.nf.ng.ServiceProvider,a.nf.ng.Bridge,a.nf.ErrorHandler,a.nf.Storage,a.nf.SummaryTable)}}}(this,function(e,m,d,k,o,p,j,c,g,i,f,n){e(document).ready(function(){var q=m.module("ngSummaryApp",["ngResource","ngRoute","ngMaterial","ngMessages"]);p.$inject=["$mdThemingProvider","$compileProvider"];j.$inject=["$scope","serviceProvider"];c.$inject=[];q.config(p);q.controller("ngSummaryAppCtrl",j);q.service("serviceProvider",c);g.injector=m.bootstrap(e("body"),["ngSummaryApp"],{strictDi:true});k.loadClusterSummary().done(function(){h.init()})});var b={urls:{banners:"../nifi-api/flow/banners",about:"../nifi-api/flow/about",clusterSummary:"../nifi-api/flow/cluster/summary"}};var l=function(){return e.Deferred(function(q){e.ajax({type:"GET",url:b.urls.clusterSummary}).done(function(r){n.init(r.clusterSummary.connectedToCluster).done(function(){if(r.clusterSummary.connectedToCluster){o.init()}q.resolve()}).fail(function(){q.reject()})}).fail(i.handleAjaxError)}).promise()};var a=function(){e("#refresh-button").click(function(){k.loadClusterSummary().done(function(){n.loadSummaryTable()})});return e.Deferred(function(q){if(top===window){e.ajax({type:"GET",url:b.urls.banners,dataType:"json"}).done(function(v){if(d.isDefinedAndNotNull(v.banners)){if(d.isDefinedAndNotNull(v.banners.headerText)&&v.banners.headerText!==""){var s=e("#banner-header").text(v.banners.headerText).show();var u=function(w){var x=e("#"+w);x.css("top",(parseInt(s.css("height"),10)+parseInt(x.css("top"),10))+"px")};u("summary")}if(d.isDefinedAndNotNull(v.banners.footerText)&&v.banners.footerText!==""){var r=e("#banner-footer").text(v.banners.footerText).show();var t=function(w){var x=e("#"+w);x.css("bottom",parseInt(r.css("height"),10)+"px")};t("summary")}}q.resolve()}).fail(function(t,r,s){i.handleAjaxError(t,r,s);q.reject()})}else{q.resolve()}}).promise()};var h={init:function(){f.init();l().done(function(){n.loadSummaryTable().done(function(){a().done(function(){var q=function(){if(top===window){e("body").css({height:e(window).height()+"px",width:e(window).width()+"px"});e("#summary").css("margin",40);e("div.summary-table").css("bottom",127);e("#flow-summary-refresh-container").css({position:"absolute",bottom:"0px",margin:"40px"})}n.resetTableSize()};e.ajax({type:"GET",url:b.urls.about,dataType:"json"}).done(function(s){var r=s.about;var t=r.title+" Summary";document.title=t;e("#status-header-text").text(t);q()}).fail(i.handleAjaxError);e(window).on("resize",function(y){q();var r=e(".dialog");for(var w=0,x=r.length;w<x;w++){if(e(r[w]).is(":visible")){setTimeout(function(A){A.modal("resize")},50,e(r[w]))}}var z=e('*[class*="slickgrid_"]');for(var v=0,x=z.length;v<x;v++){if(e(z[v]).is(":visible")){setTimeout(function(A){A.data("gridInstance").resizeCanvas()},50,e(z[v]))}}var t=e(".tab-container");var s=[];for(var u=0,x=t.length;u<x;u++){if(e(t[u]).is(":visible")){s.push(e("#"+e(t[u]).attr("id")+"-content"))}}e.each(s,function(A,B){d.toggleScrollable(B.get(0))})})})})})}};return h}));
